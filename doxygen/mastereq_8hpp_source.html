<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quandary: /home/runner/work/quandary/quandary/include/mastereq.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Quandary
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">mastereq.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="mastereq_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;<a class="code" href="defs_8hpp.html">defs.hpp</a>&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &quot;<a class="code" href="oscillator_8hpp.html">oscillator.hpp</a>&quot;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &quot;<a class="code" href="util_8hpp.html">util.hpp</a>&quot;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;petscts.h&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;iostream&gt;</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;<a class="code" href="gate_8hpp.html">gate.hpp</a>&quot;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="hamiltonianfilereader_8hpp.html">hamiltonianfilereader.hpp</a>&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="foldopen" id="foldopen00020" data-start="{" data-end="};">
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="structMatShellCtx.html">   20</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a99b166bb3aac8fa812438349afafcc8a">   21</a></span>  PetscInt <a class="code hl_variable" href="structMatShellCtx.html#a99b166bb3aac8fa812438349afafcc8a">dim</a>; </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a064ecab1e678a757d3555ea1d8fd13b7">   22</a></span>  std::vector&lt;int&gt; <a class="code hl_variable" href="structMatShellCtx.html#a064ecab1e678a757d3555ea1d8fd13b7">nlevels</a>; </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#abf9f8b8348e0c0aa80e73ab45b3cae3b">   23</a></span>  IS *<a class="code hl_variable" href="structMatShellCtx.html#abf9f8b8348e0c0aa80e73ab45b3cae3b">isu</a>, *isv; </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a04555832d4416ff0e20253b6fd98b6d2">   24</a></span>  <a class="code hl_class" href="classOscillator.html">Oscillator</a>** <a class="code hl_variable" href="structMatShellCtx.html#a04555832d4416ff0e20253b6fd98b6d2">oscil_vec</a>; </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a6d70c2aeb5c6016d867aab74747d0125">   25</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a6d70c2aeb5c6016d867aab74747d0125">crosskerr</a>; </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a34c21d5b991c90f4dc49f8007772870a">   26</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a34c21d5b991c90f4dc49f8007772870a">Jkl</a>; </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a4163f6fb8f64ba0184f3ebb50bd69a39">   27</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a4163f6fb8f64ba0184f3ebb50bd69a39">eta</a>; </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a82a20720c0e8ad791f959153ffee0a7b">   28</a></span>  <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> <a class="code hl_variable" href="structMatShellCtx.html#a82a20720c0e8ad791f959153ffee0a7b">lindbladtype</a>; </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#adb5a65dd9d7be5752fa6dffec62ab0c9">   29</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="structMatShellCtx.html#adb5a65dd9d7be5752fa6dffec62ab0c9">addT1</a>, addT2; </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a9ba1788479840f371c24f631cc988f87">   30</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a9ba1788479840f371c24f631cc988f87">control_Re</a>;  </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a905421e3d386aeb7dbf2d33f29b4faca">   31</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a905421e3d386aeb7dbf2d33f29b4faca">control_Im</a>;  </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#ab5de01663fc3402b60fde1868073b33d">   32</a></span>  std::vector&lt;Mat&gt; <a class="code hl_variable" href="structMatShellCtx.html#ab5de01663fc3402b60fde1868073b33d">Ac_vec</a>; </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#af642a8e235a41ff9e672d784620a05d2">   33</a></span>  std::vector&lt;Mat&gt; <a class="code hl_variable" href="structMatShellCtx.html#af642a8e235a41ff9e672d784620a05d2">Bc_vec</a>; </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a877b20ea0213d60200aa2a6c829851f1">   34</a></span>  Mat *<a class="code hl_variable" href="structMatShellCtx.html#a877b20ea0213d60200aa2a6c829851f1">Ad</a>; </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#abfb6725d58118545ef1e714c37a76ee0">   35</a></span>  Mat *<a class="code hl_variable" href="structMatShellCtx.html#abfb6725d58118545ef1e714c37a76ee0">Bd</a>; </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a0033984ce7821240a254b2666e0d8ec4">   36</a></span>  std::vector&lt;Mat&gt; <a class="code hl_variable" href="structMatShellCtx.html#a0033984ce7821240a254b2666e0d8ec4">Ad_vec</a>; </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#ae10aee7fdcd0267229a54dd6d9e7ace1">   37</a></span>  std::vector&lt;Mat&gt; <a class="code hl_variable" href="structMatShellCtx.html#ae10aee7fdcd0267229a54dd6d9e7ace1">Bd_vec</a>; </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#aacf5514257ab43f9b825194f2f43b251">   38</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#aacf5514257ab43f9b825194f2f43b251">Bd_coeffs</a>;  <span class="comment">//&lt; Time-dependent coefficients for dipole-dipole coupling matrices: cos(eta_k*t)</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#ac082372639074f8f52e4587f285e4cd3">   39</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#ac082372639074f8f52e4587f285e4cd3">Ad_coeffs</a>;  <span class="comment">//&lt; Time-dependent coefficients for dipole-dipole coupling matrices: sin(eta_k*t)</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a0e414f19d926dfcfbd673069aa0bd60c">   40</a></span>  Vec *<a class="code hl_variable" href="structMatShellCtx.html#a0e414f19d926dfcfbd673069aa0bd60c">aux</a>; </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a7444246ae4834351b67ceee29481287c">   41</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structMatShellCtx.html#a7444246ae4834351b67ceee29481287c">time</a>; </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>} <a class="code hl_struct" href="structMatShellCtx.html">MatShellCtx</a>;</div>
</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a4bbcb17d81ad9a2ed8c929a3d474fd76">applyRHS_matfree_1Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a6295a87328fde308b3acf2b9fe7daf0a">applyRHS_matfree_transpose_1Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#ac83a98a2fee65d4df626da1b3ff338cc">applyRHS_matfree_2Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a730510650263dbab155d7ccc6e80a21b">applyRHS_matfree_transpose_2Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a8c97c0b4484c2d81908459ef1c71866a">applyRHS_matfree_3Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#adeace8b82d4f2828dbc295d65ca6c706">applyRHS_matfree_transpose_3Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a867848c4b01555be1ff180700b287d27">applyRHS_matfree_4Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#ad134ce24dc5ad6a4d22cf11fe4e18c9c">applyRHS_matfree_transpose_4Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#ab1fe575667b47c35a1357db8784e1413">applyRHS_matfree_5Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a69102548098e423535747172dcee4e73">applyRHS_matfree_transpose_5Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a493077d767ad29c5e99c84779f861687">applyRHS_sparsemat</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aeaaf83cf2c38deabfb4f076b5e013b4d">applyRHS_sparsemat_transpose</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="foldopen" id="foldopen00091" data-start="{" data-end="};">
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="classMasterEq.html">   91</a></span><span class="keyword">class </span><a class="code hl_class" href="classMasterEq.html">MasterEq</a>{</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="classMasterEq.html#ad7615921804c8c1dfda8295c9b83f805">   94</a></span>    PetscInt <a class="code hl_variable" href="classMasterEq.html#ad7615921804c8c1dfda8295c9b83f805">dim</a>; </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="classMasterEq.html#a339bf57d2a07ca69cfc3bda69c5b2408">   95</a></span>    PetscInt <a class="code hl_variable" href="classMasterEq.html#a339bf57d2a07ca69cfc3bda69c5b2408">dim_rho</a>; </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="classMasterEq.html#ae1e8bccc92eb5e68c476b8940f2a69bb">   96</a></span>    PetscInt <a class="code hl_variable" href="classMasterEq.html#ae1e8bccc92eb5e68c476b8940f2a69bb">dim_ess</a>; </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">   97</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">noscillators</a>; </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">   98</a></span>    <a class="code hl_class" href="classOscillator.html">Oscillator</a>** <a class="code hl_variable" href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">oscil_vec</a>; </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">  100</a></span>    Mat <a class="code hl_variable" href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">RHS</a>; </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">  101</a></span>    <a class="code hl_struct" href="structMatShellCtx.html">MatShellCtx</a> <a class="code hl_variable" href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">RHSctx</a>; </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="classMasterEq.html#a0d6120b5a9fbbf9321ae897ea463d6be">  103</a></span>    std::vector&lt;Mat&gt; <a class="code hl_variable" href="classMasterEq.html#a0d6120b5a9fbbf9321ae897ea463d6be">Ac_vec</a>;  <span class="comment">// Vector of constant mats for time-varying control term (real). One for each oscillators. </span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="classMasterEq.html#af01d9bc120f37351713381245939945f">  104</a></span>    std::vector&lt;Mat&gt; <a class="code hl_variable" href="classMasterEq.html#af01d9bc120f37351713381245939945f">Bc_vec</a>;  <span class="comment">// Vector of constant mats for time-varying control term (imag). One for each oscillators. </span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">  105</a></span>    Mat  <a class="code hl_variable" href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">Ad</a>, <a class="code hl_variable" href="classMasterEq.html#a2afd1529a3b1793aa87ad1c008ef212a">Bd</a>;  <span class="comment">// Real and imaginary part of constant system matrix</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">  106</a></span>    std::vector&lt;Mat&gt; <a class="code hl_variable" href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">Ad_vec</a>;  <span class="comment">// Vector of constant mats for Dipole-Dipole coupling term in drift Hamiltonian (real)</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">  107</a></span>    std::vector&lt;Mat&gt; <a class="code hl_variable" href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">Bd_vec</a>;  <span class="comment">// Vector of constant mats for Dipole-Dipole coupling term in drift Hamiltonian (imag)</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">  109</a></span>    std::vector&lt;double&gt; <a class="code hl_variable" href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">crosskerr</a>; </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">  110</a></span>    std::vector&lt;double&gt; <a class="code hl_variable" href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">Jkl</a>; </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">  111</a></span>    std::vector&lt;double&gt; <a class="code hl_variable" href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">eta</a>; </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">  112</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">addT1</a>, <a class="code hl_variable" href="classMasterEq.html#a0674aab017f75be72e15d45385a1ebf8">addT2</a>; </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">  114</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">mpirank_world</a>; </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno"><a class="line" href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">  115</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">mpirank_petsc</a>; </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="classMasterEq.html#abee3fe0e3ed04fead9f70dc6841a1496">  116</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#abee3fe0e3ed04fead9f70dc6841a1496">mpisize_petsc</a>; </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="classMasterEq.html#a5404fe64afa66ec3ce8486142394e3ca">  117</a></span>    PetscInt <a class="code hl_variable" href="classMasterEq.html#a5404fe64afa66ec3ce8486142394e3ca">localsize_u</a>; </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="classMasterEq.html#aa34805631143b54e65a99ea9fccb7489">  118</a></span>    PetscInt <a class="code hl_variable" href="classMasterEq.html#aa34805631143b54e65a99ea9fccb7489">ilow</a>; </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="classMasterEq.html#ae3b78dbc07dedc9c99358ecbb5f49fa0">  119</a></span>    PetscInt <a class="code hl_variable" href="classMasterEq.html#ae3b78dbc07dedc9c99358ecbb5f49fa0">iupp</a>; </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">  121</a></span>    IS <a class="code hl_variable" href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">isu</a>, <a class="code hl_variable" href="classMasterEq.html#a53b5dbe948eb0eb8570e4555d7ebedaa">isv</a>; </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">  122</a></span>    Vec <a class="code hl_variable" href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">aux</a>; </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno"><a class="line" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">  123</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">quietmode</a>; </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7b3188a199da02dba7d150c383b3f460">  124</a></span>    std::string <a class="code hl_variable" href="classMasterEq.html#a7b3188a199da02dba7d150c383b3f460">hamiltonian_file_Hsys</a>; </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="classMasterEq.html#a4cc4d6da9ba0169c505d9a003e29a3fe">  125</a></span>    std::string <a class="code hl_variable" href="classMasterEq.html#a4cc4d6da9ba0169c505d9a003e29a3fe">hamiltonian_file_Hc</a>; </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">  128</a></span>    std::vector&lt;int&gt; <a class="code hl_variable" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">nlevels</a>; </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">  129</a></span>    std::vector&lt;int&gt; <a class="code hl_variable" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">nessential</a>; </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">  130</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">usematfree</a>; </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">  131</a></span>    <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> <a class="code hl_variable" href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">lindbladtype</a>; </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <a class="code hl_function" href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq</a>();</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <a class="code hl_function" href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq</a>(<span class="keyword">const</span> std::vector&lt;int&gt;&amp; <a class="code hl_variable" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">nlevels</a>, <span class="keyword">const</span> std::vector&lt;int&gt;&amp; <a class="code hl_variable" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">nessential</a>, <a class="code hl_class" href="classOscillator.html">Oscillator</a>** oscil_vec_, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; crosskerr_, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; Jkl_, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; eta_, <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> lindbladtype_, <span class="keywordtype">bool</span> usematfree_, <span class="keyword">const</span> std::string&amp; <a class="code hl_variable" href="classMasterEq.html#a7b3188a199da02dba7d150c383b3f460">hamiltonian_file_Hsys</a>, <span class="keyword">const</span> std::string&amp; <a class="code hl_variable" href="classMasterEq.html#a4cc4d6da9ba0169c505d9a003e29a3fe">hamiltonian_file_Hc</a>, <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">quietmode</a>=<span class="keyword">false</span>);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <a class="code hl_function" href="classMasterEq.html#af9b8723f0500416cd3d2fcdd14fd9483">~MasterEq</a>();</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#a9e3fcf025c5e78f7cd5bed77d48660a7">set_RHS_MatMult_operation</a>();</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#aad34fc836f709483b81b724d8ec9f94c">initSparseMatSolver</a>();</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7e880910441b27fde4ff1aef4de2aac4">  174</a></span>    <a class="code hl_class" href="classOscillator.html">Oscillator</a>* <a class="code hl_function" href="classMasterEq.html#a7e880910441b27fde4ff1aef4de2aac4">getOscillator</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> i) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">oscil_vec</a>[i]; }</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="classMasterEq.html#a601f1831ffce18ea5be8fd68e7bd60c2">  181</a></span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="classMasterEq.html#a601f1831ffce18ea5be8fd68e7bd60c2">getNOscillators</a>() { <span class="keywordflow">return</span> <a class="code hl_variable" href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">noscillators</a>; }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno"><a class="line" href="classMasterEq.html#a55a14f39e2a3e8392cfe7d0973c13d69">  188</a></span>    PetscInt <a class="code hl_function" href="classMasterEq.html#a55a14f39e2a3e8392cfe7d0973c13d69">getDim</a>(){ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMasterEq.html#ad7615921804c8c1dfda8295c9b83f805">dim</a>; }</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="classMasterEq.html#ad9929979de484ffc7662ea738568d008">  195</a></span>    PetscInt <a class="code hl_function" href="classMasterEq.html#ad9929979de484ffc7662ea738568d008">getDimEss</a>(){ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMasterEq.html#ae1e8bccc92eb5e68c476b8940f2a69bb">dim_ess</a>; }</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="classMasterEq.html#a618faa8de97fc0dc613d31622191625a">  202</a></span>    PetscInt <a class="code hl_function" href="classMasterEq.html#a618faa8de97fc0dc613d31622191625a">getDimRho</a>(){ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMasterEq.html#a339bf57d2a07ca69cfc3bda69c5b2408">dim_rho</a>; }</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classMasterEq.html#aadb9c6cdd2162ee2df713e40a72f7d5c">assemble_RHS</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> t);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    Mat <a class="code hl_function" href="classMasterEq.html#a114fff980e3a46ceeb53bbd7167c416f">getRHS</a>();</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#afd3d3d8301ab8e3d23a59601f1dd0665">compute_dRHS_dParams</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> t,<span class="keyword">const</span> Vec x,<span class="keyword">const</span> Vec x_bar, <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, Vec grad);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#af747a9c4013860f785cd80fe52e7f457">setControlAmplitudes</a>(<span class="keyword">const</span> Vec x);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classMasterEq.html#aae5fbd62a0766d20ec823a001da6f570">expectedEnergy</a>(<span class="keyword">const</span> Vec x);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#a9308372d3f1aa99517dd313d5d2a4cd9">population</a>(<span class="keyword">const</span> Vec x, std::vector&lt;double&gt; &amp;population_com);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="comment">// /* Compute reduced density operator for a sub-system defined by IDs in the oscilIDs vector */</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="comment">// void createReducedDensity(const Vec rho, Vec *reduced, const std::vector&lt;int&gt;&amp; oscilIDs);</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="comment">// /* Derivative of reduced density computation */</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <span class="comment">// void createReducedDensity_diff(Vec rhobar, const Vec reducedbar, const std::vector&lt;int&gt;&amp; oscilIDs);</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>};</div>
</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#aa77e13c9a94d0ac25e730935925a0cff">compute_dRHS_dParams_sparsemat</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> t,<span class="keyword">const</span> Vec x,<span class="keyword">const</span> Vec x_bar, <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, Vec grad, std::vector&lt;int&gt;&amp; nlevels, IS isu, IS isv, std::vector&lt;Mat&gt;&amp; Ac_vec, std::vector&lt;Mat&gt;&amp; Bc_vec, Vec aux, <a class="code hl_class" href="classOscillator.html">Oscillator</a>** oscil_vec);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#ad07e79fe88ae679ea14d6772b91458aa">compute_dRHS_dParams_matfree</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">double</span> t,<span class="keyword">const</span> Vec x,<span class="keyword">const</span> Vec x_bar, <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, Vec grad, std::vector&lt;int&gt;&amp; nlevels, <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> lindbladtype, <a class="code hl_class" href="classOscillator.html">Oscillator</a>** oscil_vec);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span><span class="comment">// Inline functions for the Matrix-free RHS application</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="foldopen" id="foldopen00316" data-start="{" data-end="}">
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">  316</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">int</span> a) {</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <span class="keywordflow">return</span> detuning0*a;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>};</div>
</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="foldopen" id="foldopen00327" data-start="{" data-end="}">
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">  327</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">int</span> a) {</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * a * (a-1);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>};</div>
</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="foldopen" id="foldopen00339" data-start="{" data-end="}">
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">  339</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p){</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) );</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>};</div>
</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="foldopen" id="foldopen00351" data-start="{" data-end="}">
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">  351</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p){</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) ;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>};</div>
</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="foldopen" id="foldopen00363" data-start="{" data-end="}">
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">  363</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p){</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>  <span class="keywordflow">return</span> i0 + nlevels0 * i0p;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>};</div>
</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="foldopen" id="foldopen00376" data-start="{" data-end="}">
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a157c2e11aec50060bd1bbe1e67294f2e">  376</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">int</span> a, <span class="keyword">const</span> <span class="keywordtype">int</span> b) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <span class="keywordflow">return</span> detuning0*a + detuning1*b;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>};</div>
</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="foldopen" id="foldopen00389" data-start="{" data-end="}">
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ac561c889f846efb29ef1588401371cff">  389</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">int</span> a, <span class="keyword">const</span> <span class="keywordtype">int</span> b) {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * a * (a-1) - xi1 / 2.0 * b * (b-1);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>};</div>
</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="foldopen" id="foldopen00401" data-start="{" data-end="}">
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">  401</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">int</span> a, <span class="keyword">const</span> <span class="keywordtype">int</span> b) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  <span class="keywordflow">return</span> - xi01 * a * b;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>};</div>
</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="foldopen" id="foldopen00416" data-start="{" data-end="}">
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a27a651b0ad18d46dff30d0cb6a820e1c">  416</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p){</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) );</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>};</div>
</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="foldopen" id="foldopen00431" data-start="{" data-end="}">
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a019a4ad308b966a3284dde2cdc019c51">  431</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p){</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) - decay1 / 2.0 * ( i1 + i1p );</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>};</div>
</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="foldopen" id="foldopen00446" data-start="{" data-end="}">
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aa1ea516a7cd11e6c60c621fa304389bb">  446</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1,<span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p){</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  <span class="keywordflow">return</span> i0*nlevels1 + i1 + (nlevels0 * nlevels1) * ( i0p * nlevels1 + i1p);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>};</div>
</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span><span class="comment">// Inlines for Matrix-free RHS for 3 oscillators</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="comment">// See documentation for 1-2 oscillator functions above for parameter descriptions</span></div>
<div class="foldopen" id="foldopen00453" data-start="{" data-end="}">
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#abbf91cc9a73f3f2e4966ded0c679c985">  453</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2) {</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  <span class="keywordflow">return</span> detuning0*i0 + detuning1*i1 + detuning2*i2;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>};</div>
</div>
<div class="foldopen" id="foldopen00456" data-start="{" data-end="}">
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a978b3dd569adb84b95937e290708b7a8">  456</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">double</span> xi2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2) {</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * i0 * (i0-1) - xi1 / 2.0 * i1 * (i1-1) - xi2 / 2.0 * i2 * (i2-1);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>};</div>
</div>
<div class="foldopen" id="foldopen00459" data-start="{" data-end="}">
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#abc2d15a8a43d9840db4ba04b250dc645">  459</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">double</span> xi02, <span class="keyword">const</span> <span class="keywordtype">double</span> xi12, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2) {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <span class="keywordflow">return</span> - xi01 * i0 * i1 - xi02 * i0 * i2 - xi12 * i1 * i2;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>};</div>
</div>
<div class="foldopen" id="foldopen00462" data-start="{" data-end="}">
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ac4b18159caf2bcb246193982e4716ab6">  462</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p){</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>       + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) )</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>       + dephase2 * ( i2*i2p - 1./2. * (i2*i2 + i2p*i2p) );</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>};</div>
</div>
<div class="foldopen" id="foldopen00467" data-start="{" data-end="}">
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a59c24ddb3c27391c1c92d763f00f402d">  467</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">double</span> decay2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p){</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>         - decay1 / 2.0 * ( i1 + i1p )</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>         - decay2 / 2.0 * ( i2 + i2p );</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>};</div>
</div>
<div class="foldopen" id="foldopen00472" data-start="{" data-end="}">
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#abd22a8cbb2ceb40ec6966a6dd6eebe50">  472</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels2, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p){</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  <span class="keywordflow">return</span> i0*nlevels1*nlevels2 + i1*nlevels2 + i2 + (nlevels0 * nlevels1 * nlevels2) * ( i0p * nlevels1*nlevels2 + i1p*nlevels2 + i2p);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>};</div>
</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span><span class="comment">// Matrix-free solver inlines for 4 oscillators</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span><span class="comment">// See documentation for 1-2 oscillator functions above for parameter descriptions</span></div>
<div class="foldopen" id="foldopen00479" data-start="{" data-end="}">
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#adba418d947542f6b1a03166c0c0ad87c">  479</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning2, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3) {</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>  <span class="keywordflow">return</span> detuning0*i0 + detuning1*i1 + detuning2*i2 + detuning3*i3;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>};</div>
</div>
<div class="foldopen" id="foldopen00482" data-start="{" data-end="}">
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a7b9f537ea7b1b1992cb3b5126e169afe">  482</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">double</span> xi2, <span class="keyword">const</span> <span class="keywordtype">double</span> xi3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3) {</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * i0 * (i0-1) - xi1 / 2.0 * i1 * (i1-1) - xi2 / 2.0 * i2 * (i2-1) - xi3/2.0 * i3 * (i3-1);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>};</div>
</div>
<div class="foldopen" id="foldopen00485" data-start="{" data-end="}">
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a173ac51d68a13a1b440cb8929d97cf27">  485</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">double</span> xi02, <span class="keyword">const</span> <span class="keywordtype">double</span> xi03, <span class="keyword">const</span> <span class="keywordtype">double</span> xi12, <span class="keyword">const</span> <span class="keywordtype">double</span> xi13, <span class="keyword">const</span> <span class="keywordtype">double</span> xi23, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3) {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>  <span class="keywordflow">return</span> - xi01 * i0 * i1 - xi02 * i0 * i2  - xi03*i0*i3 - xi12 * i1 * i2 - xi13*i1*i3 - xi23*i2*i3;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>};</div>
</div>
<div class="foldopen" id="foldopen00488" data-start="{" data-end="}">
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a4f27133e204b9a010d3e63037a803974">  488</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase2, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p){</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>       + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) )</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>       + dephase2 * ( i2*i2p - 1./2. * (i2*i2 + i2p*i2p) )</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>       + dephase3 * ( i3*i3p - 1./2. * (i3*i3 + i3p*i3p) );</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>};</div>
</div>
<div class="foldopen" id="foldopen00494" data-start="{" data-end="}">
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a68fd0485f1b01c12e74f1146491f304e">  494</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">double</span> decay2, <span class="keyword">const</span> <span class="keywordtype">double</span> decay3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p){</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>         - decay1 / 2.0 * ( i1 + i1p )</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>         - decay2 / 2.0 * ( i2 + i2p )</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>         - decay3 / 2.0 * ( i3 + i3p );</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>};</div>
</div>
<div class="foldopen" id="foldopen00500" data-start="{" data-end="}">
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#afbfaf8a66011785f2b7b13c334e3d90b">  500</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels2, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels3, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p){</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  <span class="keywordflow">return</span> i0*nlevels1*nlevels2*nlevels3 + i1*nlevels2*nlevels3 + i2*nlevels3 + i3 + (nlevels0 * nlevels1 * nlevels2 * nlevels3) * ( i0p * nlevels1*nlevels2*nlevels3 + i1p*nlevels2*nlevels3 + i2p*nlevels3 + i3p);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>}</div>
</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">// Matrix-free solver inlines for 5 oscillators</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment">// See documentation for 1-2 oscillator functions above for parameter descriptions</span></div>
<div class="foldopen" id="foldopen00506" data-start="{" data-end="}">
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab44c53bd61ab24396ffcef8e7a6b7887">  506</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning2, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning3, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4) {</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <span class="keywordflow">return</span> detuning0*i0 + detuning1*i1 + detuning2*i2 + detuning3*i3 + detuning4*i4;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>};</div>
</div>
<div class="foldopen" id="foldopen00509" data-start="{" data-end="}">
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a642af45a3b3f32b1fb290b5c14b1d8de">  509</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">double</span> xi2, <span class="keyword">const</span> <span class="keywordtype">double</span> xi3, <span class="keyword">const</span> <span class="keywordtype">double</span> xi4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4) {</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * i0 * (i0-1) - xi1 / 2.0 * i1 * (i1-1) - xi2 / 2.0 * i2 * (i2-1) - xi3/2.0 * i3 * (i3-1) - xi4/2.0 * i4 * (i4-1);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>};</div>
</div>
<div class="foldopen" id="foldopen00512" data-start="{" data-end="}">
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a86d8c64d53f47d536659aee2bdf4d21f">  512</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">double</span> xi02, <span class="keyword">const</span> <span class="keywordtype">double</span> xi03, <span class="keyword">const</span> <span class="keywordtype">double</span> xi04, <span class="keyword">const</span> <span class="keywordtype">double</span> xi12, <span class="keyword">const</span> <span class="keywordtype">double</span> xi13, <span class="keyword">const</span> <span class="keywordtype">double</span> xi14, <span class="keyword">const</span> <span class="keywordtype">double</span> xi23, <span class="keyword">const</span> <span class="keywordtype">double</span> xi24, <span class="keyword">const</span> <span class="keywordtype">double</span> xi34, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4) {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keywordflow">return</span> - xi01 * i0 * i1 - xi02 * i0 * i2  - xi03*i0*i3 - xi04*i0*i4 - xi12 * i1 * i2 - xi13*i1*i3 - xi14*i1*i4 - xi23*i2*i3 - xi24*i2*i4 - xi34*i3*i4;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>};</div>
</div>
<div class="foldopen" id="foldopen00515" data-start="{" data-end="}">
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a8377794a7efa34f065c75e3fa255281c">  515</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase2, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase3, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p, <span class="keyword">const</span> <span class="keywordtype">int</span> i4p){</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>       + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) )</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>       + dephase2 * ( i2*i2p - 1./2. * (i2*i2 + i2p*i2p) )</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>       + dephase3 * ( i3*i3p - 1./2. * (i3*i3 + i3p*i3p) )</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>       + dephase4 * ( i4*i4p - 1./2. * (i4*i4 + i4p*i4p) );</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>};</div>
</div>
<div class="foldopen" id="foldopen00522" data-start="{" data-end="}">
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab9db8a05c90cfaa114286dafd95ee61b">  522</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">double</span> decay2, <span class="keyword">const</span> <span class="keywordtype">double</span> decay3, <span class="keyword">const</span> <span class="keywordtype">double</span> decay4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p, <span class="keyword">const</span> <span class="keywordtype">int</span> i4p){</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>         - decay1 / 2.0 * ( i1 + i1p )</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>         - decay2 / 2.0 * ( i2 + i2p )</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>         - decay3 / 2.0 * ( i3 + i3p )</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>         - decay4 / 2.0 * ( i4 + i4p );</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>};</div>
</div>
<div class="foldopen" id="foldopen00529" data-start="{" data-end="}">
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a418d121bd4b2619395278c41978fa9eb">  529</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels2, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels3, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels4, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p, <span class="keyword">const</span> <span class="keywordtype">int</span> i4p){</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="keywordflow">return</span> i0*nlevels1*nlevels2*nlevels3*nlevels4 + i1*nlevels2*nlevels3*nlevels4 + i2*nlevels3*nlevels4 + i3*nlevels4 + i4 + (nlevels0 * nlevels1 * nlevels2 * nlevels3*nlevels4) * ( i0p * nlevels1*nlevels2*nlevels3*nlevels4 + i1p*nlevels2*nlevels3*nlevels4 + i2p*nlevels3*nlevels4+ i3p*nlevels4 + i4p);</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>}</div>
</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="foldopen" id="foldopen00553" data-start="{" data-end="}">
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a8f077a3b08eaffd2721784b5e8aded1c">  553</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a8f077a3b08eaffd2721784b5e8aded1c">dRHSdp_getcoeffs</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> np, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keywordtype">double</span>* res_p_re, <span class="keywordtype">double</span>* res_p_im, <span class="keywordtype">double</span>* res_q_re, <span class="keywordtype">double</span>* res_q_im) {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  *res_p_re = 0.0;</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  *res_p_im = 0.0;</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  *res_q_re = 0.0;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  *res_q_im = 0.0;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  <span class="comment">/* ik+1..,ik&#39;.. term */</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  <span class="keywordflow">if</span> (i &lt; n-1) {</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    <span class="keywordtype">int</span> itx = it + stridei;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    <span class="keywordtype">double</span> sq = sqrt(i + 1);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    *res_p_re +=   sq * xim;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    *res_p_im += - sq * xre;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    *res_q_re +=   sq * xre;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    *res_q_im +=   sq * xim;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  }</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  <span class="comment">/* \rho(ik..,ik&#39;+1..) */</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  <span class="keywordflow">if</span> (ip &lt; np-1) {</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <span class="keywordtype">int</span> itx = it + strideip;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    <span class="keywordtype">double</span> sq = sqrt(ip + 1);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    *res_p_re += - sq * xim;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    *res_p_im += + sq * xre;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    *res_q_re +=   sq * xre;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    *res_q_im +=   sq * xim;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  <span class="comment">/* \rho(ik-1..,ik&#39;..) */</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="keywordtype">int</span> itx = it - stridei;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    <span class="keywordtype">double</span> sq = sqrt(i);</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    *res_p_re += + sq * xim;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    *res_p_im += - sq * xre;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    *res_q_re += - sq * xre;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    *res_q_im += - sq * xim;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>  }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="comment">/* \rho(ik..,ik&#39;-1..) */</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  <span class="keywordflow">if</span> (ip &gt; 0) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="keywordtype">int</span> itx = it - strideip;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    <span class="keywordtype">double</span> sq = sqrt(ip);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    *res_p_re += - sq * xim;</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    *res_p_im += + sq * xre;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    *res_q_re += - sq * xre;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    *res_q_im += - sq * xim;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>}</div>
</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span> </div>
<div class="foldopen" id="foldopen00632" data-start="{" data-end="}">
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a91a476485ea7a73ce5ad12e4888af677">  632</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a91a476485ea7a73ce5ad12e4888af677">Jkl_coupling</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj, <span class="keyword">const</span> <span class="keywordtype">int</span> nip, <span class="keyword">const</span> <span class="keywordtype">int</span> njp, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">int</span> jp, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridej, <span class="keyword">const</span> <span class="keywordtype">int</span> stridejp, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> Jij, <span class="keyword">const</span> <span class="keywordtype">double</span> cosij, <span class="keyword">const</span> <span class="keywordtype">double</span> sinij, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim) {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  <span class="keywordflow">if</span> (fabs(Jij)&gt;1e-10) {</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="comment">//  1) J_kl (-icos + sin) * ρ_{E−k+l i, i′}</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; j &lt; nj-1) {</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      <span class="keywordtype">int</span> itx = it - stridei + stridej;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      <span class="keywordtype">double</span> sq = sqrt(i * (j + 1));</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      <span class="comment">// sin u + cos v + i ( -cos u + sin v)</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>      *yre += Jij * sq * (   cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      *yim += Jij * sq * ( - cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    }</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    <span class="comment">// 2) J_kl (−icos − sin)sqrt(il*(ik +1)) ρ_{E+k−li,i′}</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    <span class="keywordflow">if</span> (i &lt; ni-1 &amp;&amp; j &gt; 0) {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      <span class="keywordtype">int</span> itx = it + stridei - stridej;  <span class="comment">// E+k-l i, i&#39;</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>      <span class="keywordtype">double</span> sq = sqrt(j * (i + 1)); <span class="comment">// sqrt( il*(ik+1))</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>      <span class="comment">// -sin u + cos v + i (-cos u - sin v)</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>      *yre += Jij * sq * (   cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>      *yim += Jij * sq * ( - cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    }</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    <span class="comment">// 3) J_kl ( icos + sin)sqrt(ik&#39;*(il&#39; +1)) ρ_{i,E-k+li&#39;}</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    <span class="keywordflow">if</span> (ip &gt; 0 &amp;&amp; jp &lt; njp-1) {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>      <span class="keywordtype">int</span> itx = it - strideip + stridejp;  <span class="comment">// i, E-k+l i&#39;</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keywordtype">double</span> sq = sqrt(ip * (jp + 1)); <span class="comment">// sqrt( ik&#39;*(il&#39;+1))</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>      <span class="comment">//  sin u - cos v + i ( cos u + sin v)</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      *yre += Jij * sq * ( - cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>      *yim += Jij * sq * (   cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    }</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    <span class="comment">// 4) J_kl ( icos - sin)sqrt(il&#39;*(ik&#39; +1)) ρ_{i,E+k-li&#39;}</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    <span class="keywordflow">if</span> (ip &lt; nip-1 &amp;&amp; jp &gt; 0) {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>      <span class="keywordtype">int</span> itx = it + strideip - stridejp;  <span class="comment">// i, E+k-l i&#39;</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <span class="keywordtype">double</span> sq = sqrt(jp * (ip + 1)); <span class="comment">// sqrt( il&#39;*(ik&#39;+1))</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>      <span class="comment">// - sin u - cos v + i ( cos u - sin v)</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>      *yre += Jij * sq * ( - cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>      *yim += Jij * sq * (   cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    }</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  }</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>}</div>
</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="foldopen" id="foldopen00701" data-start="{" data-end="}">
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a40b326a8bf579b23be81cfc004bcd27a">  701</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a40b326a8bf579b23be81cfc004bcd27a">Jkl_coupling_T</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj, <span class="keyword">const</span> <span class="keywordtype">int</span> nip, <span class="keyword">const</span> <span class="keywordtype">int</span> njp, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">int</span> jp, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridej, <span class="keyword">const</span> <span class="keywordtype">int</span> stridejp, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> Jij, <span class="keyword">const</span> <span class="keywordtype">double</span> cosij, <span class="keyword">const</span> <span class="keywordtype">double</span> sinij, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim) {</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="keywordflow">if</span> (fabs(Jij)&gt;1e-10) {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="comment">//  1) [...] * \bar y_{E+k-l i, i′}</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    <span class="keywordflow">if</span> (i &lt; ni-1 &amp;&amp; j &gt; 0) {</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>      <span class="keywordtype">int</span> itx = it + stridei - stridej;</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>      <span class="keywordtype">double</span> sq = sqrt(j * (i + 1));</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>      *yre += Jij * sq * ( - cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>      *yim += Jij * sq * ( + cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    }</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="comment">// 2) J_kl (−icos − sin)sqrt(ik*(il +1)) \bar y_{E-k+li,i′}</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; j &lt; nj-1) {</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>      <span class="keywordtype">int</span> itx = it - stridei + stridej;  <span class="comment">// E-k+l i, i&#39;</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>      <span class="keywordtype">double</span> sq = sqrt(i * (j + 1)); <span class="comment">// sqrt( ik*(il+1))</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>      *yre += Jij * sq * ( - cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>      *yim += Jij * sq * ( + cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>    <span class="comment">// 3) J_kl ( icos + sin)sqrt(il&#39;*(ik&#39; +1)) \bar y_{i,E+k-li&#39;}</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="keywordflow">if</span> (ip &lt; nip-1 &amp;&amp; jp &gt; 0) {</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>      <span class="keywordtype">int</span> itx = it + strideip - stridejp;  <span class="comment">// i, E+k-l i&#39;</span></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>      <span class="keywordtype">double</span> sq = sqrt(jp * (ip + 1)); <span class="comment">// sqrt( il&#39;*(ik&#39;+1))</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>      *yre += Jij * sq * (   cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>      *yim += Jij * sq * ( - cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    <span class="comment">// 4) J_kl ( icos - sin)sqrt(ik&#39;*(il&#39; +1)) \bar y_{i,E-k+li&#39;}</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="keywordflow">if</span> (ip &gt; 0 &amp;&amp; jp &lt; njp-1) {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>      <span class="keywordtype">int</span> itx = it - strideip + stridejp;  <span class="comment">// i, E-k+l i&#39;</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>      <span class="keywordtype">double</span> sq = sqrt(ip * (jp + 1)); <span class="comment">// sqrt( ik&#39;*(il&#39;+1))</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>      *yre += Jij * sq * (   cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>      *yim += Jij * sq * ( - cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    }</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>  }</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span> </div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>}</div>
</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="foldopen" id="foldopen00758" data-start="{" data-end="}">
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aa159bffd2b0a5e4673edd97cee863dd4">  758</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#aa159bffd2b0a5e4673edd97cee863dd4">L1decay</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> decayi, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="keywordflow">if</span>  (fabs(decayi) &gt; 1e-12) {</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    <span class="keywordflow">if</span> (i &lt; n-1 &amp;&amp; ip &lt; n-1) {</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>      <span class="keywordtype">double</span> l1off = decayi * sqrt((i+1)*(ip+1));</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>      <span class="keywordtype">int</span> itx = it + stridei + strideip;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>      *yre += l1off * xre;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>      *yim += l1off * xim;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    }</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>  }</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>}</div>
</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="foldopen" id="foldopen00786" data-start="{" data-end="}">
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#af770f017839be90b01c452e6c5fe18c3">  786</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#af770f017839be90b01c452e6c5fe18c3">L1decay_T</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> decayi, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>  <span class="keywordflow">if</span> (fabs(decayi) &gt; 1e-12) {</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; ip &gt; 0) {</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        <span class="keywordtype">double</span> l1off = decayi * sqrt(i*ip);</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        <span class="keywordtype">int</span> itx = it - stridei - strideip;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>        <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        *yre += l1off * xre;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>        *yim += l1off * xim;</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>      }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>}</div>
</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="foldopen" id="foldopen00818" data-start="{" data-end="}">
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab1f1874266f7eb3e45894ba2dd4a8a79">  818</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#ab1f1874266f7eb3e45894ba2dd4a8a79">control</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> np, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> pt, <span class="keyword">const</span> <span class="keywordtype">double</span> qt, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>  <span class="comment">/* \rho(ik+1..,ik&#39;..) term */</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>  <span class="keywordflow">if</span> (i &lt; n-1) {</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>      <span class="keywordtype">int</span> itx = it + stridei;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>      <span class="keywordtype">double</span> sq = sqrt(i + 1);</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>      *yre += sq * (   pt * xim + qt * xre);</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>      *yim += sq * ( - pt * xre + qt * xim);</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    }</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <span class="comment">/* \rho(ik..,ik&#39;+1..) */</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    <span class="keywordflow">if</span> (ip &lt; np-1) {</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>      <span class="keywordtype">int</span> itx = it + strideip;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>      <span class="keywordtype">double</span> sq = sqrt(ip + 1);</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>      *yre += sq * ( -pt * xim + qt * xre);</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>      *yim += sq * (  pt * xre + qt * xim);</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    }</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    <span class="comment">/* \rho(ik-1..,ik&#39;..) */</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>      <span class="keywordtype">int</span> itx = it - stridei;</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      <span class="keywordtype">double</span> sq = sqrt(i);</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>      *yre += sq * (  pt * xim - qt * xre);</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>      *yim += sq * (- pt * xre - qt * xim);</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    }</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    <span class="comment">/* \rho(ik..,ik&#39;-1..) */</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    <span class="keywordflow">if</span> (ip &gt; 0) {</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>      <span class="keywordtype">int</span> itx = it - strideip;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>      <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>      <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>      <span class="keywordtype">double</span> sq = sqrt(ip);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      *yre += sq * (- pt * xim - qt * xre);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>      *yim += sq * (  pt * xre - qt * xim);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>}</div>
</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span> </div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span> </div>
<div class="foldopen" id="foldopen00875" data-start="{" data-end="}">
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ad7a20cf2e9a78242ffcd72c87032b29b">  875</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#ad7a20cf2e9a78242ffcd72c87032b29b">control_T</a>(<span class="keyword">const</span> PetscInt dim, <span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> np, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> pt, <span class="keyword">const</span> <span class="keywordtype">double</span> qt, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>  <span class="comment">/* \rho(ik+1..,ik&#39;..) term */</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>  <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    <span class="keywordtype">int</span> itx = it - stridei;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    <span class="keywordtype">double</span> sq = sqrt(i);</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    *yre += sq * ( - pt * xim + qt * xre);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    *yim += sq * (   pt * xre + qt * xim);</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>  }</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>  <span class="comment">/* \rho(ik..,ik&#39;+1..) */</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>  <span class="keywordflow">if</span> (ip &gt; 0) {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    <span class="keywordtype">int</span> itx = it - strideip;</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    <span class="keywordtype">double</span> sq = sqrt(ip);</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    *yre += sq * (  pt * xim + qt * xre);</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    *yim += sq * ( -pt * xre + qt * xim);</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>  }</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>  <span class="comment">/* \rho(ik-1..,ik&#39;..) */</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>  <span class="keywordflow">if</span> (i &lt; n-1) {</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <span class="keywordtype">int</span> itx = it + stridei;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keywordtype">double</span> sq = sqrt(i+1);</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    *yre += sq * (- pt * xim - qt * xre);</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    *yim += sq * (  pt * xre - qt * xim);</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>  }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>  <span class="comment">/* \rho(ik..,ik&#39;-1..) */</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>  <span class="keywordflow">if</span> (ip &lt; np-1) {</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="keywordtype">int</span> itx = it + strideip;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    <span class="keywordtype">double</span> xre = xptr[itx];</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <span class="keywordtype">double</span> xim = xptr[itx+dim];</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>    <span class="keywordtype">double</span> sq = sqrt(ip+1);</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    *yre += sq * (+ pt * xim - qt * xre);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    *yim += sq * (- pt * xre - qt * xim);</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>  }</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>}</div>
</div>
<div class="ttc" id="aclassMasterEq_html"><div class="ttname"><a href="classMasterEq.html">MasterEq</a></div><div class="ttdoc">Implementation of the real-valued right-hand-side (RHS) system matrix of the quantum dynamical equati...</div><div class="ttdef"><b>Definition</b> mastereq.hpp:91</div></div>
<div class="ttc" id="aclassMasterEq_html_a02dd3462531616d6a2a250a088990cd2"><div class="ttname"><a href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">MasterEq::addT1</a></div><div class="ttdeci">bool addT1</div><div class="ttdef"><b>Definition</b> mastereq.hpp:112</div></div>
<div class="ttc" id="aclassMasterEq_html_a0674aab017f75be72e15d45385a1ebf8"><div class="ttname"><a href="classMasterEq.html#a0674aab017f75be72e15d45385a1ebf8">MasterEq::addT2</a></div><div class="ttdeci">bool addT2</div><div class="ttdoc">Flags for including T1 decay and T2 dephasing Lindblad operators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:112</div></div>
<div class="ttc" id="aclassMasterEq_html_a0d6120b5a9fbbf9321ae897ea463d6be"><div class="ttname"><a href="classMasterEq.html#a0d6120b5a9fbbf9321ae897ea463d6be">MasterEq::Ac_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Ac_vec</div><div class="ttdef"><b>Definition</b> mastereq.hpp:103</div></div>
<div class="ttc" id="aclassMasterEq_html_a114fff980e3a46ceeb53bbd7167c416f"><div class="ttname"><a href="classMasterEq.html#a114fff980e3a46ceeb53bbd7167c416f">MasterEq::getRHS</a></div><div class="ttdeci">Mat getRHS()</div><div class="ttdoc">Retrieves the right-hand-side system matrix.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:680</div></div>
<div class="ttc" id="aclassMasterEq_html_a1a7dfad49bfeafe1ebbaa4a23a4eae29"><div class="ttname"><a href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">MasterEq::mpirank_petsc</a></div><div class="ttdeci">int mpirank_petsc</div><div class="ttdoc">Rank of PETSc's communicator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:115</div></div>
<div class="ttc" id="aclassMasterEq_html_a24841be28d3b2ba8fec73988b07d16a5"><div class="ttname"><a href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq::MasterEq</a></div><div class="ttdeci">MasterEq()</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3</div></div>
<div class="ttc" id="aclassMasterEq_html_a2afd1529a3b1793aa87ad1c008ef212a"><div class="ttname"><a href="classMasterEq.html#a2afd1529a3b1793aa87ad1c008ef212a">MasterEq::Bd</a></div><div class="ttdeci">Mat Bd</div><div class="ttdef"><b>Definition</b> mastereq.hpp:105</div></div>
<div class="ttc" id="aclassMasterEq_html_a2d735524c2b5b205adb1898606b65a19"><div class="ttname"><a href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">MasterEq::usematfree</a></div><div class="ttdeci">bool usematfree</div><div class="ttdoc">Flag for using matrix-free solver.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:130</div></div>
<div class="ttc" id="aclassMasterEq_html_a339bf57d2a07ca69cfc3bda69c5b2408"><div class="ttname"><a href="classMasterEq.html#a339bf57d2a07ca69cfc3bda69c5b2408">MasterEq::dim_rho</a></div><div class="ttdeci">PetscInt dim_rho</div><div class="ttdoc">Dimension of Hilbert space = N.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:95</div></div>
<div class="ttc" id="aclassMasterEq_html_a3493e8372960cd42ba4ceab89fe68bb9"><div class="ttname"><a href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">MasterEq::quietmode</a></div><div class="ttdeci">bool quietmode</div><div class="ttdoc">Flag for quiet mode operation.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:123</div></div>
<div class="ttc" id="aclassMasterEq_html_a3d861dd8d9ad6f4e9b04e0109d3ee128"><div class="ttname"><a href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">MasterEq::crosskerr</a></div><div class="ttdeci">std::vector&lt; double &gt; crosskerr</div><div class="ttdoc">Cross-Kerr coefficients (rad/time)  for ZZ-coupling .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:109</div></div>
<div class="ttc" id="aclassMasterEq_html_a44fad9cad554191a82455cf84d1fdd1f"><div class="ttname"><a href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">MasterEq::isu</a></div><div class="ttdeci">IS isu</div><div class="ttdef"><b>Definition</b> mastereq.hpp:121</div></div>
<div class="ttc" id="aclassMasterEq_html_a4cc4d6da9ba0169c505d9a003e29a3fe"><div class="ttname"><a href="classMasterEq.html#a4cc4d6da9ba0169c505d9a003e29a3fe">MasterEq::hamiltonian_file_Hc</a></div><div class="ttdeci">std::string hamiltonian_file_Hc</div><div class="ttdoc">Filename if a custom control Hamiltonians are read from file ('none' if standard Hamiltonian is used)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:125</div></div>
<div class="ttc" id="aclassMasterEq_html_a53b5dbe948eb0eb8570e4555d7ebedaa"><div class="ttname"><a href="classMasterEq.html#a53b5dbe948eb0eb8570e4555d7ebedaa">MasterEq::isv</a></div><div class="ttdeci">IS isv</div><div class="ttdoc">Vector strides for accessing real and imaginary parts u=Re(x), v=Im(x)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:121</div></div>
<div class="ttc" id="aclassMasterEq_html_a5404fe64afa66ec3ce8486142394e3ca"><div class="ttname"><a href="classMasterEq.html#a5404fe64afa66ec3ce8486142394e3ca">MasterEq::localsize_u</a></div><div class="ttdeci">PetscInt localsize_u</div><div class="ttdoc">Size of local sub vector u or v in state x=[u,v].</div><div class="ttdef"><b>Definition</b> mastereq.hpp:117</div></div>
<div class="ttc" id="aclassMasterEq_html_a55a14f39e2a3e8392cfe7d0973c13d69"><div class="ttname"><a href="classMasterEq.html#a55a14f39e2a3e8392cfe7d0973c13d69">MasterEq::getDim</a></div><div class="ttdeci">PetscInt getDim()</div><div class="ttdoc">Retrieves the dimension of the vectorized system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:188</div></div>
<div class="ttc" id="aclassMasterEq_html_a601f1831ffce18ea5be8fd68e7bd60c2"><div class="ttname"><a href="classMasterEq.html#a601f1831ffce18ea5be8fd68e7bd60c2">MasterEq::getNOscillators</a></div><div class="ttdeci">size_t getNOscillators()</div><div class="ttdoc">Retrieves the number of oscillators in the system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:181</div></div>
<div class="ttc" id="aclassMasterEq_html_a609bd3adeeaf8f9a53e7bdc59cd25be8"><div class="ttname"><a href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">MasterEq::nessential</a></div><div class="ttdeci">std::vector&lt; int &gt; nessential</div><div class="ttdoc">Number of essential levels per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:129</div></div>
<div class="ttc" id="aclassMasterEq_html_a618faa8de97fc0dc613d31622191625a"><div class="ttname"><a href="classMasterEq.html#a618faa8de97fc0dc613d31622191625a">MasterEq::getDimRho</a></div><div class="ttdeci">PetscInt getDimRho()</div><div class="ttdoc">Retrieves the dimension of the density matrix.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:202</div></div>
<div class="ttc" id="aclassMasterEq_html_a6a3bb1ab8dd49c64f51c90dd5b080f62"><div class="ttname"><a href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">MasterEq::RHSctx</a></div><div class="ttdeci">MatShellCtx RHSctx</div><div class="ttdoc">Context containing data for applying the RHS to a state.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:101</div></div>
<div class="ttc" id="aclassMasterEq_html_a6c35b6e30807ba37c4742a05af80f9ef"><div class="ttname"><a href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">MasterEq::oscil_vec</a></div><div class="ttdeci">Oscillator ** oscil_vec</div><div class="ttdoc">Array of pointers to oscillator objects.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:98</div></div>
<div class="ttc" id="aclassMasterEq_html_a6c486486fc1feb02cbc77bd44ca3202a"><div class="ttname"><a href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">MasterEq::Bd_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Bd_vec</div><div class="ttdef"><b>Definition</b> mastereq.hpp:107</div></div>
<div class="ttc" id="aclassMasterEq_html_a6cadd8dbe3e40e6ea087b6926de72c1f"><div class="ttname"><a href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">MasterEq::nlevels</a></div><div class="ttdeci">std::vector&lt; int &gt; nlevels</div><div class="ttdoc">Number of levels per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:128</div></div>
<div class="ttc" id="aclassMasterEq_html_a7aa65ae612c591230c41eec8454936ee"><div class="ttname"><a href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">MasterEq::Ad</a></div><div class="ttdeci">Mat Ad</div><div class="ttdef"><b>Definition</b> mastereq.hpp:105</div></div>
<div class="ttc" id="aclassMasterEq_html_a7b3188a199da02dba7d150c383b3f460"><div class="ttname"><a href="classMasterEq.html#a7b3188a199da02dba7d150c383b3f460">MasterEq::hamiltonian_file_Hsys</a></div><div class="ttdeci">std::string hamiltonian_file_Hsys</div><div class="ttdoc">Filename if a custom system Hamiltonian is read from file ('none' if standard Hamiltonian is used)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:124</div></div>
<div class="ttc" id="aclassMasterEq_html_a7e880910441b27fde4ff1aef4de2aac4"><div class="ttname"><a href="classMasterEq.html#a7e880910441b27fde4ff1aef4de2aac4">MasterEq::getOscillator</a></div><div class="ttdeci">Oscillator * getOscillator(const size_t i)</div><div class="ttdoc">Retrieves the i-th oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:174</div></div>
<div class="ttc" id="aclassMasterEq_html_a7f69aef84b13fada56ebb31adf9fa7fd"><div class="ttname"><a href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">MasterEq::eta</a></div><div class="ttdeci">std::vector&lt; double &gt; eta</div><div class="ttdoc">Frequency differences in rotating frame (rad/time) for dipole-dipole coupling.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:111</div></div>
<div class="ttc" id="aclassMasterEq_html_a9308372d3f1aa99517dd313d5d2a4cd9"><div class="ttname"><a href="classMasterEq.html#a9308372d3f1aa99517dd313d5d2a4cd9">MasterEq::population</a></div><div class="ttdeci">void population(const Vec x, std::vector&lt; double &gt; &amp;population_com)</div><div class="ttdoc">Computes population of the full composite system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:2936</div></div>
<div class="ttc" id="aclassMasterEq_html_a9e3fcf025c5e78f7cd5bed77d48660a7"><div class="ttname"><a href="classMasterEq.html#a9e3fcf025c5e78f7cd5bed77d48660a7">MasterEq::set_RHS_MatMult_operation</a></div><div class="ttdeci">void set_RHS_MatMult_operation()</div><div class="ttdoc">Pass MatMult operations for applying the RHS to PETSc.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:710</div></div>
<div class="ttc" id="aclassMasterEq_html_aa34805631143b54e65a99ea9fccb7489"><div class="ttname"><a href="classMasterEq.html#aa34805631143b54e65a99ea9fccb7489">MasterEq::ilow</a></div><div class="ttdeci">PetscInt ilow</div><div class="ttdoc">First index of the local sub vector u,v.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:118</div></div>
<div class="ttc" id="aclassMasterEq_html_aaafcd9e3d4a617bbb86d004b44f7ad3d"><div class="ttname"><a href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">MasterEq::noscillators</a></div><div class="ttdeci">int noscillators</div><div class="ttdoc">Number of oscillators in the system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:97</div></div>
<div class="ttc" id="aclassMasterEq_html_aad34fc836f709483b81b724d8ec9f94c"><div class="ttname"><a href="classMasterEq.html#aad34fc836f709483b81b724d8ec9f94c">MasterEq::initSparseMatSolver</a></div><div class="ttdeci">void initSparseMatSolver()</div><div class="ttdoc">Initializes matrices needed for the sparse matrix solver.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:192</div></div>
<div class="ttc" id="aclassMasterEq_html_aadb9c6cdd2162ee2df713e40a72f7d5c"><div class="ttname"><a href="classMasterEq.html#aadb9c6cdd2162ee2df713e40a72f7d5c">MasterEq::assemble_RHS</a></div><div class="ttdeci">int assemble_RHS(const double t)</div><div class="ttdoc">Assembles the real-valued system matrix (RHS) at time t.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:657</div></div>
<div class="ttc" id="aclassMasterEq_html_aae5fbd62a0766d20ec823a001da6f570"><div class="ttname"><a href="classMasterEq.html#aae5fbd62a0766d20ec823a001da6f570">MasterEq::expectedEnergy</a></div><div class="ttdeci">double expectedEnergy(const Vec x)</div><div class="ttdoc">Computes expected energy of the full composite system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:2897</div></div>
<div class="ttc" id="aclassMasterEq_html_ab0d2504ab06b61b6bfe11f623e5a002c"><div class="ttname"><a href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">MasterEq::Ad_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Ad_vec</div><div class="ttdef"><b>Definition</b> mastereq.hpp:106</div></div>
<div class="ttc" id="aclassMasterEq_html_ab200ca6b9a16be33b8ee7313c41f20d2"><div class="ttname"><a href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">MasterEq::RHS</a></div><div class="ttdeci">Mat RHS</div><div class="ttdoc">MatShell for real-valued, vectorized system matrix (size 2N^2 x 2N^2)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:100</div></div>
<div class="ttc" id="aclassMasterEq_html_abee3fe0e3ed04fead9f70dc6841a1496"><div class="ttname"><a href="classMasterEq.html#abee3fe0e3ed04fead9f70dc6841a1496">MasterEq::mpisize_petsc</a></div><div class="ttdeci">int mpisize_petsc</div><div class="ttdoc">Size of PETSc's communicator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:116</div></div>
<div class="ttc" id="aclassMasterEq_html_ac53a2013f8ebe3b279be5b04b2bba34e"><div class="ttname"><a href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">MasterEq::Jkl</a></div><div class="ttdeci">std::vector&lt; double &gt; Jkl</div><div class="ttdoc">Dipole-dipole coupling coefficients (rad/time), multiplies .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:110</div></div>
<div class="ttc" id="aclassMasterEq_html_ac7b7aa48c2cce32d27d0055e0a8d5990"><div class="ttname"><a href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">MasterEq::mpirank_world</a></div><div class="ttdeci">int mpirank_world</div><div class="ttdoc">Rank of global MPI communicator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:114</div></div>
<div class="ttc" id="aclassMasterEq_html_ac8fd54198c43d043c544e72417e30dba"><div class="ttname"><a href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">MasterEq::lindbladtype</a></div><div class="ttdeci">LindbladType lindbladtype</div><div class="ttdoc">Type of Lindblad operators to include (NONE means Schroedinger equation)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:131</div></div>
<div class="ttc" id="aclassMasterEq_html_ad59aa549dc17834871c3fdfe96f397e4"><div class="ttname"><a href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">MasterEq::aux</a></div><div class="ttdeci">Vec aux</div><div class="ttdoc">Auxiliary vector for computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:122</div></div>
<div class="ttc" id="aclassMasterEq_html_ad7615921804c8c1dfda8295c9b83f805"><div class="ttname"><a href="classMasterEq.html#ad7615921804c8c1dfda8295c9b83f805">MasterEq::dim</a></div><div class="ttdeci">PetscInt dim</div><div class="ttdoc">Dimension of full vectorized system: N^2 if Lindblad, N if Schroedinger.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:94</div></div>
<div class="ttc" id="aclassMasterEq_html_ad9929979de484ffc7662ea738568d008"><div class="ttname"><a href="classMasterEq.html#ad9929979de484ffc7662ea738568d008">MasterEq::getDimEss</a></div><div class="ttdeci">PetscInt getDimEss()</div><div class="ttdoc">Retrieves the dimension of the essential level system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:195</div></div>
<div class="ttc" id="aclassMasterEq_html_ae1e8bccc92eb5e68c476b8940f2a69bb"><div class="ttname"><a href="classMasterEq.html#ae1e8bccc92eb5e68c476b8940f2a69bb">MasterEq::dim_ess</a></div><div class="ttdeci">PetscInt dim_ess</div><div class="ttdoc">Dimension of essential levels = N_e.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:96</div></div>
<div class="ttc" id="aclassMasterEq_html_ae3b78dbc07dedc9c99358ecbb5f49fa0"><div class="ttname"><a href="classMasterEq.html#ae3b78dbc07dedc9c99358ecbb5f49fa0">MasterEq::iupp</a></div><div class="ttdeci">PetscInt iupp</div><div class="ttdoc">Last index (+1) of the local sub vector u,v.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:119</div></div>
<div class="ttc" id="aclassMasterEq_html_af01d9bc120f37351713381245939945f"><div class="ttname"><a href="classMasterEq.html#af01d9bc120f37351713381245939945f">MasterEq::Bc_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Bc_vec</div><div class="ttdef"><b>Definition</b> mastereq.hpp:104</div></div>
<div class="ttc" id="aclassMasterEq_html_af747a9c4013860f785cd80fe52e7f457"><div class="ttname"><a href="classMasterEq.html#af747a9c4013860f785cd80fe52e7f457">MasterEq::setControlAmplitudes</a></div><div class="ttdeci">void setControlAmplitudes(const Vec x)</div><div class="ttdoc">Pass control parameters from global design vector to each oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:693</div></div>
<div class="ttc" id="aclassMasterEq_html_af9b8723f0500416cd3d2fcdd14fd9483"><div class="ttname"><a href="classMasterEq.html#af9b8723f0500416cd3d2fcdd14fd9483">MasterEq::~MasterEq</a></div><div class="ttdeci">~MasterEq()</div><div class="ttdef"><b>Definition</b> mastereq.cpp:158</div></div>
<div class="ttc" id="aclassMasterEq_html_afd3d3d8301ab8e3d23a59601f1dd0665"><div class="ttname"><a href="classMasterEq.html#afd3d3d8301ab8e3d23a59601f1dd0665">MasterEq::compute_dRHS_dParams</a></div><div class="ttdeci">void compute_dRHS_dParams(const double t, const Vec x, const Vec x_bar, const double alpha, Vec grad)</div><div class="ttdoc">Computes gradient of RHS with respect to control parameters.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:683</div></div>
<div class="ttc" id="aclassOscillator_html"><div class="ttname"><a href="classOscillator.html">Oscillator</a></div><div class="ttdoc">Quantum oscillator (multi-level qubit) with control capabilities.</div><div class="ttdef"><b>Definition</b> oscillator.hpp:48</div></div>
<div class="ttc" id="adefs_8hpp_html"><div class="ttname"><a href="defs_8hpp.html">defs.hpp</a></div><div class="ttdoc">Core type definitions and enumerations for Quandary quantum optimal control.</div></div>
<div class="ttc" id="adefs_8hpp_html_a5e46e0fe90abc6230f71928a43849bd2"><div class="ttname"><a href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a></div><div class="ttdeci">LindbladType</div><div class="ttdoc">Available Lindblad operator types for open quantum systems, or NONE for closed quantum systems.</div><div class="ttdef"><b>Definition</b> defs.hpp:27</div></div>
<div class="ttc" id="agate_8hpp_html"><div class="ttname"><a href="gate_8hpp.html">gate.hpp</a></div></div>
<div class="ttc" id="ahamiltonianfilereader_8hpp_html"><div class="ttname"><a href="hamiltonianfilereader_8hpp.html">hamiltonianfilereader.hpp</a></div></div>
<div class="ttc" id="amastereq_8hpp_html_a40b326a8bf579b23be81cfc004bcd27a"><div class="ttname"><a href="mastereq_8hpp.html#a40b326a8bf579b23be81cfc004bcd27a">Jkl_coupling_T</a></div><div class="ttdeci">void Jkl_coupling_T(const PetscInt dim, const int it, const int ni, const int nj, const int nip, const int njp, const int i, const int ip, const int j, const int jp, const int stridei, const int strideip, const int stridej, const int stridejp, const double *xptr, const double Jij, const double cosij, const double sinij, double *yre, double *yim)</div><div class="ttdoc">Transpose of dipole-dipole coupling for adjoint computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:701</div></div>
<div class="ttc" id="amastereq_8hpp_html_a493077d767ad29c5e99c84779f861687"><div class="ttname"><a href="mastereq_8hpp.html#a493077d767ad29c5e99c84779f861687">applyRHS_sparsemat</a></div><div class="ttdeci">int applyRHS_sparsemat(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Sparse matrix MatMult.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:743</div></div>
<div class="ttc" id="amastereq_8hpp_html_a4bbcb17d81ad9a2ed8c929a3d474fd76"><div class="ttname"><a href="mastereq_8hpp.html#a4bbcb17d81ad9a2ed8c929a3d474fd76">applyRHS_matfree_1Osc</a></div><div class="ttdeci">int applyRHS_matfree_1Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-vector products to apply the RHS system matrix to a state vector.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:2977</div></div>
<div class="ttc" id="amastereq_8hpp_html_a4c23d2ebe61dae85bc76b66421364302"><div class="ttname"><a href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a></div><div class="ttdeci">double L2(const double dephase0, const int i0, const int i0p)</div><div class="ttdoc">Inline for Matrix-free RHS to compute L2 dephasing coefficient for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:339</div></div>
<div class="ttc" id="amastereq_8hpp_html_a6295a87328fde308b3acf2b9fe7daf0a"><div class="ttname"><a href="mastereq_8hpp.html#a6295a87328fde308b3acf2b9fe7daf0a">applyRHS_matfree_transpose_1Osc</a></div><div class="ttdeci">int applyRHS_matfree_transpose_1Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free MatMult for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3006</div></div>
<div class="ttc" id="amastereq_8hpp_html_a69102548098e423535747172dcee4e73"><div class="ttname"><a href="mastereq_8hpp.html#a69102548098e423535747172dcee4e73">applyRHS_matfree_transpose_5Osc</a></div><div class="ttdeci">int applyRHS_matfree_transpose_5Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free MatMult for 5 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3218</div></div>
<div class="ttc" id="amastereq_8hpp_html_a730510650263dbab155d7ccc6e80a21b"><div class="ttname"><a href="mastereq_8hpp.html#a730510650263dbab155d7ccc6e80a21b">applyRHS_matfree_transpose_2Osc</a></div><div class="ttdeci">int applyRHS_matfree_transpose_2Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free MatMult for 2 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3063</div></div>
<div class="ttc" id="amastereq_8hpp_html_a867848c4b01555be1ff180700b287d27"><div class="ttname"><a href="mastereq_8hpp.html#a867848c4b01555be1ff180700b287d27">applyRHS_matfree_4Osc</a></div><div class="ttdeci">int applyRHS_matfree_4Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free MatMult for 4 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3141</div></div>
<div class="ttc" id="amastereq_8hpp_html_a8c97c0b4484c2d81908459ef1c71866a"><div class="ttname"><a href="mastereq_8hpp.html#a8c97c0b4484c2d81908459ef1c71866a">applyRHS_matfree_3Osc</a></div><div class="ttdeci">int applyRHS_matfree_3Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free MatMult for 3 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3091</div></div>
<div class="ttc" id="amastereq_8hpp_html_a8f077a3b08eaffd2721784b5e8aded1c"><div class="ttname"><a href="mastereq_8hpp.html#a8f077a3b08eaffd2721784b5e8aded1c">dRHSdp_getcoeffs</a></div><div class="ttdeci">void dRHSdp_getcoeffs(const PetscInt dim, const int it, const int n, const int np, const int i, const int ip, const int stridei, const int strideip, const double *xptr, double *res_p_re, double *res_p_im, double *res_q_re, double *res_q_im)</div><div class="ttdoc">Inline for Matrix-free RHS for gradient updates.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:553</div></div>
<div class="ttc" id="amastereq_8hpp_html_a91a476485ea7a73ce5ad12e4888af677"><div class="ttname"><a href="mastereq_8hpp.html#a91a476485ea7a73ce5ad12e4888af677">Jkl_coupling</a></div><div class="ttdeci">void Jkl_coupling(const PetscInt dim, const int it, const int ni, const int nj, const int nip, const int njp, const int i, const int ip, const int j, const int jp, const int stridei, const int strideip, const int stridej, const int stridejp, const double *xptr, const double Jij, const double cosij, const double sinij, double *yre, double *yim)</div><div class="ttdoc">Matrix-free solver inline for dipole-dipole coupling between oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:632</div></div>
<div class="ttc" id="amastereq_8hpp_html_aa159bffd2b0a5e4673edd97cee863dd4"><div class="ttname"><a href="mastereq_8hpp.html#aa159bffd2b0a5e4673edd97cee863dd4">L1decay</a></div><div class="ttdeci">void L1decay(const PetscInt dim, const int it, const int n, const int i, const int ip, const int stridei, const int strideip, const double *xptr, const double decayi, double *yre, double *yim)</div><div class="ttdoc">Matrix-free solver inline for off-diagonal L1 decay term.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:758</div></div>
<div class="ttc" id="amastereq_8hpp_html_aa77e13c9a94d0ac25e730935925a0cff"><div class="ttname"><a href="mastereq_8hpp.html#aa77e13c9a94d0ac25e730935925a0cff">compute_dRHS_dParams_sparsemat</a></div><div class="ttdeci">void compute_dRHS_dParams_sparsemat(const double t, const Vec x, const Vec x_bar, const double alpha, Vec grad, std::vector&lt; int &gt; &amp;nlevels, IS isu, IS isv, std::vector&lt; Mat &gt; &amp;Ac_vec, std::vector&lt; Mat &gt; &amp;Bc_vec, Vec aux, Oscillator **oscil_vec)</div><div class="ttdoc">: Sparse-matrix version to compute gradient of RHS with respect to parameters</div><div class="ttdef"><b>Definition</b> mastereq.cpp:925</div></div>
<div class="ttc" id="amastereq_8hpp_html_aabb663bfcd5c2b36d4e46ff483849156"><div class="ttname"><a href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a></div><div class="ttdeci">double H_crosskerr(const double xi01, const int a, const int b)</div><div class="ttdoc">Inline for Matrix-free RHS, Computes cross-Kerr coupling between 2 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:401</div></div>
<div class="ttc" id="amastereq_8hpp_html_aac495876fa4b05189aebdc593e4a402f"><div class="ttname"><a href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a></div><div class="ttdeci">int TensorGetIndex(const int nlevels0, const int i0, const int i0p)</div><div class="ttdoc">Inline for Matrix-free RHS to compute tensor product index for 1 oscillator system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:363</div></div>
<div class="ttc" id="amastereq_8hpp_html_ab1f1874266f7eb3e45894ba2dd4a8a79"><div class="ttname"><a href="mastereq_8hpp.html#ab1f1874266f7eb3e45894ba2dd4a8a79">control</a></div><div class="ttdeci">void control(const PetscInt dim, const int it, const int n, const int i, const int np, const int ip, const int stridei, const int strideip, const double *xptr, const double pt, const double qt, double *yre, double *yim)</div><div class="ttdoc">Matrix-free solver inline for control terms.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:818</div></div>
<div class="ttc" id="amastereq_8hpp_html_ab1fe575667b47c35a1357db8784e1413"><div class="ttname"><a href="mastereq_8hpp.html#ab1fe575667b47c35a1357db8784e1413">applyRHS_matfree_5Osc</a></div><div class="ttdeci">int applyRHS_matfree_5Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free MatMult for 5 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3192</div></div>
<div class="ttc" id="amastereq_8hpp_html_ab249c0823cf573c3c49ace9ead191a77"><div class="ttname"><a href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a></div><div class="ttdeci">double H_selfkerr(const double xi0, const int a)</div><div class="ttdoc">Inline for Matrix-free RHS to Compute self-Kerr coefficient for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:327</div></div>
<div class="ttc" id="amastereq_8hpp_html_ac83a98a2fee65d4df626da1b3ff338cc"><div class="ttname"><a href="mastereq_8hpp.html#ac83a98a2fee65d4df626da1b3ff338cc">applyRHS_matfree_2Osc</a></div><div class="ttdeci">int applyRHS_matfree_2Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free MatMult for 2 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3033</div></div>
<div class="ttc" id="amastereq_8hpp_html_ad07e79fe88ae679ea14d6772b91458aa"><div class="ttname"><a href="mastereq_8hpp.html#ad07e79fe88ae679ea14d6772b91458aa">compute_dRHS_dParams_matfree</a></div><div class="ttdeci">void compute_dRHS_dParams_matfree(const PetscInt dim, const double t, const Vec x, const Vec x_bar, const double alpha, Vec grad, std::vector&lt; int &gt; &amp;nlevels, LindbladType lindbladtype, Oscillator **oscil_vec)</div><div class="ttdoc">: Matrix free version to compute gradient of RHS with respect to parameters</div><div class="ttdef"><b>Definition</b> mastereq.cpp:970</div></div>
<div class="ttc" id="amastereq_8hpp_html_ad134ce24dc5ad6a4d22cf11fe4e18c9c"><div class="ttname"><a href="mastereq_8hpp.html#ad134ce24dc5ad6a4d22cf11fe4e18c9c">applyRHS_matfree_transpose_4Osc</a></div><div class="ttdeci">int applyRHS_matfree_transpose_4Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free MatMult for 4 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3167</div></div>
<div class="ttc" id="amastereq_8hpp_html_ad7a20cf2e9a78242ffcd72c87032b29b"><div class="ttname"><a href="mastereq_8hpp.html#ad7a20cf2e9a78242ffcd72c87032b29b">control_T</a></div><div class="ttdeci">void control_T(const PetscInt dim, const int it, const int n, const int i, const int np, const int ip, const int stridei, const int strideip, const double *xptr, const double pt, const double qt, double *yre, double *yim)</div><div class="ttdoc">Matrix-free Transpose of control terms for adjoint computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:875</div></div>
<div class="ttc" id="amastereq_8hpp_html_ad9182550cadb88d6f911338bda0769eb"><div class="ttname"><a href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a></div><div class="ttdeci">double L1diag(const double decay0, const int i0, const int i0p)</div><div class="ttdoc">Inline for Matrix-free RHS to compute L1 decay coefficient for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:351</div></div>
<div class="ttc" id="amastereq_8hpp_html_adeace8b82d4f2828dbc295d65ca6c706"><div class="ttname"><a href="mastereq_8hpp.html#adeace8b82d4f2828dbc295d65ca6c706">applyRHS_matfree_transpose_3Osc</a></div><div class="ttdeci">int applyRHS_matfree_transpose_3Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free MatMult for 3 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3117</div></div>
<div class="ttc" id="amastereq_8hpp_html_aeaaf83cf2c38deabfb4f076b5e013b4d"><div class="ttname"><a href="mastereq_8hpp.html#aeaaf83cf2c38deabfb4f076b5e013b4d">applyRHS_sparsemat_transpose</a></div><div class="ttdeci">int applyRHS_sparsemat_transpose(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose sparse matrix MatMult.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:834</div></div>
<div class="ttc" id="amastereq_8hpp_html_aebbda51dfa3b2ccda3c86e83efb422f3"><div class="ttname"><a href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a></div><div class="ttdeci">double H_detune(const double detuning0, const int a)</div><div class="ttdoc">Inline for Matrix-free RHS to Compute detuning for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:316</div></div>
<div class="ttc" id="amastereq_8hpp_html_af770f017839be90b01c452e6c5fe18c3"><div class="ttname"><a href="mastereq_8hpp.html#af770f017839be90b01c452e6c5fe18c3">L1decay_T</a></div><div class="ttdeci">void L1decay_T(const PetscInt dim, const int it, const int i, const int ip, const int stridei, const int strideip, const double *xptr, const double decayi, double *yre, double *yim)</div><div class="ttdoc">Matrix-free inline Transpose of off-diagonal L1 decay for adjoint computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:786</div></div>
<div class="ttc" id="aoscillator_8hpp_html"><div class="ttname"><a href="oscillator_8hpp.html">oscillator.hpp</a></div></div>
<div class="ttc" id="astructMatShellCtx_html"><div class="ttname"><a href="structMatShellCtx.html">MatShellCtx</a></div><div class="ttdoc">Matrix shell context containing data needed for applying the right-hand-side (RHS) system matrix to a...</div><div class="ttdef"><b>Definition</b> mastereq.hpp:20</div></div>
<div class="ttc" id="astructMatShellCtx_html_a0033984ce7821240a254b2666e0d8ec4"><div class="ttname"><a href="structMatShellCtx.html#a0033984ce7821240a254b2666e0d8ec4">MatShellCtx::Ad_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Ad_vec</div><div class="ttdoc">Vector of real parts of dipole-dipole coupling system matrices.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:36</div></div>
<div class="ttc" id="astructMatShellCtx_html_a04555832d4416ff0e20253b6fd98b6d2"><div class="ttname"><a href="structMatShellCtx.html#a04555832d4416ff0e20253b6fd98b6d2">MatShellCtx::oscil_vec</a></div><div class="ttdeci">Oscillator ** oscil_vec</div><div class="ttdoc">Array of pointers to the oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:24</div></div>
<div class="ttc" id="astructMatShellCtx_html_a064ecab1e678a757d3555ea1d8fd13b7"><div class="ttname"><a href="structMatShellCtx.html#a064ecab1e678a757d3555ea1d8fd13b7">MatShellCtx::nlevels</a></div><div class="ttdeci">std::vector&lt; int &gt; nlevels</div><div class="ttdoc">Number of levels per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:22</div></div>
<div class="ttc" id="astructMatShellCtx_html_a0e414f19d926dfcfbd673069aa0bd60c"><div class="ttname"><a href="structMatShellCtx.html#a0e414f19d926dfcfbd673069aa0bd60c">MatShellCtx::aux</a></div><div class="ttdeci">Vec * aux</div><div class="ttdoc">Auxiliary vector for computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:40</div></div>
<div class="ttc" id="astructMatShellCtx_html_a34c21d5b991c90f4dc49f8007772870a"><div class="ttname"><a href="structMatShellCtx.html#a34c21d5b991c90f4dc49f8007772870a">MatShellCtx::Jkl</a></div><div class="ttdeci">std::vector&lt; double &gt; Jkl</div><div class="ttdoc">Dipole-dipole coupling strength.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:26</div></div>
<div class="ttc" id="astructMatShellCtx_html_a4163f6fb8f64ba0184f3ebb50bd69a39"><div class="ttname"><a href="structMatShellCtx.html#a4163f6fb8f64ba0184f3ebb50bd69a39">MatShellCtx::eta</a></div><div class="ttdeci">std::vector&lt; double &gt; eta</div><div class="ttdoc">Frequency differences of the rotating frames.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:27</div></div>
<div class="ttc" id="astructMatShellCtx_html_a6d70c2aeb5c6016d867aab74747d0125"><div class="ttname"><a href="structMatShellCtx.html#a6d70c2aeb5c6016d867aab74747d0125">MatShellCtx::crosskerr</a></div><div class="ttdeci">std::vector&lt; double &gt; crosskerr</div><div class="ttdoc">Cross-Kerr coupling coefficients.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:25</div></div>
<div class="ttc" id="astructMatShellCtx_html_a7444246ae4834351b67ceee29481287c"><div class="ttname"><a href="structMatShellCtx.html#a7444246ae4834351b67ceee29481287c">MatShellCtx::time</a></div><div class="ttdeci">double time</div><div class="ttdoc">Current time.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:41</div></div>
<div class="ttc" id="astructMatShellCtx_html_a82a20720c0e8ad791f959153ffee0a7b"><div class="ttname"><a href="structMatShellCtx.html#a82a20720c0e8ad791f959153ffee0a7b">MatShellCtx::lindbladtype</a></div><div class="ttdeci">LindbladType lindbladtype</div><div class="ttdoc">Type of Lindblad operators to include.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:28</div></div>
<div class="ttc" id="astructMatShellCtx_html_a877b20ea0213d60200aa2a6c829851f1"><div class="ttname"><a href="structMatShellCtx.html#a877b20ea0213d60200aa2a6c829851f1">MatShellCtx::Ad</a></div><div class="ttdeci">Mat * Ad</div><div class="ttdoc">Real parts of time-independent system matrix.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:34</div></div>
<div class="ttc" id="astructMatShellCtx_html_a905421e3d386aeb7dbf2d33f29b4faca"><div class="ttname"><a href="structMatShellCtx.html#a905421e3d386aeb7dbf2d33f29b4faca">MatShellCtx::control_Im</a></div><div class="ttdeci">std::vector&lt; double &gt; control_Im</div><div class="ttdoc">Imaginary parts of control pulse .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:31</div></div>
<div class="ttc" id="astructMatShellCtx_html_a99b166bb3aac8fa812438349afafcc8a"><div class="ttname"><a href="structMatShellCtx.html#a99b166bb3aac8fa812438349afafcc8a">MatShellCtx::dim</a></div><div class="ttdeci">PetscInt dim</div><div class="ttdoc">Dimension of full vectorized system: N^2 if Lindblad, N if Schroedinger.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:21</div></div>
<div class="ttc" id="astructMatShellCtx_html_a9ba1788479840f371c24f631cc988f87"><div class="ttname"><a href="structMatShellCtx.html#a9ba1788479840f371c24f631cc988f87">MatShellCtx::control_Re</a></div><div class="ttdeci">std::vector&lt; double &gt; control_Re</div><div class="ttdoc">Real parts of control pulse .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:30</div></div>
<div class="ttc" id="astructMatShellCtx_html_aacf5514257ab43f9b825194f2f43b251"><div class="ttname"><a href="structMatShellCtx.html#aacf5514257ab43f9b825194f2f43b251">MatShellCtx::Bd_coeffs</a></div><div class="ttdeci">std::vector&lt; double &gt; Bd_coeffs</div><div class="ttdef"><b>Definition</b> mastereq.hpp:38</div></div>
<div class="ttc" id="astructMatShellCtx_html_ab5de01663fc3402b60fde1868073b33d"><div class="ttname"><a href="structMatShellCtx.html#ab5de01663fc3402b60fde1868073b33d">MatShellCtx::Ac_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Ac_vec</div><div class="ttdoc">Vector of real parts of control matrices per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:32</div></div>
<div class="ttc" id="astructMatShellCtx_html_abf9f8b8348e0c0aa80e73ab45b3cae3b"><div class="ttname"><a href="structMatShellCtx.html#abf9f8b8348e0c0aa80e73ab45b3cae3b">MatShellCtx::isu</a></div><div class="ttdeci">IS * isu</div><div class="ttdef"><b>Definition</b> mastereq.hpp:23</div></div>
<div class="ttc" id="astructMatShellCtx_html_abfb6725d58118545ef1e714c37a76ee0"><div class="ttname"><a href="structMatShellCtx.html#abfb6725d58118545ef1e714c37a76ee0">MatShellCtx::Bd</a></div><div class="ttdeci">Mat * Bd</div><div class="ttdoc">Imaginary parts of time-independent system matrix.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:35</div></div>
<div class="ttc" id="astructMatShellCtx_html_ac082372639074f8f52e4587f285e4cd3"><div class="ttname"><a href="structMatShellCtx.html#ac082372639074f8f52e4587f285e4cd3">MatShellCtx::Ad_coeffs</a></div><div class="ttdeci">std::vector&lt; double &gt; Ad_coeffs</div><div class="ttdef"><b>Definition</b> mastereq.hpp:39</div></div>
<div class="ttc" id="astructMatShellCtx_html_adb5a65dd9d7be5752fa6dffec62ab0c9"><div class="ttname"><a href="structMatShellCtx.html#adb5a65dd9d7be5752fa6dffec62ab0c9">MatShellCtx::addT1</a></div><div class="ttdeci">bool addT1</div><div class="ttdef"><b>Definition</b> mastereq.hpp:29</div></div>
<div class="ttc" id="astructMatShellCtx_html_ae10aee7fdcd0267229a54dd6d9e7ace1"><div class="ttname"><a href="structMatShellCtx.html#ae10aee7fdcd0267229a54dd6d9e7ace1">MatShellCtx::Bd_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Bd_vec</div><div class="ttdoc">Vector of imaginary parts of dipole-dipole coupling system matrices.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:37</div></div>
<div class="ttc" id="astructMatShellCtx_html_af642a8e235a41ff9e672d784620a05d2"><div class="ttname"><a href="structMatShellCtx.html#af642a8e235a41ff9e672d784620a05d2">MatShellCtx::Bc_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Bc_vec</div><div class="ttdoc">Vector of imaginary parts of control matrices per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:33</div></div>
<div class="ttc" id="autil_8hpp_html"><div class="ttname"><a href="util_8hpp.html">util.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
