<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quandary: /home/runner/work/quandary/quandary/include/mastereq.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Quandary
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">mastereq.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="mastereq_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;<a class="code" href="defs_8hpp.html">defs.hpp</a>&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &quot;<a class="code" href="oscillator_8hpp.html">oscillator.hpp</a>&quot;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &quot;<a class="code" href="util_8hpp.html">util.hpp</a>&quot;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;petscts.h&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;iostream&gt;</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;<a class="code" href="gate_8hpp.html">gate.hpp</a>&quot;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="hamiltonianfilereader_8hpp.html">hamiltonianfilereader.hpp</a>&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="foldopen" id="foldopen00019" data-start="{" data-end="};">
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno"><a class="line" href="structMatShellCtx.html">   19</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a064ecab1e678a757d3555ea1d8fd13b7">   20</a></span>  std::vector&lt;int&gt; <a class="code hl_variable" href="structMatShellCtx.html#a064ecab1e678a757d3555ea1d8fd13b7">nlevels</a>; </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#abf9f8b8348e0c0aa80e73ab45b3cae3b">   21</a></span>  IS *<a class="code hl_variable" href="structMatShellCtx.html#abf9f8b8348e0c0aa80e73ab45b3cae3b">isu</a>, *isv; </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a04555832d4416ff0e20253b6fd98b6d2">   22</a></span>  <a class="code hl_class" href="classOscillator.html">Oscillator</a>** <a class="code hl_variable" href="structMatShellCtx.html#a04555832d4416ff0e20253b6fd98b6d2">oscil_vec</a>; </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a6d70c2aeb5c6016d867aab74747d0125">   23</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a6d70c2aeb5c6016d867aab74747d0125">crosskerr</a>; </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a34c21d5b991c90f4dc49f8007772870a">   24</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a34c21d5b991c90f4dc49f8007772870a">Jkl</a>; </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a4163f6fb8f64ba0184f3ebb50bd69a39">   25</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a4163f6fb8f64ba0184f3ebb50bd69a39">eta</a>; </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a82a20720c0e8ad791f959153ffee0a7b">   26</a></span>  <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> <a class="code hl_variable" href="structMatShellCtx.html#a82a20720c0e8ad791f959153ffee0a7b">lindbladtype</a>; </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#adb5a65dd9d7be5752fa6dffec62ab0c9">   27</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="structMatShellCtx.html#adb5a65dd9d7be5752fa6dffec62ab0c9">addT1</a>, addT2; </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#aece20973a9e46bf7a6c7359d0433ce59">   28</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code hl_variable" href="structMatShellCtx.html#aece20973a9e46bf7a6c7359d0433ce59">control_Re</a>; </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#ad803d2b68dc35ce7718b0401f81b08c6">   29</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code hl_variable" href="structMatShellCtx.html#ad803d2b68dc35ce7718b0401f81b08c6">control_Im</a>; </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a35412254e1443f6067a4426bb8cd8f73">   30</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#a35412254e1443f6067a4426bb8cd8f73">eval_transfer_Hdt_re</a>; </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#ae6b69e7f840a9e42ee0021bccc9a96a6">   31</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="structMatShellCtx.html#ae6b69e7f840a9e42ee0021bccc9a96a6">eval_transfer_Hdt_im</a>; </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a94225b343a1fb5c88a86dee9ae70fb17">   32</a></span>  std::vector&lt;std::vector&lt;Mat&gt;&gt; <a class="code hl_variable" href="structMatShellCtx.html#a94225b343a1fb5c88a86dee9ae70fb17">Ac_vec</a>; </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a676903557b02ac5450346a60cc241ca1">   33</a></span>  std::vector&lt;std::vector&lt;Mat&gt;&gt; <a class="code hl_variable" href="structMatShellCtx.html#a676903557b02ac5450346a60cc241ca1">Bc_vec</a>; </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a877b20ea0213d60200aa2a6c829851f1">   34</a></span>  Mat *<a class="code hl_variable" href="structMatShellCtx.html#a877b20ea0213d60200aa2a6c829851f1">Ad</a>; </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#abfb6725d58118545ef1e714c37a76ee0">   35</a></span>  Mat *<a class="code hl_variable" href="structMatShellCtx.html#abfb6725d58118545ef1e714c37a76ee0">Bd</a>; </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a0033984ce7821240a254b2666e0d8ec4">   36</a></span>  std::vector&lt;Mat&gt; <a class="code hl_variable" href="structMatShellCtx.html#a0033984ce7821240a254b2666e0d8ec4">Ad_vec</a>; </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#ae10aee7fdcd0267229a54dd6d9e7ace1">   37</a></span>  std::vector&lt;Mat&gt; <a class="code hl_variable" href="structMatShellCtx.html#ae10aee7fdcd0267229a54dd6d9e7ace1">Bd_vec</a>; </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a0e414f19d926dfcfbd673069aa0bd60c">   38</a></span>  Vec *<a class="code hl_variable" href="structMatShellCtx.html#a0e414f19d926dfcfbd673069aa0bd60c">aux</a>; </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="structMatShellCtx.html#a7444246ae4834351b67ceee29481287c">   39</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structMatShellCtx.html#a7444246ae4834351b67ceee29481287c">time</a>; </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>} <a class="code hl_struct" href="structMatShellCtx.html">MatShellCtx</a>;</div>
</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a51afc704134d4d253dabccbb0b74ccb0">myMatMult_matfree_1Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a29911a6f06e34dadc8ca88eedbe433a1">myMatMultTranspose_matfree_1Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#acc1f746c70fd004036f87beae614c1cf">myMatMult_matfree_2Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a0fef44cebdfdb5624036cebb4c83e6bb">myMatMultTranspose_matfree_2Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#afd69ebcffc76a1b1d769f38d0869f7d4">myMatMult_matfree_3Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aadd2b7b46eda1bb4a04e955eeec4d1ea">myMatMultTranspose_matfree_3Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a81a7c6c361fc7b695ba996cd4275e9cd">myMatMult_matfree_4Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a6e6afdba2dbb5fc6b47cc5c7dc9fdfc3">myMatMultTranspose_matfree_4Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a3c5850f7bd0694b00e3fae67818aae23">myMatMult_matfree_5Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a8b6f983b0177602e78148e8d734eca25">myMatMultTranspose_matfree_5Osc</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a241b317b3155d9b7bdad401893fbc910">myMatMult_sparsemat</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#a5f4095237dba306b4e56ad26fb5b5f9d">myMatMultTranspose_sparsemat</a>(Mat RHS, Vec x, Vec y); </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="foldopen" id="foldopen00087" data-start="{" data-end="};">
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="classMasterEq.html">   87</a></span><span class="keyword">class </span><a class="code hl_class" href="classMasterEq.html">MasterEq</a>{</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="classMasterEq.html#a346265de8ee28b5420cf0fe4b0c180ed">   90</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#a346265de8ee28b5420cf0fe4b0c180ed">dim</a>; </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7112f8144791299af573cf9479a370c8">   91</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#a7112f8144791299af573cf9479a370c8">dim_rho</a>; </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="classMasterEq.html#a5dfe8c17afb1a56643f98e59539949fd">   92</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#a5dfe8c17afb1a56643f98e59539949fd">dim_ess</a>; </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">   93</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">noscillators</a>; </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">   94</a></span>    <a class="code hl_class" href="classOscillator.html">Oscillator</a>** <a class="code hl_variable" href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">oscil_vec</a>; </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">   96</a></span>    Mat <a class="code hl_variable" href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">RHS</a>; </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">   97</a></span>    <a class="code hl_struct" href="structMatShellCtx.html">MatShellCtx</a> <a class="code hl_variable" href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">RHSctx</a>; </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="classMasterEq.html#aa30454ed43e280918df0e2dc06954e84">   99</a></span>    std::vector&lt;std::vector&lt;Mat&gt;&gt; <a class="code hl_variable" href="classMasterEq.html#aa30454ed43e280918df0e2dc06954e84">Ac_vec</a>; </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="classMasterEq.html#afb1c97886b5a327dc888caf9ba902db8">  100</a></span>    std::vector&lt;std::vector&lt;Mat&gt;&gt; <a class="code hl_variable" href="classMasterEq.html#afb1c97886b5a327dc888caf9ba902db8">Bc_vec</a>; </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">  101</a></span>    Mat <a class="code hl_variable" href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">Ad</a>;  </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="classMasterEq.html#a2afd1529a3b1793aa87ad1c008ef212a">  102</a></span>    Mat <a class="code hl_variable" href="classMasterEq.html#a2afd1529a3b1793aa87ad1c008ef212a">Bd</a>; </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">  103</a></span>    std::vector&lt;Mat&gt; <a class="code hl_variable" href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">Ad_vec</a>; </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">  104</a></span>    std::vector&lt;Mat&gt; <a class="code hl_variable" href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">Bd_vec</a>; </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">  106</a></span>    std::vector&lt;double&gt; <a class="code hl_variable" href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">crosskerr</a>; </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">  107</a></span>    std::vector&lt;double&gt; <a class="code hl_variable" href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">Jkl</a>; </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">  108</a></span>    std::vector&lt;double&gt; <a class="code hl_variable" href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">eta</a>; </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">  109</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">addT1</a>, <a class="code hl_variable" href="classMasterEq.html#a0674aab017f75be72e15d45385a1ebf8">addT2</a>; </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">  111</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">mpirank_petsc</a>; </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">  112</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">mpirank_world</a>; </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="classMasterEq.html#a1ee5ff4c7f62f433e539c0d790ac39d6">  113</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="classMasterEq.html#a1ee5ff4c7f62f433e539c0d790ac39d6">nparams_max</a>; </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">  114</a></span>    IS <a class="code hl_variable" href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">isu</a>, <a class="code hl_variable" href="classMasterEq.html#a53b5dbe948eb0eb8570e4555d7ebedaa">isv</a>; </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="classMasterEq.html#a3117c4885b24a0d9d88fff234c5593e8">  116</a></span>    <span class="keywordtype">double</span> *<a class="code hl_variable" href="classMasterEq.html#a3117c4885b24a0d9d88fff234c5593e8">dRedp</a>; </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="classMasterEq.html#aafbc713ebc3d42731dc44d727db530d8">  117</a></span>    <span class="keywordtype">double</span> *<a class="code hl_variable" href="classMasterEq.html#aafbc713ebc3d42731dc44d727db530d8">dImdp</a>; </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">  118</a></span>    Vec <a class="code hl_variable" href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">aux</a>; </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="classMasterEq.html#a3d518b166eba640dc61c708ba2ea9e2d">  119</a></span>    PetscInt* <a class="code hl_variable" href="classMasterEq.html#a3d518b166eba640dc61c708ba2ea9e2d">cols</a>; </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6e00f02e3b6cfab7fb90cb70de265aff">  120</a></span>    PetscScalar* <a class="code hl_variable" href="classMasterEq.html#a6e00f02e3b6cfab7fb90cb70de265aff">vals</a>; </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">  122</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">quietmode</a>; </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">  125</a></span>    std::vector&lt;int&gt; <a class="code hl_variable" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">nlevels</a>; </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">  126</a></span>    std::vector&lt;int&gt; <a class="code hl_variable" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">nessential</a>; </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">  127</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">usematfree</a>; </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">  128</a></span>    <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> <a class="code hl_variable" href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">lindbladtype</a>; </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="classMasterEq.html#a30f051e65c04523f63db05f357d2f29f">  130</a></span>    std::vector&lt;std::vector&lt;TransferFunction*&gt;&gt; <a class="code hl_variable" href="classMasterEq.html#a30f051e65c04523f63db05f357d2f29f">transfer_Hc_re</a>; </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="classMasterEq.html#ae881b4c040b27af6bb119b97e8757688">  131</a></span>    std::vector&lt;std::vector&lt;TransferFunction*&gt;&gt; <a class="code hl_variable" href="classMasterEq.html#ae881b4c040b27af6bb119b97e8757688">transfer_Hc_im</a>; </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac268a9ef050250e6b0005f61f284b274">  132</a></span>    std::vector&lt;TransferFunction*&gt; <a class="code hl_variable" href="classMasterEq.html#ac268a9ef050250e6b0005f61f284b274">transfer_Hdt_re</a>; </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="classMasterEq.html#ad0644cc00ef5b0616947d733a59c4a01">  133</a></span>    std::vector&lt;TransferFunction*&gt; <a class="code hl_variable" href="classMasterEq.html#ad0644cc00ef5b0616947d733a59c4a01">transfer_Hdt_im</a>; </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="classMasterEq.html#a68172dcac6206bd43927af847b87b822">  134</a></span>    std::string <a class="code hl_variable" href="classMasterEq.html#a68172dcac6206bd43927af847b87b822">hamiltonian_file</a>; </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <a class="code hl_function" href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq</a>();</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_function" href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq</a>(std::vector&lt;int&gt; <a class="code hl_variable" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">nlevels</a>, std::vector&lt;int&gt; <a class="code hl_variable" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">nessential</a>, <a class="code hl_class" href="classOscillator.html">Oscillator</a>** oscil_vec_, <span class="keyword">const</span> std::vector&lt;double&gt; crosskerr_, <span class="keyword">const</span> std::vector&lt;double&gt; Jkl_, <span class="keyword">const</span> std::vector&lt;double&gt; eta_, <a class="code hl_enumeration" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> lindbladtype_, <span class="keywordtype">bool</span> usematfree_, std::string <a class="code hl_variable" href="classMasterEq.html#a68172dcac6206bd43927af847b87b822">hamiltonian_file</a>, <span class="keywordtype">bool</span> <a class="code hl_variable" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">quietmode</a>=<span class="keyword">false</span>);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <a class="code hl_function" href="classMasterEq.html#af9b8723f0500416cd3d2fcdd14fd9483">~MasterEq</a>();</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#aad34fc836f709483b81b724d8ec9f94c">initSparseMatSolver</a>();</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="classMasterEq.html#ac8307cc795eb6e82eb3a3e8c71385d7e">  168</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#ac8307cc795eb6e82eb3a3e8c71385d7e">setTransferOnOffTimes</a>(std::vector&lt;double&gt; tlist);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <a class="code hl_class" href="classOscillator.html">Oscillator</a>* <a class="code hl_function" href="classMasterEq.html#a7e880910441b27fde4ff1aef4de2aac4">getOscillator</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> i);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="classMasterEq.html#a601f1831ffce18ea5be8fd68e7bd60c2">getNOscillators</a>();</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classMasterEq.html#a3410d6f6f9ef27932610fea1c2e28d39">getDim</a>();</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classMasterEq.html#a94c9e247bd0aac8468c07d94cfb3097b">getDimEss</a>();</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classMasterEq.html#aa8fcd6a14c34c63cf8036c300c48f1ed">getDimRho</a>();</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classMasterEq.html#aadb9c6cdd2162ee2df713e40a72f7d5c">assemble_RHS</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> t);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    Mat <a class="code hl_function" href="classMasterEq.html#a114fff980e3a46ceeb53bbd7167c416f">getRHS</a>();</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#aefff9fce71e094f6b2d25c70caf6ef22">computedRHSdp</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> t,<span class="keyword">const</span> Vec x,<span class="keyword">const</span> Vec x_bar, <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, Vec grad);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="comment">// /* Compute reduced density operator for a sub-system defined by IDs in the oscilIDs vector */</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="comment">// void createReducedDensity(const Vec rho, Vec *reduced, const std::vector&lt;int&gt;&amp; oscilIDs);</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="comment">// /* Derivative of reduced density computation */</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// void createReducedDensity_diff(Vec rhobar, const Vec reducedbar, const std::vector&lt;int&gt;&amp; oscilIDs);</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#af747a9c4013860f785cd80fe52e7f457">setControlAmplitudes</a>(<span class="keyword">const</span> Vec x);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classMasterEq.html#aae5fbd62a0766d20ec823a001da6f570">expectedEnergy</a>(<span class="keyword">const</span> Vec x);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classMasterEq.html#a9308372d3f1aa99517dd313d5d2a4cd9">population</a>(<span class="keyword">const</span> Vec x, std::vector&lt;double&gt; &amp;population_com);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>};</div>
</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="comment">// Matrix-free solver inlines for 1 oscillator</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="foldopen" id="foldopen00276" data-start="{" data-end="}">
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">  276</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">int</span> a) {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  <span class="keywordflow">return</span> detuning0*a;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>};</div>
</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="foldopen" id="foldopen00287" data-start="{" data-end="}">
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">  287</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">int</span> a) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * a * (a-1);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>};</div>
</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="foldopen" id="foldopen00299" data-start="{" data-end="}">
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">  299</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p){</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) );</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>};</div>
</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="foldopen" id="foldopen00311" data-start="{" data-end="}">
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">  311</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p){</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) ;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>};</div>
</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="foldopen" id="foldopen00323" data-start="{" data-end="}">
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">  323</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p){</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  <span class="keywordflow">return</span> i0 + nlevels0 * i0p;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>};</div>
</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span><span class="comment">// Matrix-free solver inlines for 2 oscillators</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="foldopen" id="foldopen00339" data-start="{" data-end="}">
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a157c2e11aec50060bd1bbe1e67294f2e">  339</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">int</span> a, <span class="keyword">const</span> <span class="keywordtype">int</span> b) {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  <span class="keywordflow">return</span> detuning0*a + detuning1*b;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>};</div>
</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="foldopen" id="foldopen00352" data-start="{" data-end="}">
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ac561c889f846efb29ef1588401371cff">  352</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">int</span> a, <span class="keyword">const</span> <span class="keywordtype">int</span> b) {</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * a * (a-1) - xi1 / 2.0 * b * (b-1);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>};</div>
</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="foldopen" id="foldopen00364" data-start="{" data-end="}">
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">  364</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">int</span> a, <span class="keyword">const</span> <span class="keywordtype">int</span> b) {</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  <span class="keywordflow">return</span> - xi01 * a * b;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>};</div>
</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="foldopen" id="foldopen00379" data-start="{" data-end="}">
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a27a651b0ad18d46dff30d0cb6a820e1c">  379</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p){</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) );</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>};</div>
</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="foldopen" id="foldopen00394" data-start="{" data-end="}">
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a019a4ad308b966a3284dde2cdc019c51">  394</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p){</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) - decay1 / 2.0 * ( i1 + i1p );</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>};</div>
</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="foldopen" id="foldopen00409" data-start="{" data-end="}">
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aa1ea516a7cd11e6c60c621fa304389bb">  409</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1,<span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p){</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>  <span class="keywordflow">return</span> i0*nlevels1 + i1 + (nlevels0 * nlevels1) * ( i0p * nlevels1 + i1p);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>};</div>
</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span><span class="comment">// Matrix-free solver inlines for 3 oscillators</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span><span class="comment">// See documentation for 1-2 oscillator functions above for parameter descriptions</span></div>
<div class="foldopen" id="foldopen00416" data-start="{" data-end="}">
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#abbf91cc9a73f3f2e4966ded0c679c985">  416</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2) {</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>  <span class="keywordflow">return</span> detuning0*i0 + detuning1*i1 + detuning2*i2;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>};</div>
</div>
<div class="foldopen" id="foldopen00419" data-start="{" data-end="}">
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a978b3dd569adb84b95937e290708b7a8">  419</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">double</span> xi2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2) {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * i0 * (i0-1) - xi1 / 2.0 * i1 * (i1-1) - xi2 / 2.0 * i2 * (i2-1);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>};</div>
</div>
<div class="foldopen" id="foldopen00422" data-start="{" data-end="}">
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#abc2d15a8a43d9840db4ba04b250dc645">  422</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">double</span> xi02, <span class="keyword">const</span> <span class="keywordtype">double</span> xi12, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2) {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>  <span class="keywordflow">return</span> - xi01 * i0 * i1 - xi02 * i0 * i2 - xi12 * i1 * i2;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>};</div>
</div>
<div class="foldopen" id="foldopen00425" data-start="{" data-end="}">
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ac4b18159caf2bcb246193982e4716ab6">  425</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p){</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>       + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) )</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>       + dephase2 * ( i2*i2p - 1./2. * (i2*i2 + i2p*i2p) );</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>};</div>
</div>
<div class="foldopen" id="foldopen00430" data-start="{" data-end="}">
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a59c24ddb3c27391c1c92d763f00f402d">  430</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">double</span> decay2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p){</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>         - decay1 / 2.0 * ( i1 + i1p )</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>         - decay2 / 2.0 * ( i2 + i2p );</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>};</div>
</div>
<div class="foldopen" id="foldopen00435" data-start="{" data-end="}">
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#abd22a8cbb2ceb40ec6966a6dd6eebe50">  435</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels2, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p){</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  <span class="keywordflow">return</span> i0*nlevels1*nlevels2 + i1*nlevels2 + i2 + (nlevels0 * nlevels1 * nlevels2) * ( i0p * nlevels1*nlevels2 + i1p*nlevels2 + i2p);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>};</div>
</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span><span class="comment">// Matrix-free solver inlines for 4 oscillators</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="comment">// See documentation for 1-2 oscillator functions above for parameter descriptions</span></div>
<div class="foldopen" id="foldopen00442" data-start="{" data-end="}">
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#adba418d947542f6b1a03166c0c0ad87c">  442</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning2, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3) {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <span class="keywordflow">return</span> detuning0*i0 + detuning1*i1 + detuning2*i2 + detuning3*i3;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>};</div>
</div>
<div class="foldopen" id="foldopen00445" data-start="{" data-end="}">
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a7b9f537ea7b1b1992cb3b5126e169afe">  445</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">double</span> xi2, <span class="keyword">const</span> <span class="keywordtype">double</span> xi3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3) {</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * i0 * (i0-1) - xi1 / 2.0 * i1 * (i1-1) - xi2 / 2.0 * i2 * (i2-1) - xi3/2.0 * i3 * (i3-1);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>};</div>
</div>
<div class="foldopen" id="foldopen00448" data-start="{" data-end="}">
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a173ac51d68a13a1b440cb8929d97cf27">  448</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">double</span> xi02, <span class="keyword">const</span> <span class="keywordtype">double</span> xi03, <span class="keyword">const</span> <span class="keywordtype">double</span> xi12, <span class="keyword">const</span> <span class="keywordtype">double</span> xi13, <span class="keyword">const</span> <span class="keywordtype">double</span> xi23, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3) {</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keywordflow">return</span> - xi01 * i0 * i1 - xi02 * i0 * i2  - xi03*i0*i3 - xi12 * i1 * i2 - xi13*i1*i3 - xi23*i2*i3;</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>};</div>
</div>
<div class="foldopen" id="foldopen00451" data-start="{" data-end="}">
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a4f27133e204b9a010d3e63037a803974">  451</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase2, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p){</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>       + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) )</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>       + dephase2 * ( i2*i2p - 1./2. * (i2*i2 + i2p*i2p) )</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>       + dephase3 * ( i3*i3p - 1./2. * (i3*i3 + i3p*i3p) );</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>};</div>
</div>
<div class="foldopen" id="foldopen00457" data-start="{" data-end="}">
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a68fd0485f1b01c12e74f1146491f304e">  457</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">double</span> decay2, <span class="keyword">const</span> <span class="keywordtype">double</span> decay3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p){</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>         - decay1 / 2.0 * ( i1 + i1p )</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>         - decay2 / 2.0 * ( i2 + i2p )</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>         - decay3 / 2.0 * ( i3 + i3p );</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>};</div>
</div>
<div class="foldopen" id="foldopen00463" data-start="{" data-end="}">
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#afbfaf8a66011785f2b7b13c334e3d90b">  463</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels2, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels3, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p){</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>  <span class="keywordflow">return</span> i0*nlevels1*nlevels2*nlevels3 + i1*nlevels2*nlevels3 + i2*nlevels3 + i3 + (nlevels0 * nlevels1 * nlevels2 * nlevels3) * ( i0p * nlevels1*nlevels2*nlevels3 + i1p*nlevels2*nlevels3 + i2p*nlevels3 + i3p);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>}</div>
</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="comment">// Matrix-free solver inlines for 5 oscillators</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="comment">// See documentation for 1-2 oscillator functions above for parameter descriptions</span></div>
<div class="foldopen" id="foldopen00469" data-start="{" data-end="}">
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab44c53bd61ab24396ffcef8e7a6b7887">  469</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> detuning0, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning1, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning2, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning3, <span class="keyword">const</span> <span class="keywordtype">double</span> detuning4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4) {</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  <span class="keywordflow">return</span> detuning0*i0 + detuning1*i1 + detuning2*i2 + detuning3*i3 + detuning4*i4;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>};</div>
</div>
<div class="foldopen" id="foldopen00472" data-start="{" data-end="}">
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a642af45a3b3f32b1fb290b5c14b1d8de">  472</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi0, <span class="keyword">const</span> <span class="keywordtype">double</span> xi1, <span class="keyword">const</span> <span class="keywordtype">double</span> xi2, <span class="keyword">const</span> <span class="keywordtype">double</span> xi3, <span class="keyword">const</span> <span class="keywordtype">double</span> xi4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4) {</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  <span class="keywordflow">return</span> - xi0 / 2.0 * i0 * (i0-1) - xi1 / 2.0 * i1 * (i1-1) - xi2 / 2.0 * i2 * (i2-1) - xi3/2.0 * i3 * (i3-1) - xi4/2.0 * i4 * (i4-1);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>};</div>
</div>
<div class="foldopen" id="foldopen00475" data-start="{" data-end="}">
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a86d8c64d53f47d536659aee2bdf4d21f">  475</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xi01, <span class="keyword">const</span> <span class="keywordtype">double</span> xi02, <span class="keyword">const</span> <span class="keywordtype">double</span> xi03, <span class="keyword">const</span> <span class="keywordtype">double</span> xi04, <span class="keyword">const</span> <span class="keywordtype">double</span> xi12, <span class="keyword">const</span> <span class="keywordtype">double</span> xi13, <span class="keyword">const</span> <span class="keywordtype">double</span> xi14, <span class="keyword">const</span> <span class="keywordtype">double</span> xi23, <span class="keyword">const</span> <span class="keywordtype">double</span> xi24, <span class="keyword">const</span> <span class="keywordtype">double</span> xi34, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>  <span class="keywordflow">return</span> - xi01 * i0 * i1 - xi02 * i0 * i2  - xi03*i0*i3 - xi04*i0*i4 - xi12 * i1 * i2 - xi13*i1*i3 - xi14*i1*i4 - xi23*i2*i3 - xi24*i2*i4 - xi34*i3*i4;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>};</div>
</div>
<div class="foldopen" id="foldopen00478" data-start="{" data-end="}">
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a8377794a7efa34f065c75e3fa255281c">  478</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dephase0, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase1, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase2, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase3, <span class="keyword">const</span> <span class="keywordtype">double</span> dephase4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p, <span class="keyword">const</span> <span class="keywordtype">int</span> i4p){</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  <span class="keywordflow">return</span> dephase0 * ( i0*i0p - 1./2. * (i0*i0 + i0p*i0p) ) </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>       + dephase1 * ( i1*i1p - 1./2. * (i1*i1 + i1p*i1p) )</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>       + dephase2 * ( i2*i2p - 1./2. * (i2*i2 + i2p*i2p) )</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>       + dephase3 * ( i3*i3p - 1./2. * (i3*i3 + i3p*i3p) )</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>       + dephase4 * ( i4*i4p - 1./2. * (i4*i4 + i4p*i4p) );</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>};</div>
</div>
<div class="foldopen" id="foldopen00485" data-start="{" data-end="}">
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab9db8a05c90cfaa114286dafd95ee61b">  485</a></span><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> decay0, <span class="keyword">const</span> <span class="keywordtype">double</span> decay1, <span class="keyword">const</span> <span class="keywordtype">double</span> decay2, <span class="keyword">const</span> <span class="keywordtype">double</span> decay3, <span class="keyword">const</span> <span class="keywordtype">double</span> decay4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p, <span class="keyword">const</span> <span class="keywordtype">int</span> i4p){</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>  <span class="keywordflow">return</span> - decay0 / 2.0 * ( i0 + i0p ) </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>         - decay1 / 2.0 * ( i1 + i1p )</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>         - decay2 / 2.0 * ( i2 + i2p )</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>         - decay3 / 2.0 * ( i3 + i3p )</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>         - decay4 / 2.0 * ( i4 + i4p );</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>};</div>
</div>
<div class="foldopen" id="foldopen00492" data-start="{" data-end="}">
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a418d121bd4b2619395278c41978fa9eb">  492</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nlevels0, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels1, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels2, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels3, <span class="keyword">const</span> <span class="keywordtype">int</span> nlevels4, <span class="keyword">const</span>  <span class="keywordtype">int</span> i0, <span class="keyword">const</span> <span class="keywordtype">int</span> i1, <span class="keyword">const</span> <span class="keywordtype">int</span> i2, <span class="keyword">const</span> <span class="keywordtype">int</span> i3, <span class="keyword">const</span> <span class="keywordtype">int</span> i4, <span class="keyword">const</span> <span class="keywordtype">int</span> i0p, <span class="keyword">const</span> <span class="keywordtype">int</span> i1p, <span class="keyword">const</span> <span class="keywordtype">int</span> i2p, <span class="keyword">const</span> <span class="keywordtype">int</span> i3p, <span class="keyword">const</span> <span class="keywordtype">int</span> i4p){</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>  <span class="keywordflow">return</span> i0*nlevels1*nlevels2*nlevels3*nlevels4 + i1*nlevels2*nlevels3*nlevels4 + i2*nlevels3*nlevels4 + i3*nlevels4 + i4 + (nlevels0 * nlevels1 * nlevels2 * nlevels3*nlevels4) * ( i0p * nlevels1*nlevels2*nlevels3*nlevels4 + i1p*nlevels2*nlevels3*nlevels4 + i2p*nlevels3*nlevels4+ i3p*nlevels4 + i4p);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>}</div>
</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="foldopen" id="foldopen00515" data-start="{" data-end="}">
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a30e19fc9f17030c99d9f1efb4f76db43">  515</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a30e19fc9f17030c99d9f1efb4f76db43">dRHSdp_getcoeffs</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> np, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keywordtype">double</span>* res_p_re, <span class="keywordtype">double</span>* res_p_im, <span class="keywordtype">double</span>* res_q_re, <span class="keywordtype">double</span>* res_q_im) {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  *res_p_re = 0.0;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  *res_p_im = 0.0;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  *res_q_re = 0.0;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  *res_q_im = 0.0;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <span class="comment">/* ik+1..,ik&#39;.. term */</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <span class="keywordflow">if</span> (i &lt; n-1) {</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    <span class="keywordtype">int</span> itx = it + stridei;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    <span class="keywordtype">double</span> sq = sqrt(i + 1);</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    *res_p_re +=   sq * xim;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    *res_p_im += - sq * xre;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    *res_q_re +=   sq * xre;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    *res_q_im +=   sq * xim;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  <span class="comment">/* \rho(ik..,ik&#39;+1..) */</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  <span class="keywordflow">if</span> (ip &lt; np-1) {</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="keywordtype">int</span> itx = it + strideip;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <span class="keywordtype">double</span> sq = sqrt(ip + 1);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    *res_p_re += - sq * xim;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    *res_p_im += + sq * xre;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    *res_q_re +=   sq * xre;</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    *res_q_im +=   sq * xim;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  }</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  <span class="comment">/* \rho(ik-1..,ik&#39;..) */</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    <span class="keywordtype">int</span> itx = it - stridei;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    <span class="keywordtype">double</span> sq = sqrt(i);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    *res_p_re += + sq * xim;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    *res_p_im += - sq * xre;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    *res_q_re += - sq * xre;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    *res_q_im += - sq * xim;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="comment">/* \rho(ik..,ik&#39;-1..) */</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="keywordflow">if</span> (ip &gt; 0) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keywordtype">int</span> itx = it - strideip;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="keywordtype">double</span> sq = sqrt(ip);</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    *res_p_re += - sq * xim;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    *res_p_im += + sq * xre;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    *res_q_re += - sq * xre;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    *res_q_im += - sq * xim;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  }</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>}</div>
</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="foldopen" id="foldopen00593" data-start="{" data-end="}">
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ac5c01379a727f6e4065d00fc81a3d7f8">  593</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#ac5c01379a727f6e4065d00fc81a3d7f8">Jkl_coupling</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj, <span class="keyword">const</span> <span class="keywordtype">int</span> nip, <span class="keyword">const</span> <span class="keywordtype">int</span> njp, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">int</span> jp, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridej, <span class="keyword">const</span> <span class="keywordtype">int</span> stridejp, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> Jij, <span class="keyword">const</span> <span class="keywordtype">double</span> cosij, <span class="keyword">const</span> <span class="keywordtype">double</span> sinij, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim) {</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  <span class="keywordflow">if</span> (fabs(Jij)&gt;1e-10) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="comment">//  1) J_kl (-icos + sin) * ρ_{E−k+l i, i′}</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; j &lt; nj-1) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>      <span class="keywordtype">int</span> itx = it - stridei + stridej;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>      <span class="keywordtype">double</span> sq = sqrt(i * (j + 1));</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>      <span class="comment">// sin u + cos v + i ( -cos u + sin v)</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>      *yre += Jij * sq * (   cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>      *yim += Jij * sq * ( - cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    }</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <span class="comment">// 2) J_kl (−icos − sin)sqrt(il*(ik +1)) ρ_{E+k−li,i′}</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <span class="keywordflow">if</span> (i &lt; ni-1 &amp;&amp; j &gt; 0) {</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>      <span class="keywordtype">int</span> itx = it + stridei - stridej;  <span class="comment">// E+k-l i, i&#39;</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>      <span class="keywordtype">double</span> sq = sqrt(j * (i + 1)); <span class="comment">// sqrt( il*(ik+1))</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>      <span class="comment">// -sin u + cos v + i (-cos u - sin v)</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>      *yre += Jij * sq * (   cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>      *yim += Jij * sq * ( - cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    <span class="comment">// 3) J_kl ( icos + sin)sqrt(ik&#39;*(il&#39; +1)) ρ_{i,E-k+li&#39;}</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <span class="keywordflow">if</span> (ip &gt; 0 &amp;&amp; jp &lt; njp-1) {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>      <span class="keywordtype">int</span> itx = it - strideip + stridejp;  <span class="comment">// i, E-k+l i&#39;</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>      <span class="keywordtype">double</span> sq = sqrt(ip * (jp + 1)); <span class="comment">// sqrt( ik&#39;*(il&#39;+1))</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>      <span class="comment">//  sin u - cos v + i ( cos u + sin v)</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>      *yre += Jij * sq * ( - cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>      *yim += Jij * sq * (   cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    }</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    <span class="comment">// 4) J_kl ( icos - sin)sqrt(il&#39;*(ik&#39; +1)) ρ_{i,E+k-li&#39;}</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="keywordflow">if</span> (ip &lt; nip-1 &amp;&amp; jp &gt; 0) {</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>      <span class="keywordtype">int</span> itx = it + strideip - stridejp;  <span class="comment">// i, E+k-l i&#39;</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>      <span class="keywordtype">double</span> sq = sqrt(jp * (ip + 1)); <span class="comment">// sqrt( il&#39;*(ik&#39;+1))</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>      <span class="comment">// - sin u - cos v + i ( cos u - sin v)</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>      *yre += Jij * sq * ( - cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>      *yim += Jij * sq * (   cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>}</div>
</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="foldopen" id="foldopen00661" data-start="{" data-end="}">
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#ab1bca30d773692bcd076d76927c8ba39">  661</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#ab1bca30d773692bcd076d76927c8ba39">Jkl_coupling_T</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj, <span class="keyword">const</span> <span class="keywordtype">int</span> nip, <span class="keyword">const</span> <span class="keywordtype">int</span> njp, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> j, <span class="keyword">const</span> <span class="keywordtype">int</span> jp, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridej, <span class="keyword">const</span> <span class="keywordtype">int</span> stridejp, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> Jij, <span class="keyword">const</span> <span class="keywordtype">double</span> cosij, <span class="keyword">const</span> <span class="keywordtype">double</span> sinij, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim) {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <span class="keywordflow">if</span> (fabs(Jij)&gt;1e-10) {</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    <span class="comment">//  1) [...] * \bar y_{E+k-l i, i′}</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    <span class="keywordflow">if</span> (i &lt; ni-1 &amp;&amp; j &gt; 0) {</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>      <span class="keywordtype">int</span> itx = it + stridei - stridej;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>      <span class="keywordtype">double</span> sq = sqrt(j * (i + 1));</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      *yre += Jij * sq * ( - cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>      *yim += Jij * sq * ( + cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    <span class="comment">// 2) J_kl (−icos − sin)sqrt(ik*(il +1)) \bar y_{E-k+li,i′}</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; j &lt; nj-1) {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>      <span class="keywordtype">int</span> itx = it - stridei + stridej;  <span class="comment">// E-k+l i, i&#39;</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>      <span class="keywordtype">double</span> sq = sqrt(i * (j + 1)); <span class="comment">// sqrt( ik*(il+1))</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>      *yre += Jij * sq * ( - cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>      *yim += Jij * sq * ( + cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>    }</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    <span class="comment">// 3) J_kl ( icos + sin)sqrt(il&#39;*(ik&#39; +1)) \bar y_{i,E+k-li&#39;}</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    <span class="keywordflow">if</span> (ip &lt; nip-1 &amp;&amp; jp &gt; 0) {</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>      <span class="keywordtype">int</span> itx = it + strideip - stridejp;  <span class="comment">// i, E+k-l i&#39;</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>      <span class="keywordtype">double</span> sq = sqrt(jp * (ip + 1)); <span class="comment">// sqrt( il&#39;*(ik&#39;+1))</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>      *yre += Jij * sq * (   cosij * xim + sinij * xre);</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>      *yim += Jij * sq * ( - cosij * xre + sinij * xim);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>    }</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    <span class="comment">// 4) J_kl ( icos - sin)sqrt(ik&#39;*(il&#39; +1)) \bar y_{i,E-k+li&#39;}</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    <span class="keywordflow">if</span> (ip &gt; 0 &amp;&amp; jp &lt; njp-1) {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      <span class="keywordtype">int</span> itx = it - strideip + stridejp;  <span class="comment">// i, E-k+l i&#39;</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>      <span class="keywordtype">double</span> sq = sqrt(ip * (jp + 1)); <span class="comment">// sqrt( ik&#39;*(il&#39;+1))</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>      *yre += Jij * sq * (   cosij * xim - sinij * xre);</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>      *yim += Jij * sq * ( - cosij * xre - sinij * xim);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    }</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  }</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>}</div>
</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span> </div>
<div class="foldopen" id="foldopen00717" data-start="{" data-end="}">
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#aaa7f2114c09d97537ef8d2579e98b0bc">  717</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#aaa7f2114c09d97537ef8d2579e98b0bc">L1decay</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> decayi, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>  <span class="keywordflow">if</span>  (fabs(decayi) &gt; 1e-12) {</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    <span class="keywordflow">if</span> (i &lt; n-1 &amp;&amp; ip &lt; n-1) {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>      <span class="keywordtype">double</span> l1off = decayi * sqrt((i+1)*(ip+1));</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      <span class="keywordtype">int</span> itx = it + stridei + strideip;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>      *yre += l1off * xre;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>      *yim += l1off * xim;</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    }</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>}</div>
</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span> </div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="foldopen" id="foldopen00744" data-start="{" data-end="}">
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a7516a772ec73ed0deead7db33a194319">  744</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a7516a772ec73ed0deead7db33a194319">L1decay_T</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> decayi, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>  <span class="keywordflow">if</span> (fabs(decayi) &gt; 1e-12) {</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>      <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; ip &gt; 0) {</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>        <span class="keywordtype">double</span> l1off = decayi * sqrt(i*ip);</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        <span class="keywordtype">int</span> itx = it - stridei - strideip;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>        <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        *yre += l1off * xre;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        *yim += l1off * xim;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>      }</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    }</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>}</div>
</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="foldopen" id="foldopen00775" data-start="{" data-end="}">
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a343ecc505aee2c823165b37592945f30">  775</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a343ecc505aee2c823165b37592945f30">control</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> np, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> pt, <span class="keyword">const</span> <span class="keywordtype">double</span> qt, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>  <span class="comment">/* \rho(ik+1..,ik&#39;..) term */</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>  <span class="keywordflow">if</span> (i &lt; n-1) {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      <span class="keywordtype">int</span> itx = it + stridei;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>      <span class="keywordtype">double</span> sq = sqrt(i + 1);</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>      *yre += sq * (   pt * xim + qt * xre);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>      *yim += sq * ( - pt * xre + qt * xim);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    }</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    <span class="comment">/* \rho(ik..,ik&#39;+1..) */</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    <span class="keywordflow">if</span> (ip &lt; np-1) {</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>      <span class="keywordtype">int</span> itx = it + strideip;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>      <span class="keywordtype">double</span> sq = sqrt(ip + 1);</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>      *yre += sq * ( -pt * xim + qt * xre);</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>      *yim += sq * (  pt * xre + qt * xim);</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    }</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    <span class="comment">/* \rho(ik-1..,ik&#39;..) */</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>      <span class="keywordtype">int</span> itx = it - stridei;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>      <span class="keywordtype">double</span> sq = sqrt(i);</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>      *yre += sq * (  pt * xim - qt * xre);</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>      *yim += sq * (- pt * xre - qt * xim);</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    }</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <span class="comment">/* \rho(ik..,ik&#39;-1..) */</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    <span class="keywordflow">if</span> (ip &gt; 0) {</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>      <span class="keywordtype">int</span> itx = it - strideip;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>      <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>      <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      <span class="keywordtype">double</span> sq = sqrt(ip);</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>      *yre += sq * (- pt * xim - qt * xre);</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>      *yim += sq * (  pt * xre - qt * xim);</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>    }</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>}</div>
</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="foldopen" id="foldopen00831" data-start="{" data-end="}">
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno"><a class="line" href="mastereq_8hpp.html#a05441506524e4cfac60bc0ed729e51ba">  831</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="mastereq_8hpp.html#a05441506524e4cfac60bc0ed729e51ba">control_T</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> <span class="keywordtype">int</span> np, <span class="keyword">const</span> <span class="keywordtype">int</span> ip, <span class="keyword">const</span> <span class="keywordtype">int</span> stridei, <span class="keyword">const</span> <span class="keywordtype">int</span> strideip, <span class="keyword">const</span> <span class="keywordtype">double</span>* xptr, <span class="keyword">const</span> <span class="keywordtype">double</span> pt, <span class="keyword">const</span> <span class="keywordtype">double</span> qt, <span class="keywordtype">double</span>* yre, <span class="keywordtype">double</span>* yim){</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>  <span class="comment">/* \rho(ik+1..,ik&#39;..) term */</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>  <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    <span class="keywordtype">int</span> itx = it - stridei;</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    <span class="keywordtype">double</span> sq = sqrt(i);</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    *yre += sq * ( - pt * xim + qt * xre);</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>    *yim += sq * (   pt * xre + qt * xim);</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>  }</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>  <span class="comment">/* \rho(ik..,ik&#39;+1..) */</span></div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>  <span class="keywordflow">if</span> (ip &gt; 0) {</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    <span class="keywordtype">int</span> itx = it - strideip;</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    <span class="keywordtype">double</span> sq = sqrt(ip);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    *yre += sq * (  pt * xim + qt * xre);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    *yim += sq * ( -pt * xre + qt * xim);</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>  }</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>  <span class="comment">/* \rho(ik-1..,ik&#39;..) */</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>  <span class="keywordflow">if</span> (i &lt; n-1) {</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    <span class="keywordtype">int</span> itx = it + stridei;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    <span class="keywordtype">double</span> sq = sqrt(i+1);</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    *yre += sq * (- pt * xim - qt * xre);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    *yim += sq * (  pt * xre - qt * xim);</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>  }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>  <span class="comment">/* \rho(ik..,ik&#39;-1..) */</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>  <span class="keywordflow">if</span> (ip &lt; np-1) {</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    <span class="keywordtype">int</span> itx = it + strideip;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>    <span class="keywordtype">double</span> xre = xptr[2 * itx];</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>    <span class="keywordtype">double</span> xim = xptr[2 * itx + 1];</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    <span class="keywordtype">double</span> sq = sqrt(ip+1);</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    *yre += sq * (+ pt * xim - qt * xre);</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    *yim += sq * (- pt * xre - qt * xim);</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>  }</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>}</div>
</div>
<div class="ttc" id="aclassMasterEq_html"><div class="ttname"><a href="classMasterEq.html">MasterEq</a></div><div class="ttdoc">Implementation of the real-valued right-hand-side (RHS) system matrix of the quantum dynamical equati...</div><div class="ttdef"><b>Definition</b> mastereq.hpp:87</div></div>
<div class="ttc" id="aclassMasterEq_html_a02dd3462531616d6a2a250a088990cd2"><div class="ttname"><a href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">MasterEq::addT1</a></div><div class="ttdeci">bool addT1</div><div class="ttdef"><b>Definition</b> mastereq.hpp:109</div></div>
<div class="ttc" id="aclassMasterEq_html_a0674aab017f75be72e15d45385a1ebf8"><div class="ttname"><a href="classMasterEq.html#a0674aab017f75be72e15d45385a1ebf8">MasterEq::addT2</a></div><div class="ttdeci">bool addT2</div><div class="ttdoc">Flags for including T1 decay and T2 dephasing Lindblad operators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:109</div></div>
<div class="ttc" id="aclassMasterEq_html_a114fff980e3a46ceeb53bbd7167c416f"><div class="ttname"><a href="classMasterEq.html#a114fff980e3a46ceeb53bbd7167c416f">MasterEq::getRHS</a></div><div class="ttdeci">Mat getRHS()</div><div class="ttdoc">Retrieves the right-hand-side matrix.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:761</div></div>
<div class="ttc" id="aclassMasterEq_html_a1a7dfad49bfeafe1ebbaa4a23a4eae29"><div class="ttname"><a href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">MasterEq::mpirank_petsc</a></div><div class="ttdeci">int mpirank_petsc</div><div class="ttdoc">Rank of PETSc's communicator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:111</div></div>
<div class="ttc" id="aclassMasterEq_html_a1ee5ff4c7f62f433e539c0d790ac39d6"><div class="ttname"><a href="classMasterEq.html#a1ee5ff4c7f62f433e539c0d790ac39d6">MasterEq::nparams_max</a></div><div class="ttdeci">int nparams_max</div><div class="ttdoc">Maximum number of design parameters per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:113</div></div>
<div class="ttc" id="aclassMasterEq_html_a24841be28d3b2ba8fec73988b07d16a5"><div class="ttname"><a href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq::MasterEq</a></div><div class="ttdeci">MasterEq()</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3</div></div>
<div class="ttc" id="aclassMasterEq_html_a2afd1529a3b1793aa87ad1c008ef212a"><div class="ttname"><a href="classMasterEq.html#a2afd1529a3b1793aa87ad1c008ef212a">MasterEq::Bd</a></div><div class="ttdeci">Mat Bd</div><div class="ttdoc">Imaginary part of time-independent system matrix without coupling terms.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:102</div></div>
<div class="ttc" id="aclassMasterEq_html_a2d735524c2b5b205adb1898606b65a19"><div class="ttname"><a href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">MasterEq::usematfree</a></div><div class="ttdeci">bool usematfree</div><div class="ttdoc">Flag for using matrix-free solver.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:127</div></div>
<div class="ttc" id="aclassMasterEq_html_a30f051e65c04523f63db05f357d2f29f"><div class="ttname"><a href="classMasterEq.html#a30f051e65c04523f63db05f357d2f29f">MasterEq::transfer_Hc_re</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TransferFunction * &gt; &gt; transfer_Hc_re</div><div class="ttdoc">Real transfer functions for control terms per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:130</div></div>
<div class="ttc" id="aclassMasterEq_html_a3117c4885b24a0d9d88fff234c5593e8"><div class="ttname"><a href="classMasterEq.html#a3117c4885b24a0d9d88fff234c5593e8">MasterEq::dRedp</a></div><div class="ttdeci">double * dRedp</div><div class="ttdoc">Derivative of real part with respect to parameters.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:116</div></div>
<div class="ttc" id="aclassMasterEq_html_a3410d6f6f9ef27932610fea1c2e28d39"><div class="ttname"><a href="classMasterEq.html#a3410d6f6f9ef27932610fea1c2e28d39">MasterEq::getDim</a></div><div class="ttdeci">int getDim()</div><div class="ttdoc">Retrieves the dimension of the vectorized system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:714</div></div>
<div class="ttc" id="aclassMasterEq_html_a346265de8ee28b5420cf0fe4b0c180ed"><div class="ttname"><a href="classMasterEq.html#a346265de8ee28b5420cf0fe4b0c180ed">MasterEq::dim</a></div><div class="ttdeci">int dim</div><div class="ttdoc">Dimension of full vectorized system: N^2 if Lindblad, N if Schroedinger.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:90</div></div>
<div class="ttc" id="aclassMasterEq_html_a3493e8372960cd42ba4ceab89fe68bb9"><div class="ttname"><a href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">MasterEq::quietmode</a></div><div class="ttdeci">bool quietmode</div><div class="ttdoc">Flag for quiet mode operation.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:122</div></div>
<div class="ttc" id="aclassMasterEq_html_a3d518b166eba640dc61c708ba2ea9e2d"><div class="ttname"><a href="classMasterEq.html#a3d518b166eba640dc61c708ba2ea9e2d">MasterEq::cols</a></div><div class="ttdeci">PetscInt * cols</div><div class="ttdoc">Column indices for evaluating dRHS/dp.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:119</div></div>
<div class="ttc" id="aclassMasterEq_html_a3d861dd8d9ad6f4e9b04e0109d3ee128"><div class="ttname"><a href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">MasterEq::crosskerr</a></div><div class="ttdeci">std::vector&lt; double &gt; crosskerr</div><div class="ttdoc">Cross-Kerr coefficients (rad/time)  for ZZ-coupling .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:106</div></div>
<div class="ttc" id="aclassMasterEq_html_a44fad9cad554191a82455cf84d1fdd1f"><div class="ttname"><a href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">MasterEq::isu</a></div><div class="ttdeci">IS isu</div><div class="ttdef"><b>Definition</b> mastereq.hpp:114</div></div>
<div class="ttc" id="aclassMasterEq_html_a53b5dbe948eb0eb8570e4555d7ebedaa"><div class="ttname"><a href="classMasterEq.html#a53b5dbe948eb0eb8570e4555d7ebedaa">MasterEq::isv</a></div><div class="ttdeci">IS isv</div><div class="ttdoc">Vector strides for accessing real and imaginary parts u=Re(x), v=Im(x)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:114</div></div>
<div class="ttc" id="aclassMasterEq_html_a5dfe8c17afb1a56643f98e59539949fd"><div class="ttname"><a href="classMasterEq.html#a5dfe8c17afb1a56643f98e59539949fd">MasterEq::dim_ess</a></div><div class="ttdeci">int dim_ess</div><div class="ttdoc">Dimension of essential levels = N_e.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:92</div></div>
<div class="ttc" id="aclassMasterEq_html_a601f1831ffce18ea5be8fd68e7bd60c2"><div class="ttname"><a href="classMasterEq.html#a601f1831ffce18ea5be8fd68e7bd60c2">MasterEq::getNOscillators</a></div><div class="ttdeci">size_t getNOscillators()</div><div class="ttdoc">Retrieves the number of oscillators in the system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:720</div></div>
<div class="ttc" id="aclassMasterEq_html_a609bd3adeeaf8f9a53e7bdc59cd25be8"><div class="ttname"><a href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">MasterEq::nessential</a></div><div class="ttdeci">std::vector&lt; int &gt; nessential</div><div class="ttdoc">Number of essential levels per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:126</div></div>
<div class="ttc" id="aclassMasterEq_html_a68172dcac6206bd43927af847b87b822"><div class="ttname"><a href="classMasterEq.html#a68172dcac6206bd43927af847b87b822">MasterEq::hamiltonian_file</a></div><div class="ttdeci">std::string hamiltonian_file</div><div class="ttdoc">Filename if a custom Hamiltonian is read from file ('none' if standard Hamiltonian is used)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:134</div></div>
<div class="ttc" id="aclassMasterEq_html_a6a3bb1ab8dd49c64f51c90dd5b080f62"><div class="ttname"><a href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">MasterEq::RHSctx</a></div><div class="ttdeci">MatShellCtx RHSctx</div><div class="ttdoc">MatShell context containing data for applying the RHS to a state.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:97</div></div>
<div class="ttc" id="aclassMasterEq_html_a6c35b6e30807ba37c4742a05af80f9ef"><div class="ttname"><a href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">MasterEq::oscil_vec</a></div><div class="ttdeci">Oscillator ** oscil_vec</div><div class="ttdoc">Array of pointers to oscillator objects.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:94</div></div>
<div class="ttc" id="aclassMasterEq_html_a6c486486fc1feb02cbc77bd44ca3202a"><div class="ttname"><a href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">MasterEq::Bd_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Bd_vec</div><div class="ttdoc">Imaginary parts of dipole-dipole coupling matrices in drift Hamiltonian.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:104</div></div>
<div class="ttc" id="aclassMasterEq_html_a6cadd8dbe3e40e6ea087b6926de72c1f"><div class="ttname"><a href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">MasterEq::nlevels</a></div><div class="ttdeci">std::vector&lt; int &gt; nlevels</div><div class="ttdoc">Number of levels per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:125</div></div>
<div class="ttc" id="aclassMasterEq_html_a6e00f02e3b6cfab7fb90cb70de265aff"><div class="ttname"><a href="classMasterEq.html#a6e00f02e3b6cfab7fb90cb70de265aff">MasterEq::vals</a></div><div class="ttdeci">PetscScalar * vals</div><div class="ttdoc">Values for evaluating dRHS/dp.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:120</div></div>
<div class="ttc" id="aclassMasterEq_html_a7112f8144791299af573cf9479a370c8"><div class="ttname"><a href="classMasterEq.html#a7112f8144791299af573cf9479a370c8">MasterEq::dim_rho</a></div><div class="ttdeci">int dim_rho</div><div class="ttdoc">Dimension of Hilbert space = N.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:91</div></div>
<div class="ttc" id="aclassMasterEq_html_a7aa65ae612c591230c41eec8454936ee"><div class="ttname"><a href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">MasterEq::Ad</a></div><div class="ttdeci">Mat Ad</div><div class="ttdoc">Real part of time-independent system matrix without the coupling terms.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:101</div></div>
<div class="ttc" id="aclassMasterEq_html_a7e880910441b27fde4ff1aef4de2aac4"><div class="ttname"><a href="classMasterEq.html#a7e880910441b27fde4ff1aef4de2aac4">MasterEq::getOscillator</a></div><div class="ttdeci">Oscillator * getOscillator(const size_t i)</div><div class="ttdoc">Retrieves the i-th oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:722</div></div>
<div class="ttc" id="aclassMasterEq_html_a7f69aef84b13fada56ebb31adf9fa7fd"><div class="ttname"><a href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">MasterEq::eta</a></div><div class="ttdeci">std::vector&lt; double &gt; eta</div><div class="ttdoc">Frequency differences in rotating frame (rad/time) for dipole-dipole coupling.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:108</div></div>
<div class="ttc" id="aclassMasterEq_html_a9308372d3f1aa99517dd313d5d2a4cd9"><div class="ttname"><a href="classMasterEq.html#a9308372d3f1aa99517dd313d5d2a4cd9">MasterEq::population</a></div><div class="ttdeci">void population(const Vec x, std::vector&lt; double &gt; &amp;population_com)</div><div class="ttdoc">Computes population of the full composite system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3185</div></div>
<div class="ttc" id="aclassMasterEq_html_a94c9e247bd0aac8468c07d94cfb3097b"><div class="ttname"><a href="classMasterEq.html#a94c9e247bd0aac8468c07d94cfb3097b">MasterEq::getDimEss</a></div><div class="ttdeci">int getDimEss()</div><div class="ttdoc">Retrieves the dimension of the essential level system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:716</div></div>
<div class="ttc" id="aclassMasterEq_html_aa30454ed43e280918df0e2dc06954e84"><div class="ttname"><a href="classMasterEq.html#aa30454ed43e280918df0e2dc06954e84">MasterEq::Ac_vec</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Mat &gt; &gt; Ac_vec</div><div class="ttdoc">Real parts of control matrices for each oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:99</div></div>
<div class="ttc" id="aclassMasterEq_html_aa8fcd6a14c34c63cf8036c300c48f1ed"><div class="ttname"><a href="classMasterEq.html#aa8fcd6a14c34c63cf8036c300c48f1ed">MasterEq::getDimRho</a></div><div class="ttdeci">int getDimRho()</div><div class="ttdoc">Retrieves the dimension of the density matrix.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:718</div></div>
<div class="ttc" id="aclassMasterEq_html_aaafcd9e3d4a617bbb86d004b44f7ad3d"><div class="ttname"><a href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">MasterEq::noscillators</a></div><div class="ttdeci">int noscillators</div><div class="ttdoc">Number of oscillators in the system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:93</div></div>
<div class="ttc" id="aclassMasterEq_html_aad34fc836f709483b81b724d8ec9f94c"><div class="ttname"><a href="classMasterEq.html#aad34fc836f709483b81b724d8ec9f94c">MasterEq::initSparseMatSolver</a></div><div class="ttdeci">void initSparseMatSolver()</div><div class="ttdoc">Initializes matrices needed for the sparse matrix solver.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:266</div></div>
<div class="ttc" id="aclassMasterEq_html_aadb9c6cdd2162ee2df713e40a72f7d5c"><div class="ttname"><a href="classMasterEq.html#aadb9c6cdd2162ee2df713e40a72f7d5c">MasterEq::assemble_RHS</a></div><div class="ttdeci">int assemble_RHS(const double t)</div><div class="ttdoc">Assembles the real-valued system matrix (RHS) at time t.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:724</div></div>
<div class="ttc" id="aclassMasterEq_html_aae5fbd62a0766d20ec823a001da6f570"><div class="ttname"><a href="classMasterEq.html#aae5fbd62a0766d20ec823a001da6f570">MasterEq::expectedEnergy</a></div><div class="ttdeci">double expectedEnergy(const Vec x)</div><div class="ttdoc">Computes expected energy of the full composite system.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3141</div></div>
<div class="ttc" id="aclassMasterEq_html_aafbc713ebc3d42731dc44d727db530d8"><div class="ttname"><a href="classMasterEq.html#aafbc713ebc3d42731dc44d727db530d8">MasterEq::dImdp</a></div><div class="ttdeci">double * dImdp</div><div class="ttdoc">Derivative of imaginary part with respect to parameters.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:117</div></div>
<div class="ttc" id="aclassMasterEq_html_ab0d2504ab06b61b6bfe11f623e5a002c"><div class="ttname"><a href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">MasterEq::Ad_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Ad_vec</div><div class="ttdoc">Real parts of dipole-dipole coupling matrices in drift Hamiltonian.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:103</div></div>
<div class="ttc" id="aclassMasterEq_html_ab200ca6b9a16be33b8ee7313c41f20d2"><div class="ttname"><a href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">MasterEq::RHS</a></div><div class="ttdeci">Mat RHS</div><div class="ttdoc">Real-valued, vectorized system matrix (size 2N^2 x 2N^2)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:96</div></div>
<div class="ttc" id="aclassMasterEq_html_ac268a9ef050250e6b0005f61f284b274"><div class="ttname"><a href="classMasterEq.html#ac268a9ef050250e6b0005f61f284b274">MasterEq::transfer_Hdt_re</a></div><div class="ttdeci">std::vector&lt; TransferFunction * &gt; transfer_Hdt_re</div><div class="ttdoc">Real transfer functions for time-varying system Hamiltonian.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:132</div></div>
<div class="ttc" id="aclassMasterEq_html_ac53a2013f8ebe3b279be5b04b2bba34e"><div class="ttname"><a href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">MasterEq::Jkl</a></div><div class="ttdeci">std::vector&lt; double &gt; Jkl</div><div class="ttdoc">Dipole-dipole coupling coefficients (rad/time), multiplies .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:107</div></div>
<div class="ttc" id="aclassMasterEq_html_ac7b7aa48c2cce32d27d0055e0a8d5990"><div class="ttname"><a href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">MasterEq::mpirank_world</a></div><div class="ttdeci">int mpirank_world</div><div class="ttdoc">Rank of global MPI communicator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:112</div></div>
<div class="ttc" id="aclassMasterEq_html_ac8307cc795eb6e82eb3a3e8c71385d7e"><div class="ttname"><a href="classMasterEq.html#ac8307cc795eb6e82eb3a3e8c71385d7e">MasterEq::setTransferOnOffTimes</a></div><div class="ttdeci">void setTransferOnOffTimes(std::vector&lt; double &gt; tlist)</div><div class="ttdoc">Sets time points that determine when transfer functions are active.</div></div>
<div class="ttc" id="aclassMasterEq_html_ac8fd54198c43d043c544e72417e30dba"><div class="ttname"><a href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">MasterEq::lindbladtype</a></div><div class="ttdeci">LindbladType lindbladtype</div><div class="ttdoc">Type of Lindblad operators to include (NONE means Schroedinger equation)</div><div class="ttdef"><b>Definition</b> mastereq.hpp:128</div></div>
<div class="ttc" id="aclassMasterEq_html_ad0644cc00ef5b0616947d733a59c4a01"><div class="ttname"><a href="classMasterEq.html#ad0644cc00ef5b0616947d733a59c4a01">MasterEq::transfer_Hdt_im</a></div><div class="ttdeci">std::vector&lt; TransferFunction * &gt; transfer_Hdt_im</div><div class="ttdoc">Imaginary transfer functions for time-varying system Hamiltonian.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:133</div></div>
<div class="ttc" id="aclassMasterEq_html_ad59aa549dc17834871c3fdfe96f397e4"><div class="ttname"><a href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">MasterEq::aux</a></div><div class="ttdeci">Vec aux</div><div class="ttdoc">Auxiliary vector for computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:118</div></div>
<div class="ttc" id="aclassMasterEq_html_ae881b4c040b27af6bb119b97e8757688"><div class="ttname"><a href="classMasterEq.html#ae881b4c040b27af6bb119b97e8757688">MasterEq::transfer_Hc_im</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TransferFunction * &gt; &gt; transfer_Hc_im</div><div class="ttdoc">Imaginary transfer functions for control terms per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:131</div></div>
<div class="ttc" id="aclassMasterEq_html_aefff9fce71e094f6b2d25c70caf6ef22"><div class="ttname"><a href="classMasterEq.html#aefff9fce71e094f6b2d25c70caf6ef22">MasterEq::computedRHSdp</a></div><div class="ttdeci">void computedRHSdp(const double t, const Vec x, const Vec x_bar, const double alpha, Vec grad)</div><div class="ttdoc">Computes gradient of RHS with respect to control parameters.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:909</div></div>
<div class="ttc" id="aclassMasterEq_html_af747a9c4013860f785cd80fe52e7f457"><div class="ttname"><a href="classMasterEq.html#af747a9c4013860f785cd80fe52e7f457">MasterEq::setControlAmplitudes</a></div><div class="ttdeci">void setControlAmplitudes(const Vec x)</div><div class="ttdoc">Pass control parameters from global design vector to each oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:1300</div></div>
<div class="ttc" id="aclassMasterEq_html_af9b8723f0500416cd3d2fcdd14fd9483"><div class="ttname"><a href="classMasterEq.html#af9b8723f0500416cd3d2fcdd14fd9483">MasterEq::~MasterEq</a></div><div class="ttdeci">~MasterEq()</div><div class="ttdef"><b>Definition</b> mastereq.cpp:214</div></div>
<div class="ttc" id="aclassMasterEq_html_afb1c97886b5a327dc888caf9ba902db8"><div class="ttname"><a href="classMasterEq.html#afb1c97886b5a327dc888caf9ba902db8">MasterEq::Bc_vec</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Mat &gt; &gt; Bc_vec</div><div class="ttdoc">Imaginary parts of control matrices for each oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:100</div></div>
<div class="ttc" id="aclassOscillator_html"><div class="ttname"><a href="classOscillator.html">Oscillator</a></div><div class="ttdoc">Quantum oscillator (multi-level qubit) with control capabilities.</div><div class="ttdef"><b>Definition</b> oscillator.hpp:48</div></div>
<div class="ttc" id="adefs_8hpp_html"><div class="ttname"><a href="defs_8hpp.html">defs.hpp</a></div><div class="ttdoc">Core type definitions and enumerations for Quandary quantum optimal control.</div></div>
<div class="ttc" id="adefs_8hpp_html_a5e46e0fe90abc6230f71928a43849bd2"><div class="ttname"><a href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a></div><div class="ttdeci">LindbladType</div><div class="ttdoc">Available Lindblad operator types for open quantum systems, or NONE for closed quantum systems.</div><div class="ttdef"><b>Definition</b> defs.hpp:27</div></div>
<div class="ttc" id="agate_8hpp_html"><div class="ttname"><a href="gate_8hpp.html">gate.hpp</a></div></div>
<div class="ttc" id="ahamiltonianfilereader_8hpp_html"><div class="ttname"><a href="hamiltonianfilereader_8hpp.html">hamiltonianfilereader.hpp</a></div></div>
<div class="ttc" id="amastereq_8hpp_html_a05441506524e4cfac60bc0ed729e51ba"><div class="ttname"><a href="mastereq_8hpp.html#a05441506524e4cfac60bc0ed729e51ba">control_T</a></div><div class="ttdeci">void control_T(const int it, const int n, const int i, const int np, const int ip, const int stridei, const int strideip, const double *xptr, const double pt, const double qt, double *yre, double *yim)</div><div class="ttdoc">Transpose of control terms for adjoint computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:831</div></div>
<div class="ttc" id="amastereq_8hpp_html_a0fef44cebdfdb5624036cebb4c83e6bb"><div class="ttname"><a href="mastereq_8hpp.html#a0fef44cebdfdb5624036cebb4c83e6bb">myMatMultTranspose_matfree_2Osc</a></div><div class="ttdeci">int myMatMultTranspose_matfree_2Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free solver for 2 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3313</div></div>
<div class="ttc" id="amastereq_8hpp_html_a241b317b3155d9b7bdad401893fbc910"><div class="ttname"><a href="mastereq_8hpp.html#a241b317b3155d9b7bdad401893fbc910">myMatMult_sparsemat</a></div><div class="ttdeci">int myMatMult_sparsemat(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Sparse matrix solver.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:1318</div></div>
<div class="ttc" id="amastereq_8hpp_html_a29911a6f06e34dadc8ca88eedbe433a1"><div class="ttname"><a href="mastereq_8hpp.html#a29911a6f06e34dadc8ca88eedbe433a1">myMatMultTranspose_matfree_1Osc</a></div><div class="ttdeci">int myMatMultTranspose_matfree_1Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free solver for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3256</div></div>
<div class="ttc" id="amastereq_8hpp_html_a30e19fc9f17030c99d9f1efb4f76db43"><div class="ttname"><a href="mastereq_8hpp.html#a30e19fc9f17030c99d9f1efb4f76db43">dRHSdp_getcoeffs</a></div><div class="ttdeci">void dRHSdp_getcoeffs(const int it, const int n, const int np, const int i, const int ip, const int stridei, const int strideip, const double *xptr, double *res_p_re, double *res_p_im, double *res_q_re, double *res_q_im)</div><div class="ttdoc">Matrix-free solver inline for gradient updates for oscillator i.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:515</div></div>
<div class="ttc" id="amastereq_8hpp_html_a343ecc505aee2c823165b37592945f30"><div class="ttname"><a href="mastereq_8hpp.html#a343ecc505aee2c823165b37592945f30">control</a></div><div class="ttdeci">void control(const int it, const int n, const int i, const int np, const int ip, const int stridei, const int strideip, const double *xptr, const double pt, const double qt, double *yre, double *yim)</div><div class="ttdoc">Matrix-free solver inline for control terms.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:775</div></div>
<div class="ttc" id="amastereq_8hpp_html_a3c5850f7bd0694b00e3fae67818aae23"><div class="ttname"><a href="mastereq_8hpp.html#a3c5850f7bd0694b00e3fae67818aae23">myMatMult_matfree_5Osc</a></div><div class="ttdeci">int myMatMult_matfree_5Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free solver for 5 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3442</div></div>
<div class="ttc" id="amastereq_8hpp_html_a4c23d2ebe61dae85bc76b66421364302"><div class="ttname"><a href="mastereq_8hpp.html#a4c23d2ebe61dae85bc76b66421364302">L2</a></div><div class="ttdeci">double L2(const double dephase0, const int i0, const int i0p)</div><div class="ttdoc">Computes L2 dephasing Lindblad operator for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:299</div></div>
<div class="ttc" id="amastereq_8hpp_html_a51afc704134d4d253dabccbb0b74ccb0"><div class="ttname"><a href="mastereq_8hpp.html#a51afc704134d4d253dabccbb0b74ccb0">myMatMult_matfree_1Osc</a></div><div class="ttdeci">int myMatMult_matfree_1Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Interface for Matrix-vector products to apply the RHS system matrix to a state.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3227</div></div>
<div class="ttc" id="amastereq_8hpp_html_a5f4095237dba306b4e56ad26fb5b5f9d"><div class="ttname"><a href="mastereq_8hpp.html#a5f4095237dba306b4e56ad26fb5b5f9d">myMatMultTranspose_sparsemat</a></div><div class="ttdeci">int myMatMultTranspose_sparsemat(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose sparse matrix solver.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:1427</div></div>
<div class="ttc" id="amastereq_8hpp_html_a6e6afdba2dbb5fc6b47cc5c7dc9fdfc3"><div class="ttname"><a href="mastereq_8hpp.html#a6e6afdba2dbb5fc6b47cc5c7dc9fdfc3">myMatMultTranspose_matfree_4Osc</a></div><div class="ttdeci">int myMatMultTranspose_matfree_4Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free solver for 4 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3417</div></div>
<div class="ttc" id="amastereq_8hpp_html_a7516a772ec73ed0deead7db33a194319"><div class="ttname"><a href="mastereq_8hpp.html#a7516a772ec73ed0deead7db33a194319">L1decay_T</a></div><div class="ttdeci">void L1decay_T(const int it, const int i, const int ip, const int stridei, const int strideip, const double *xptr, const double decayi, double *yre, double *yim)</div><div class="ttdoc">Transpose of off-diagonal L1 decay for adjoint computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:744</div></div>
<div class="ttc" id="amastereq_8hpp_html_a81a7c6c361fc7b695ba996cd4275e9cd"><div class="ttname"><a href="mastereq_8hpp.html#a81a7c6c361fc7b695ba996cd4275e9cd">myMatMult_matfree_4Osc</a></div><div class="ttdeci">int myMatMult_matfree_4Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free solver for 4 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3391</div></div>
<div class="ttc" id="amastereq_8hpp_html_a8b6f983b0177602e78148e8d734eca25"><div class="ttname"><a href="mastereq_8hpp.html#a8b6f983b0177602e78148e8d734eca25">myMatMultTranspose_matfree_5Osc</a></div><div class="ttdeci">int myMatMultTranspose_matfree_5Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free solver for 5 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3468</div></div>
<div class="ttc" id="amastereq_8hpp_html_aaa7f2114c09d97537ef8d2579e98b0bc"><div class="ttname"><a href="mastereq_8hpp.html#aaa7f2114c09d97537ef8d2579e98b0bc">L1decay</a></div><div class="ttdeci">void L1decay(const int it, const int n, const int i, const int ip, const int stridei, const int strideip, const double *xptr, const double decayi, double *yre, double *yim)</div><div class="ttdoc">Matrix-free solver inline for off-diagonal L1 decay term.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:717</div></div>
<div class="ttc" id="amastereq_8hpp_html_aabb663bfcd5c2b36d4e46ff483849156"><div class="ttname"><a href="mastereq_8hpp.html#aabb663bfcd5c2b36d4e46ff483849156">H_crosskerr</a></div><div class="ttdeci">double H_crosskerr(const double xi01, const int a, const int b)</div><div class="ttdoc">Computes cross-Kerr coupling between 2 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:364</div></div>
<div class="ttc" id="amastereq_8hpp_html_aac495876fa4b05189aebdc593e4a402f"><div class="ttname"><a href="mastereq_8hpp.html#aac495876fa4b05189aebdc593e4a402f">TensorGetIndex</a></div><div class="ttdeci">int TensorGetIndex(const int nlevels0, const int i0, const int i0p)</div><div class="ttdoc">Computes tensor product index for 1 oscillator system.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:323</div></div>
<div class="ttc" id="amastereq_8hpp_html_aadd2b7b46eda1bb4a04e955eeec4d1ea"><div class="ttname"><a href="mastereq_8hpp.html#aadd2b7b46eda1bb4a04e955eeec4d1ea">myMatMultTranspose_matfree_3Osc</a></div><div class="ttdeci">int myMatMultTranspose_matfree_3Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Transpose matrix-free solver for 3 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3367</div></div>
<div class="ttc" id="amastereq_8hpp_html_ab1bca30d773692bcd076d76927c8ba39"><div class="ttname"><a href="mastereq_8hpp.html#ab1bca30d773692bcd076d76927c8ba39">Jkl_coupling_T</a></div><div class="ttdeci">void Jkl_coupling_T(const int it, const int ni, const int nj, const int nip, const int njp, const int i, const int ip, const int j, const int jp, const int stridei, const int strideip, const int stridej, const int stridejp, const double *xptr, const double Jij, const double cosij, const double sinij, double *yre, double *yim)</div><div class="ttdoc">Transpose of dipole-dipole coupling for adjoint computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:661</div></div>
<div class="ttc" id="amastereq_8hpp_html_ab249c0823cf573c3c49ace9ead191a77"><div class="ttname"><a href="mastereq_8hpp.html#ab249c0823cf573c3c49ace9ead191a77">H_selfkerr</a></div><div class="ttdeci">double H_selfkerr(const double xi0, const int a)</div><div class="ttdoc">Computes self-Kerr nonlinearity term for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:287</div></div>
<div class="ttc" id="amastereq_8hpp_html_ac5c01379a727f6e4065d00fc81a3d7f8"><div class="ttname"><a href="mastereq_8hpp.html#ac5c01379a727f6e4065d00fc81a3d7f8">Jkl_coupling</a></div><div class="ttdeci">void Jkl_coupling(const int it, const int ni, const int nj, const int nip, const int njp, const int i, const int ip, const int j, const int jp, const int stridei, const int strideip, const int stridej, const int stridejp, const double *xptr, const double Jij, const double cosij, const double sinij, double *yre, double *yim)</div><div class="ttdoc">Matrix-free solver inline for dipole-dipole coupling between oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:593</div></div>
<div class="ttc" id="amastereq_8hpp_html_acc1f746c70fd004036f87beae614c1cf"><div class="ttname"><a href="mastereq_8hpp.html#acc1f746c70fd004036f87beae614c1cf">myMatMult_matfree_2Osc</a></div><div class="ttdeci">int myMatMult_matfree_2Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free solver for 2 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3283</div></div>
<div class="ttc" id="amastereq_8hpp_html_ad9182550cadb88d6f911338bda0769eb"><div class="ttname"><a href="mastereq_8hpp.html#ad9182550cadb88d6f911338bda0769eb">L1diag</a></div><div class="ttdeci">double L1diag(const double decay0, const int i0, const int i0p)</div><div class="ttdoc">Computes L1 decay Lindblad operator diagonal term for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:311</div></div>
<div class="ttc" id="amastereq_8hpp_html_aebbda51dfa3b2ccda3c86e83efb422f3"><div class="ttname"><a href="mastereq_8hpp.html#aebbda51dfa3b2ccda3c86e83efb422f3">H_detune</a></div><div class="ttdeci">double H_detune(const double detuning0, const int a)</div><div class="ttdoc">Computes detuning Hamiltonian term for 1 oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:276</div></div>
<div class="ttc" id="amastereq_8hpp_html_afd69ebcffc76a1b1d769f38d0869f7d4"><div class="ttname"><a href="mastereq_8hpp.html#afd69ebcffc76a1b1d769f38d0869f7d4">myMatMult_matfree_3Osc</a></div><div class="ttdeci">int myMatMult_matfree_3Osc(Mat RHS, Vec x, Vec y)</div><div class="ttdoc">Matrix-free solver for 3 oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.cpp:3341</div></div>
<div class="ttc" id="aoscillator_8hpp_html"><div class="ttname"><a href="oscillator_8hpp.html">oscillator.hpp</a></div></div>
<div class="ttc" id="astructMatShellCtx_html"><div class="ttname"><a href="structMatShellCtx.html">MatShellCtx</a></div><div class="ttdoc">MatShell context containing data needed for applying the right-hand-side (RHS) system matrix to a vec...</div><div class="ttdef"><b>Definition</b> mastereq.hpp:19</div></div>
<div class="ttc" id="astructMatShellCtx_html_a0033984ce7821240a254b2666e0d8ec4"><div class="ttname"><a href="structMatShellCtx.html#a0033984ce7821240a254b2666e0d8ec4">MatShellCtx::Ad_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Ad_vec</div><div class="ttdoc">Real parts of dipole-dipole coupling system matrices.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:36</div></div>
<div class="ttc" id="astructMatShellCtx_html_a04555832d4416ff0e20253b6fd98b6d2"><div class="ttname"><a href="structMatShellCtx.html#a04555832d4416ff0e20253b6fd98b6d2">MatShellCtx::oscil_vec</a></div><div class="ttdeci">Oscillator ** oscil_vec</div><div class="ttdoc">Array of pointers to the oscillators.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:22</div></div>
<div class="ttc" id="astructMatShellCtx_html_a064ecab1e678a757d3555ea1d8fd13b7"><div class="ttname"><a href="structMatShellCtx.html#a064ecab1e678a757d3555ea1d8fd13b7">MatShellCtx::nlevels</a></div><div class="ttdeci">std::vector&lt; int &gt; nlevels</div><div class="ttdoc">Number of levels per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:20</div></div>
<div class="ttc" id="astructMatShellCtx_html_a0e414f19d926dfcfbd673069aa0bd60c"><div class="ttname"><a href="structMatShellCtx.html#a0e414f19d926dfcfbd673069aa0bd60c">MatShellCtx::aux</a></div><div class="ttdeci">Vec * aux</div><div class="ttdoc">Auxiliary vector for computations.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:38</div></div>
<div class="ttc" id="astructMatShellCtx_html_a34c21d5b991c90f4dc49f8007772870a"><div class="ttname"><a href="structMatShellCtx.html#a34c21d5b991c90f4dc49f8007772870a">MatShellCtx::Jkl</a></div><div class="ttdeci">std::vector&lt; double &gt; Jkl</div><div class="ttdoc">Dipole-dipole coupling coefficients.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:24</div></div>
<div class="ttc" id="astructMatShellCtx_html_a35412254e1443f6067a4426bb8cd8f73"><div class="ttname"><a href="structMatShellCtx.html#a35412254e1443f6067a4426bb8cd8f73">MatShellCtx::eval_transfer_Hdt_re</a></div><div class="ttdeci">std::vector&lt; double &gt; eval_transfer_Hdt_re</div><div class="ttdoc">Evaluated real transfer functions for time-varying Hamiltonian.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:30</div></div>
<div class="ttc" id="astructMatShellCtx_html_a4163f6fb8f64ba0184f3ebb50bd69a39"><div class="ttname"><a href="structMatShellCtx.html#a4163f6fb8f64ba0184f3ebb50bd69a39">MatShellCtx::eta</a></div><div class="ttdeci">std::vector&lt; double &gt; eta</div><div class="ttdoc">Frequency differences of the rotating frames.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:25</div></div>
<div class="ttc" id="astructMatShellCtx_html_a676903557b02ac5450346a60cc241ca1"><div class="ttname"><a href="structMatShellCtx.html#a676903557b02ac5450346a60cc241ca1">MatShellCtx::Bc_vec</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Mat &gt; &gt; Bc_vec</div><div class="ttdoc">Vector of Imaginary parts of control matrices per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:33</div></div>
<div class="ttc" id="astructMatShellCtx_html_a6d70c2aeb5c6016d867aab74747d0125"><div class="ttname"><a href="structMatShellCtx.html#a6d70c2aeb5c6016d867aab74747d0125">MatShellCtx::crosskerr</a></div><div class="ttdeci">std::vector&lt; double &gt; crosskerr</div><div class="ttdoc">Cross-Kerr coupling coefficients.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:23</div></div>
<div class="ttc" id="astructMatShellCtx_html_a7444246ae4834351b67ceee29481287c"><div class="ttname"><a href="structMatShellCtx.html#a7444246ae4834351b67ceee29481287c">MatShellCtx::time</a></div><div class="ttdeci">double time</div><div class="ttdoc">Current time.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:39</div></div>
<div class="ttc" id="astructMatShellCtx_html_a82a20720c0e8ad791f959153ffee0a7b"><div class="ttname"><a href="structMatShellCtx.html#a82a20720c0e8ad791f959153ffee0a7b">MatShellCtx::lindbladtype</a></div><div class="ttdeci">LindbladType lindbladtype</div><div class="ttdoc">Type of Lindblad operators to include.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:26</div></div>
<div class="ttc" id="astructMatShellCtx_html_a877b20ea0213d60200aa2a6c829851f1"><div class="ttname"><a href="structMatShellCtx.html#a877b20ea0213d60200aa2a6c829851f1">MatShellCtx::Ad</a></div><div class="ttdeci">Mat * Ad</div><div class="ttdoc">Real parts of time-independent system matrix , without the coupling terms.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:34</div></div>
<div class="ttc" id="astructMatShellCtx_html_a94225b343a1fb5c88a86dee9ae70fb17"><div class="ttname"><a href="structMatShellCtx.html#a94225b343a1fb5c88a86dee9ae70fb17">MatShellCtx::Ac_vec</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Mat &gt; &gt; Ac_vec</div><div class="ttdoc">Vector of Real parts of control matrices per oscillator.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:32</div></div>
<div class="ttc" id="astructMatShellCtx_html_abf9f8b8348e0c0aa80e73ab45b3cae3b"><div class="ttname"><a href="structMatShellCtx.html#abf9f8b8348e0c0aa80e73ab45b3cae3b">MatShellCtx::isu</a></div><div class="ttdeci">IS * isu</div><div class="ttdef"><b>Definition</b> mastereq.hpp:21</div></div>
<div class="ttc" id="astructMatShellCtx_html_abfb6725d58118545ef1e714c37a76ee0"><div class="ttname"><a href="structMatShellCtx.html#abfb6725d58118545ef1e714c37a76ee0">MatShellCtx::Bd</a></div><div class="ttdeci">Mat * Bd</div><div class="ttdoc">Imaginary parts of time-independent system matrix , without the coupling terms.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:35</div></div>
<div class="ttc" id="astructMatShellCtx_html_ad803d2b68dc35ce7718b0401f81b08c6"><div class="ttname"><a href="structMatShellCtx.html#ad803d2b68dc35ce7718b0401f81b08c6">MatShellCtx::control_Im</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; control_Im</div><div class="ttdoc">Imaginary parts of control pulse .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:29</div></div>
<div class="ttc" id="astructMatShellCtx_html_adb5a65dd9d7be5752fa6dffec62ab0c9"><div class="ttname"><a href="structMatShellCtx.html#adb5a65dd9d7be5752fa6dffec62ab0c9">MatShellCtx::addT1</a></div><div class="ttdeci">bool addT1</div><div class="ttdef"><b>Definition</b> mastereq.hpp:27</div></div>
<div class="ttc" id="astructMatShellCtx_html_ae10aee7fdcd0267229a54dd6d9e7ace1"><div class="ttname"><a href="structMatShellCtx.html#ae10aee7fdcd0267229a54dd6d9e7ace1">MatShellCtx::Bd_vec</a></div><div class="ttdeci">std::vector&lt; Mat &gt; Bd_vec</div><div class="ttdoc">Imaginary parts of dipole-dipole coupling system matrices.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:37</div></div>
<div class="ttc" id="astructMatShellCtx_html_ae6b69e7f840a9e42ee0021bccc9a96a6"><div class="ttname"><a href="structMatShellCtx.html#ae6b69e7f840a9e42ee0021bccc9a96a6">MatShellCtx::eval_transfer_Hdt_im</a></div><div class="ttdeci">std::vector&lt; double &gt; eval_transfer_Hdt_im</div><div class="ttdoc">Evaluated imaginary transfer functions for time-varying Hamiltonian.</div><div class="ttdef"><b>Definition</b> mastereq.hpp:31</div></div>
<div class="ttc" id="astructMatShellCtx_html_aece20973a9e46bf7a6c7359d0433ce59"><div class="ttname"><a href="structMatShellCtx.html#aece20973a9e46bf7a6c7359d0433ce59">MatShellCtx::control_Re</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; control_Re</div><div class="ttdoc">Real parts of control pulse .</div><div class="ttdef"><b>Definition</b> mastereq.hpp:28</div></div>
<div class="ttc" id="autil_8hpp_html"><div class="ttname"><a href="util_8hpp.html">util.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
