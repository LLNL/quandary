<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quandary: TimeStepper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Quandary
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classTimeStepper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TimeStepper Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Base class for time integration schemes to evolve the quantum dynamics.  
 <a href="classTimeStepper.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="timestepper_8hpp_source.html">timestepper.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for TimeStepper:</div>
<div class="dyncontent">
<div class="center"><img src="classTimeStepper__inherit__graph.png" border="0" usemap="#aTimeStepper_inherit__map" alt="Inheritance graph"/></div>
<map name="aTimeStepper_inherit__map" id="aTimeStepper_inherit__map">
<area shape="rect" title="Base class for time integration schemes to evolve the quantum dynamics." alt="" coords="54,5,159,31"/>
<area shape="rect" href="classExplEuler.html" title="Explicit Euler time integration scheme." alt="" coords="5,79,88,104"/>
<area shape="poly" title=" " alt="" coords="90,43,58,80,54,77,86,40"/>
<area shape="rect" href="classImplMidpoint.html" title="Implicit midpoint rule time integration scheme." alt="" coords="113,79,221,104"/>
<area shape="poly" title=" " alt="" coords="127,40,159,77,155,80,123,43"/>
<area shape="rect" href="classCompositionalImplMidpoint.html" title="Compositional implicit midpoint rule for higher&#45;order accuracy." alt="" coords="65,152,268,177"/>
<area shape="poly" title=" " alt="" coords="169,118,169,152,164,152,164,118"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for TimeStepper:</div>
<div class="dyncontent">
<div class="center"><img src="classTimeStepper__coll__graph.png" border="0" usemap="#aTimeStepper_coll__map" alt="Collaboration graph"/></div>
<map name="aTimeStepper_coll__map" id="aTimeStepper_coll__map">
<area shape="rect" title="Base class for time integration schemes to evolve the quantum dynamics." alt="" coords="217,357,323,383"/>
<area shape="rect" href="classMasterEq.html" title="Implementation of the real&#45;valued right&#45;hand&#45;side (RHS) system matrix of the quantum dynamical equati..." alt="" coords="117,269,199,295"/>
<area shape="poly" title=" " alt="" coords="175,304,200,331,241,355,238,360,196,335,171,308"/>
<area shape="rect" href="classOscillator.html" title="Quantum oscillator (multi&#45;level qubit) with control capabilities." alt="" coords="5,93,89,119"/>
<area shape="poly" title=" " alt="" coords="40,133,33,169,34,188,40,205,56,226,77,243,123,267,120,272,74,248,53,230,36,208,29,189,28,169,35,132"/>
<area shape="rect" href="structMatShellCtx.html" title="Matrix shell context containing data needed for applying the right&#45;hand&#45;side (RHS) system matrix to a..." alt="" coords="115,181,217,207"/>
<area shape="poly" title=" " alt="" coords="76,125,151,179,148,183,73,129"/>
<area shape="rect" href="structPiPulse.html" title="Structure for storing pi&#45;pulse parameters." alt="" coords="13,5,82,31"/>
<area shape="poly" title=" " alt="" coords="50,45,50,93,45,93,45,45"/>
<area shape="poly" title=" " alt="" coords="166,221,162,269,156,269,161,220"/>
<area shape="rect" href="classOptimTarget.html" title="Optimization target specification for quantum control." alt="" coords="224,269,327,295"/>
<area shape="poly" title=" " alt="" coords="275,309,274,319,273,357,267,357,269,319,270,308"/>
<area shape="rect" href="classGate.html" title="Base class for quantum gate operations." alt="" coords="249,181,302,207"/>
<area shape="poly" title=" " alt="" coords="278,221,278,269,273,269,273,221"/>
<area shape="rect" href="classOutput.html" title="Output management for quantum control simulations and optimization." alt="" coords="357,269,423,295"/>
<area shape="poly" title=" " alt="" coords="382,309,362,335,341,350,318,360,316,355,338,345,359,331,378,306"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a88c17d2b22882ca947e83c25e903be1d" id="r_a88c17d2b22882ca947e83c25e903be1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a88c17d2b22882ca947e83c25e903be1d">TimeStepper</a> ()</td></tr>
<tr class="separator:a88c17d2b22882ca947e83c25e903be1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d1e7d86ea1d20606bc1c6b24a49a8c" id="r_a29d1e7d86ea1d20606bc1c6b24a49a8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a29d1e7d86ea1d20606bc1c6b24a49a8c">TimeStepper</a> (<a class="el" href="classMasterEq.html">MasterEq</a> *mastereq_, int ntime_, double total_time_, <a class="el" href="classOutput.html">Output</a> *output_, bool storeFWD_)</td></tr>
<tr class="memdesc:a29d1e7d86ea1d20606bc1c6b24a49a8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for time stepper.  <br /></td></tr>
<tr class="separator:a29d1e7d86ea1d20606bc1c6b24a49a8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d80eb58c811581ef79a0b3749fb5825" id="r_a2d80eb58c811581ef79a0b3749fb5825"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a2d80eb58c811581ef79a0b3749fb5825">~TimeStepper</a> ()</td></tr>
<tr class="separator:a2d80eb58c811581ef79a0b3749fb5825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf523a5e2230eec37e27f4a9e590796" id="r_afdf523a5e2230eec37e27f4a9e590796"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#afdf523a5e2230eec37e27f4a9e590796">getState</a> (size_t tindex)</td></tr>
<tr class="memdesc:afdf523a5e2230eec37e27f4a9e590796"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves stored state at a specific time index.  <br /></td></tr>
<tr class="separator:afdf523a5e2230eec37e27f4a9e590796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2be974cc2dd652299ba12a36ffece58" id="r_ae2be974cc2dd652299ba12a36ffece58"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ae2be974cc2dd652299ba12a36ffece58">solveODE</a> (int initid, Vec rho_t0)</td></tr>
<tr class="memdesc:ae2be974cc2dd652299ba12a36ffece58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the ODE forward in time.  <br /></td></tr>
<tr class="separator:ae2be974cc2dd652299ba12a36ffece58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab958d4087d5b20f0f6f6695560d05c4" id="r_aab958d4087d5b20f0f6f6695560d05c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#aab958d4087d5b20f0f6f6695560d05c4">solveAdjointODE</a> (Vec rho_t0_bar, Vec finalstate, double Jbar_penalty, double Jbar_penalty_dpdm, double Jbar_penalty_energy)</td></tr>
<tr class="memdesc:aab958d4087d5b20f0f6f6695560d05c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the adjoint ODE backward in time.  <br /></td></tr>
<tr class="separator:aab958d4087d5b20f0f6f6695560d05c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20323563a86450e343004279995a55f4" id="r_a20323563a86450e343004279995a55f4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a20323563a86450e343004279995a55f4">penaltyIntegral</a> (double time, const Vec <a class="el" href="classTimeStepper.html#a7b47c0f5ce67d8f4a04c77c2c96bd93c">x</a>)</td></tr>
<tr class="memdesc:a20323563a86450e343004279995a55f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the penalty integral term.  <br /></td></tr>
<tr class="separator:a20323563a86450e343004279995a55f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ae1a39f30f0041375ae4ddf25a60b1" id="r_ac9ae1a39f30f0041375ae4ddf25a60b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ac9ae1a39f30f0041375ae4ddf25a60b1">penaltyIntegral_diff</a> (double time, const Vec <a class="el" href="classTimeStepper.html#a7b47c0f5ce67d8f4a04c77c2c96bd93c">x</a>, Vec xbar, double Jbar)</td></tr>
<tr class="memdesc:ac9ae1a39f30f0041375ae4ddf25a60b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes derivative of penalty integral term.  <br /></td></tr>
<tr class="separator:ac9ae1a39f30f0041375ae4ddf25a60b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad13591047811f9ae208ece98c17985a3" id="r_ad13591047811f9ae208ece98c17985a3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ad13591047811f9ae208ece98c17985a3">penaltyDpDm</a> (Vec <a class="el" href="classTimeStepper.html#a7b47c0f5ce67d8f4a04c77c2c96bd93c">x</a>, Vec xm1, Vec xm2)</td></tr>
<tr class="memdesc:ad13591047811f9ae208ece98c17985a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates second-order derivative penalty for the state.  <br /></td></tr>
<tr class="separator:ad13591047811f9ae208ece98c17985a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fa2931e974b2d1fb9f53527d0eb094" id="r_ac8fa2931e974b2d1fb9f53527d0eb094"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ac8fa2931e974b2d1fb9f53527d0eb094">penaltyDpDm_diff</a> (int n, Vec xbar, double Jbar)</td></tr>
<tr class="memdesc:ac8fa2931e974b2d1fb9f53527d0eb094"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes derivative of second-order penalty term.  <br /></td></tr>
<tr class="separator:ac8fa2931e974b2d1fb9f53527d0eb094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba6754e8ed674e4191f4704591a22116" id="r_aba6754e8ed674e4191f4704591a22116"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#aba6754e8ed674e4191f4704591a22116">energyPenaltyIntegral</a> (double time)</td></tr>
<tr class="memdesc:aba6754e8ed674e4191f4704591a22116"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates energy penalty integral term.  <br /></td></tr>
<tr class="separator:aba6754e8ed674e4191f4704591a22116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1453a4d14bf199a017661fd67f6dc9" id="r_a1b1453a4d14bf199a017661fd67f6dc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a1b1453a4d14bf199a017661fd67f6dc9">energyPenaltyIntegral_diff</a> (double time, double Jbar, Vec <a class="el" href="classTimeStepper.html#a117e801337dbe849388f274d4dec83d0">redgrad</a>)</td></tr>
<tr class="memdesc:a1b1453a4d14bf199a017661fd67f6dc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes derivative of energy penalty integral.  <br /></td></tr>
<tr class="separator:a1b1453a4d14bf199a017661fd67f6dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983a7d5b2c04dfb04caaead7bf5b9a49" id="r_a983a7d5b2c04dfb04caaead7bf5b9a49"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a983a7d5b2c04dfb04caaead7bf5b9a49">evolveFWD</a> (const double tstart, const double tstop, Vec <a class="el" href="classTimeStepper.html#a7b47c0f5ce67d8f4a04c77c2c96bd93c">x</a>)=0</td></tr>
<tr class="memdesc:a983a7d5b2c04dfb04caaead7bf5b9a49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evolves state forward by one time-step from tstart to tstop.  <br /></td></tr>
<tr class="separator:a983a7d5b2c04dfb04caaead7bf5b9a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7893cfa005fac0830ea331cbbe6b0dde" id="r_a7893cfa005fac0830ea331cbbe6b0dde"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a7893cfa005fac0830ea331cbbe6b0dde">evolveBWD</a> (const double tstart, const double tstop, const Vec x_stop, Vec x_adj, Vec grad, bool compute_gradient)</td></tr>
<tr class="memdesc:a7893cfa005fac0830ea331cbbe6b0dde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evolves adjoint state backward by one time-step and updates reduced gradient.  <br /></td></tr>
<tr class="separator:a7893cfa005fac0830ea331cbbe6b0dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a19a5d08c76bf1580122ec82665c2f7ef" id="r_a19a5d08c76bf1580122ec82665c2f7ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMasterEq.html">MasterEq</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a19a5d08c76bf1580122ec82665c2f7ef">mastereq</a></td></tr>
<tr class="memdesc:a19a5d08c76bf1580122ec82665c2f7ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to master equation solver.  <br /></td></tr>
<tr class="separator:a19a5d08c76bf1580122ec82665c2f7ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e462962525e2b0960c8d5ac813d3873" id="r_a1e462962525e2b0960c8d5ac813d3873"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a1e462962525e2b0960c8d5ac813d3873">ntime</a></td></tr>
<tr class="memdesc:a1e462962525e2b0960c8d5ac813d3873"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of time steps.  <br /></td></tr>
<tr class="separator:a1e462962525e2b0960c8d5ac813d3873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4094b333f65e347f95c78aea0effe544" id="r_a4094b333f65e347f95c78aea0effe544"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a4094b333f65e347f95c78aea0effe544">total_time</a></td></tr>
<tr class="memdesc:a4094b333f65e347f95c78aea0effe544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final evolution time.  <br /></td></tr>
<tr class="separator:a4094b333f65e347f95c78aea0effe544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad261faaaa2066bfaa7ca7d9af834e61e" id="r_ad261faaaa2066bfaa7ca7d9af834e61e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ad261faaaa2066bfaa7ca7d9af834e61e">dt</a></td></tr>
<tr class="memdesc:ad261faaaa2066bfaa7ca7d9af834e61e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time step size.  <br /></td></tr>
<tr class="separator:ad261faaaa2066bfaa7ca7d9af834e61e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244bd51adcaa255411718fb1ecee9cf3" id="r_a244bd51adcaa255411718fb1ecee9cf3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a244bd51adcaa255411718fb1ecee9cf3">writeTrajectoryDataFiles</a></td></tr>
<tr class="memdesc:a244bd51adcaa255411718fb1ecee9cf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to determine whether or not trajectory data will be written to files during forward simulation *&zwj;/.  <br /></td></tr>
<tr class="separator:a244bd51adcaa255411718fb1ecee9cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a117e801337dbe849388f274d4dec83d0" id="r_a117e801337dbe849388f274d4dec83d0"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a117e801337dbe849388f274d4dec83d0">redgrad</a></td></tr>
<tr class="memdesc:a117e801337dbe849388f274d4dec83d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduced gradient vector for optimization.  <br /></td></tr>
<tr class="separator:a117e801337dbe849388f274d4dec83d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad904f4e9a7bc465c176813b5ea597e1c" id="r_ad904f4e9a7bc465c176813b5ea597e1c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ad904f4e9a7bc465c176813b5ea597e1c">penalty_integral</a></td></tr>
<tr class="memdesc:ad904f4e9a7bc465c176813b5ea597e1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums the integral penalty term.  <br /></td></tr>
<tr class="separator:ad904f4e9a7bc465c176813b5ea597e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c30655966d681d63abf2bf681246c27" id="r_a3c30655966d681d63abf2bf681246c27"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a3c30655966d681d63abf2bf681246c27">energy_penalty_integral</a></td></tr>
<tr class="memdesc:a3c30655966d681d63abf2bf681246c27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums the energy penalty term.  <br /></td></tr>
<tr class="separator:a3c30655966d681d63abf2bf681246c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f04bd683057a0b0c9d7f983cd3e0ba2" id="r_a4f04bd683057a0b0c9d7f983cd3e0ba2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a4f04bd683057a0b0c9d7f983cd3e0ba2">penalty_dpdm</a></td></tr>
<tr class="memdesc:a4f04bd683057a0b0c9d7f983cd3e0ba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums second-order derivative penalty value.  <br /></td></tr>
<tr class="separator:a4f04bd683057a0b0c9d7f983cd3e0ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc015010aa8be6a70c99750f5834497b" id="r_adc015010aa8be6a70c99750f5834497b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#adc015010aa8be6a70c99750f5834497b">penalty_param</a></td></tr>
<tr class="memdesc:adc015010aa8be6a70c99750f5834497b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameter for penalty term (Gaussian variance)  <br /></td></tr>
<tr class="separator:adc015010aa8be6a70c99750f5834497b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4918ef7617d3067ca4d30fa2ba6d8c0e" id="r_a4918ef7617d3067ca4d30fa2ba6d8c0e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a4918ef7617d3067ca4d30fa2ba6d8c0e">gamma_penalty</a></td></tr>
<tr class="memdesc:a4918ef7617d3067ca4d30fa2ba6d8c0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight for integral penalty term.  <br /></td></tr>
<tr class="separator:a4918ef7617d3067ca4d30fa2ba6d8c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47bd15cf9824ab95288af0cdd50a0c0c" id="r_a47bd15cf9824ab95288af0cdd50a0c0c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a47bd15cf9824ab95288af0cdd50a0c0c">gamma_penalty_dpdm</a></td></tr>
<tr class="memdesc:a47bd15cf9824ab95288af0cdd50a0c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight for second-order derivative penalty.  <br /></td></tr>
<tr class="separator:a47bd15cf9824ab95288af0cdd50a0c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dc38ea2f69981ce525681f7bb010c0e" id="r_a9dc38ea2f69981ce525681f7bb010c0e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a9dc38ea2f69981ce525681f7bb010c0e">gamma_penalty_energy</a></td></tr>
<tr class="memdesc:a9dc38ea2f69981ce525681f7bb010c0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight for energy penalty.  <br /></td></tr>
<tr class="separator:a9dc38ea2f69981ce525681f7bb010c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46de3914a9b905cc78a0bc3539e9aca5" id="r_a46de3914a9b905cc78a0bc3539e9aca5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOptimTarget.html">OptimTarget</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a46de3914a9b905cc78a0bc3539e9aca5">optim_target</a></td></tr>
<tr class="memdesc:a46de3914a9b905cc78a0bc3539e9aca5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to optimization target specification.  <br /></td></tr>
<tr class="separator:a46de3914a9b905cc78a0bc3539e9aca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4076027ab970589a3b91b247423043" id="r_a4b4076027ab970589a3b91b247423043"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOutput.html">Output</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a4b4076027ab970589a3b91b247423043">output</a></td></tr>
<tr class="memdesc:a4b4076027ab970589a3b91b247423043"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to output handler.  <br /></td></tr>
<tr class="separator:a4b4076027ab970589a3b91b247423043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae82adcec57a6945822726d1643f44102" id="r_ae82adcec57a6945822726d1643f44102"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ae82adcec57a6945822726d1643f44102">storeFWD</a></td></tr>
<tr class="memdesc:ae82adcec57a6945822726d1643f44102"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to store primal states during forward evaluation.  <br /></td></tr>
<tr class="separator:ae82adcec57a6945822726d1643f44102"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a7b47c0f5ce67d8f4a04c77c2c96bd93c" id="r_a7b47c0f5ce67d8f4a04c77c2c96bd93c"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a7b47c0f5ce67d8f4a04c77c2c96bd93c">x</a></td></tr>
<tr class="memdesc:a7b47c0f5ce67d8f4a04c77c2c96bd93c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary vector for forward time stepping.  <br /></td></tr>
<tr class="separator:a7b47c0f5ce67d8f4a04c77c2c96bd93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab30ea87386f35e5dc10e450d63a1101b" id="r_ab30ea87386f35e5dc10e450d63a1101b"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ab30ea87386f35e5dc10e450d63a1101b">xadj</a></td></tr>
<tr class="memdesc:ab30ea87386f35e5dc10e450d63a1101b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary vector needed for adjoint (backward) time stepping.  <br /></td></tr>
<tr class="separator:ab30ea87386f35e5dc10e450d63a1101b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315f2a8c9cde21580392172781cb1758" id="r_a315f2a8c9cde21580392172781cb1758"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a315f2a8c9cde21580392172781cb1758">xprimal</a></td></tr>
<tr class="memdesc:a315f2a8c9cde21580392172781cb1758"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary vector for backward time stepping.  <br /></td></tr>
<tr class="separator:a315f2a8c9cde21580392172781cb1758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead1a9a5a59b8d541e95c7b66cb51bd9" id="r_aead1a9a5a59b8d541e95c7b66cb51bd9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Vec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#aead1a9a5a59b8d541e95c7b66cb51bd9">store_states</a></td></tr>
<tr class="memdesc:aead1a9a5a59b8d541e95c7b66cb51bd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for primal states during forward evolution.  <br /></td></tr>
<tr class="separator:aead1a9a5a59b8d541e95c7b66cb51bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33769128e30e615ac6527991392554e1" id="r_a33769128e30e615ac6527991392554e1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Vec &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a33769128e30e615ac6527991392554e1">dpdm_states</a></td></tr>
<tr class="memdesc:a33769128e30e615ac6527991392554e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for states needed for second-order derivative penalty.  <br /></td></tr>
<tr class="separator:a33769128e30e615ac6527991392554e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d89224e5aa0186796c0f7849df5a5bc" id="r_a2d89224e5aa0186796c0f7849df5a5bc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a2d89224e5aa0186796c0f7849df5a5bc">addLeakagePrevent</a></td></tr>
<tr class="memdesc:a2d89224e5aa0186796c0f7849df5a5bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to include leakage prevention penalty term.  <br /></td></tr>
<tr class="separator:a2d89224e5aa0186796c0f7849df5a5bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a354e57936c67ef0191a90d2c8c343e39" id="r_a354e57936c67ef0191a90d2c8c343e39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a354e57936c67ef0191a90d2c8c343e39">mpirank_world</a></td></tr>
<tr class="memdesc:a354e57936c67ef0191a90d2c8c343e39"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI rank in global communicator.  <br /></td></tr>
<tr class="separator:a354e57936c67ef0191a90d2c8c343e39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad94ad10793beb1ceaa4e1e891fbe5fa0" id="r_ad94ad10793beb1ceaa4e1e891fbe5fa0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ad94ad10793beb1ceaa4e1e891fbe5fa0">mpisize_petsc</a></td></tr>
<tr class="memdesc:ad94ad10793beb1ceaa4e1e891fbe5fa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI size in Petsc communicator.  <br /></td></tr>
<tr class="separator:ad94ad10793beb1ceaa4e1e891fbe5fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1312affa8a74d82367c5f3cdaddf92c7" id="r_a1312affa8a74d82367c5f3cdaddf92c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a1312affa8a74d82367c5f3cdaddf92c7">mpirank_petsc</a></td></tr>
<tr class="memdesc:a1312affa8a74d82367c5f3cdaddf92c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI rank in Petsc communicator.  <br /></td></tr>
<tr class="separator:a1312affa8a74d82367c5f3cdaddf92c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73aaee4909456bd8c9b5d4b0d1ffb12" id="r_ab73aaee4909456bd8c9b5d4b0d1ffb12"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#ab73aaee4909456bd8c9b5d4b0d1ffb12">localsize_u</a></td></tr>
<tr class="memdesc:ab73aaee4909456bd8c9b5d4b0d1ffb12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of local sub vector u or v in state x=[u,v].  <br /></td></tr>
<tr class="separator:ab73aaee4909456bd8c9b5d4b0d1ffb12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f9f48fa49f9cbb63e0e4200601b87c" id="r_a83f9f48fa49f9cbb63e0e4200601b87c"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a83f9f48fa49f9cbb63e0e4200601b87c">ilow</a></td></tr>
<tr class="memdesc:a83f9f48fa49f9cbb63e0e4200601b87c"><td class="mdescLeft">&#160;</td><td class="mdescRight">First index of the local sub vector u,v.  <br /></td></tr>
<tr class="separator:a83f9f48fa49f9cbb63e0e4200601b87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212403add28856d8466b25e3a4ad2ad2" id="r_a212403add28856d8466b25e3a4ad2ad2"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTimeStepper.html#a212403add28856d8466b25e3a4ad2ad2">iupp</a></td></tr>
<tr class="memdesc:a212403add28856d8466b25e3a4ad2ad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last index (+1) of the local sub vector u,v.  <br /></td></tr>
<tr class="separator:a212403add28856d8466b25e3a4ad2ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for time integration schemes to evolve the quantum dynamics. </p>
<p>This abstract class provides the interface for time-stepping methods used to integrate the quantum evolution equations (Lindblad master equation or Schroedinger equation). It supports both forward and adjoint time integration, handles output of evolution data, and evaluates penalty integral terms.</p>
<p>Main functionality:</p><ul>
<li><a class="el" href="classTimeStepper.html#ae2be974cc2dd652299ba12a36ffece58">solveODE</a> propagates an initial state at time t0 to the final time T, while writing evolution data to files and adding to integral penalty terms, if needed.</li>
<li><a class="el" href="classTimeStepper.html#aab958d4087d5b20f0f6f6695560d05c4">solveAdjointODE</a> propagates a terminal (adjoint) condition through the time domain backwards in time from T to 0, while updating the reduced gradient along the way.</li>
</ul>
<p>This class contains references to:</p><ul>
<li><a class="el" href="classMasterEq.html">MasterEq</a> for evaluating and applying the right-hand-side system matrix of the real-valued, vectorized differential equation to a state vector at each time-step</li>
<li><a class="el" href="classOptimTarget.html">OptimTarget</a> for evaluating integral penalty terms at each time step</li>
<li><a class="el" href="classOutput.html">Output</a> for writing evolution data to output files at each time step </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a88c17d2b22882ca947e83c25e903be1d" name="a88c17d2b22882ca947e83c25e903be1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88c17d2b22882ca947e83c25e903be1d">&#9670;&#160;</a></span>TimeStepper() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TimeStepper::TimeStepper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29d1e7d86ea1d20606bc1c6b24a49a8c" name="a29d1e7d86ea1d20606bc1c6b24a49a8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d1e7d86ea1d20606bc1c6b24a49a8c">&#9670;&#160;</a></span>TimeStepper() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TimeStepper::TimeStepper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMasterEq.html">MasterEq</a> *&#160;</td>
          <td class="paramname"><em>mastereq_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntime_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>total_time_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutput.html">Output</a> *&#160;</td>
          <td class="paramname"><em>output_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>storeFWD_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for time stepper. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mastereq_</td><td>Pointer to master equation solver </td></tr>
    <tr><td class="paramname">ntime_</td><td>Number of time steps </td></tr>
    <tr><td class="paramname">total_time_</td><td>Final evolution time </td></tr>
    <tr><td class="paramname">output_</td><td>Pointer to output handler </td></tr>
    <tr><td class="paramname">storeFWD_</td><td>Flag to store forward states </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2d80eb58c811581ef79a0b3749fb5825" name="a2d80eb58c811581ef79a0b3749fb5825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d80eb58c811581ef79a0b3749fb5825">&#9670;&#160;</a></span>~TimeStepper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TimeStepper::~TimeStepper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aba6754e8ed674e4191f4704591a22116" name="aba6754e8ed674e4191f4704591a22116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba6754e8ed674e4191f4704591a22116">&#9670;&#160;</a></span>energyPenaltyIntegral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::energyPenaltyIntegral </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates energy penalty integral term. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double Energy penalty value </dd></dl>

</div>
</div>
<a id="a1b1453a4d14bf199a017661fd67f6dc9" name="a1b1453a4d14bf199a017661fd67f6dc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b1453a4d14bf199a017661fd67f6dc9">&#9670;&#160;</a></span>energyPenaltyIntegral_diff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimeStepper::energyPenaltyIntegral_diff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>redgrad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes derivative of energy penalty integral. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">Jbar</td><td>Adjoint of energy penalty </td></tr>
    <tr><td class="paramname">redgrad</td><td>Reduced gradient vector to update </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7893cfa005fac0830ea331cbbe6b0dde" name="a7893cfa005fac0830ea331cbbe6b0dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7893cfa005fac0830ea331cbbe6b0dde">&#9670;&#160;</a></span>evolveBWD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TimeStepper::evolveBWD </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x_stop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>x_adj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compute_gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evolves adjoint state backward by one time-step and updates reduced gradient. </p>
<p>Abstract base-class implementation is empty. Derived classes that need backward time-stepping should implement this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tstart</td><td>Start time (backward evolution) </td></tr>
    <tr><td class="paramname">tstop</td><td>Stop time (backward evolution) </td></tr>
    <tr><td class="paramname">x_stop</td><td>State at stop time </td></tr>
    <tr><td class="paramname">x_adj</td><td>Adjoint state vector </td></tr>
    <tr><td class="paramname">grad</td><td>Gradient vector to update </td></tr>
    <tr><td class="paramname">compute_gradient</td><td>Flag to compute gradient </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classExplEuler.html#a5e41f719217a8d4b1b71c48ce3b2663f">ExplEuler</a>, <a class="el" href="classImplMidpoint.html#a9a8cc0c2876fc03c151dca7a2fd04846">ImplMidpoint</a>, and <a class="el" href="classCompositionalImplMidpoint.html#abd01c6fbee03fe29d75a9356e9979419">CompositionalImplMidpoint</a>.</p>

</div>
</div>
<a id="a983a7d5b2c04dfb04caaead7bf5b9a49" name="a983a7d5b2c04dfb04caaead7bf5b9a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983a7d5b2c04dfb04caaead7bf5b9a49">&#9670;&#160;</a></span>evolveFWD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void TimeStepper::evolveFWD </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tstop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evolves state forward by one time-step from tstart to tstop. </p>
<p>Pure virtual function to be implemented by the derived time-stepping classes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tstart</td><td>Start time </td></tr>
    <tr><td class="paramname">tstop</td><td>Stop time </td></tr>
    <tr><td class="paramname">x</td><td>State vector to evolve </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classExplEuler.html#aa0eaac3cc901b02aa6e7a3f6105c9e71">ExplEuler</a>, <a class="el" href="classImplMidpoint.html#a28749cf0676ac6094fe147691404ba77">ImplMidpoint</a>, and <a class="el" href="classCompositionalImplMidpoint.html#a9ddba7725c23285f47ac42c1fb63cd78">CompositionalImplMidpoint</a>.</p>

</div>
</div>
<a id="afdf523a5e2230eec37e27f4a9e590796" name="afdf523a5e2230eec37e27f4a9e590796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf523a5e2230eec37e27f4a9e590796">&#9670;&#160;</a></span>getState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Vec TimeStepper::getState </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tindex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves stored state at a specific time index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tindex</td><td>Time step index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vec State vector at the specified time </dd></dl>

</div>
</div>
<a id="ad13591047811f9ae208ece98c17985a3" name="ad13591047811f9ae208ece98c17985a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad13591047811f9ae208ece98c17985a3">&#9670;&#160;</a></span>penaltyDpDm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::penaltyDpDm </td>
          <td>(</td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>xm1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>xm2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates second-order derivative penalty for the state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Current state vector </td></tr>
    <tr><td class="paramname">xm1</td><td>State vector at previous time step </td></tr>
    <tr><td class="paramname">xm2</td><td>State vector at two time steps ago </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double Second-order penalty value </dd></dl>

</div>
</div>
<a id="ac8fa2931e974b2d1fb9f53527d0eb094" name="ac8fa2931e974b2d1fb9f53527d0eb094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fa2931e974b2d1fb9f53527d0eb094">&#9670;&#160;</a></span>penaltyDpDm_diff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimeStepper::penaltyDpDm_diff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>xbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jbar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes derivative of second-order penalty term. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Time step index </td></tr>
    <tr><td class="paramname">xbar</td><td>Adjoint state vector to update </td></tr>
    <tr><td class="paramname">Jbar</td><td>Adjoint of penalty term </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a20323563a86450e343004279995a55f4" name="a20323563a86450e343004279995a55f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20323563a86450e343004279995a55f4">&#9670;&#160;</a></span>penaltyIntegral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::penaltyIntegral </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the penalty integral term. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">x</td><td>Current state vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double Penalty term value </dd></dl>

</div>
</div>
<a id="ac9ae1a39f30f0041375ae4ddf25a60b1" name="ac9ae1a39f30f0041375ae4ddf25a60b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ae1a39f30f0041375ae4ddf25a60b1">&#9670;&#160;</a></span>penaltyIntegral_diff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimeStepper::penaltyIntegral_diff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>xbar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jbar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes derivative of penalty integral term. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Current time </td></tr>
    <tr><td class="paramname">x</td><td>Current state vector </td></tr>
    <tr><td class="paramname">xbar</td><td>Adjoint state vector to update </td></tr>
    <tr><td class="paramname">Jbar</td><td>Adjoint of penalty term </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aab958d4087d5b20f0f6f6695560d05c4" name="aab958d4087d5b20f0f6f6695560d05c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab958d4087d5b20f0f6f6695560d05c4">&#9670;&#160;</a></span>solveAdjointODE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimeStepper::solveAdjointODE </td>
          <td>(</td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>rho_t0_bar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>finalstate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jbar_penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jbar_penalty_dpdm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jbar_penalty_energy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the adjoint ODE backward in time. </p>
<p>This performs backward time-stepping to backpropagate an adjoint initial condition at final time (aka a terminal condtion) to time t=0, while accumulating the reduced gradient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rho_t0_bar</td><td>Terminal condition for adjoint state </td></tr>
    <tr><td class="paramname">finalstate</td><td>Final state from forward evolution </td></tr>
    <tr><td class="paramname">Jbar_penalty</td><td>Adjoint of penalty integral term </td></tr>
    <tr><td class="paramname">Jbar_penalty_dpdm</td><td>Adjoint of second-order derivative penalty </td></tr>
    <tr><td class="paramname">Jbar_penalty_energy</td><td>Adjoint of energy penalty term </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae2be974cc2dd652299ba12a36ffece58" name="ae2be974cc2dd652299ba12a36ffece58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2be974cc2dd652299ba12a36ffece58">&#9670;&#160;</a></span>solveODE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Vec TimeStepper::solveODE </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>rho_t0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the ODE forward in time. </p>
<p>This performs the time-stepping to propagate an initial condition to the final time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initid</td><td>Initial condition identifier </td></tr>
    <tr><td class="paramname">rho_t0</td><td>Initial state vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vec Final state vector at time T </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2d89224e5aa0186796c0f7849df5a5bc" name="a2d89224e5aa0186796c0f7849df5a5bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d89224e5aa0186796c0f7849df5a5bc">&#9670;&#160;</a></span>addLeakagePrevent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool TimeStepper::addLeakagePrevent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to include leakage prevention penalty term. </p>

</div>
</div>
<a id="a33769128e30e615ac6527991392554e1" name="a33769128e30e615ac6527991392554e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33769128e30e615ac6527991392554e1">&#9670;&#160;</a></span>dpdm_states</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Vec&gt; TimeStepper::dpdm_states</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for states needed for second-order derivative penalty. </p>

</div>
</div>
<a id="ad261faaaa2066bfaa7ca7d9af834e61e" name="ad261faaaa2066bfaa7ca7d9af834e61e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad261faaaa2066bfaa7ca7d9af834e61e">&#9670;&#160;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::dt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Time step size. </p>

</div>
</div>
<a id="a3c30655966d681d63abf2bf681246c27" name="a3c30655966d681d63abf2bf681246c27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c30655966d681d63abf2bf681246c27">&#9670;&#160;</a></span>energy_penalty_integral</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::energy_penalty_integral</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sums the energy penalty term. </p>

</div>
</div>
<a id="a4918ef7617d3067ca4d30fa2ba6d8c0e" name="a4918ef7617d3067ca4d30fa2ba6d8c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4918ef7617d3067ca4d30fa2ba6d8c0e">&#9670;&#160;</a></span>gamma_penalty</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::gamma_penalty</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weight for integral penalty term. </p>

</div>
</div>
<a id="a47bd15cf9824ab95288af0cdd50a0c0c" name="a47bd15cf9824ab95288af0cdd50a0c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47bd15cf9824ab95288af0cdd50a0c0c">&#9670;&#160;</a></span>gamma_penalty_dpdm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::gamma_penalty_dpdm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weight for second-order derivative penalty. </p>

</div>
</div>
<a id="a9dc38ea2f69981ce525681f7bb010c0e" name="a9dc38ea2f69981ce525681f7bb010c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dc38ea2f69981ce525681f7bb010c0e">&#9670;&#160;</a></span>gamma_penalty_energy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::gamma_penalty_energy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weight for energy penalty. </p>

</div>
</div>
<a id="a83f9f48fa49f9cbb63e0e4200601b87c" name="a83f9f48fa49f9cbb63e0e4200601b87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f9f48fa49f9cbb63e0e4200601b87c">&#9670;&#160;</a></span>ilow</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt TimeStepper::ilow</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First index of the local sub vector u,v. </p>

</div>
</div>
<a id="a212403add28856d8466b25e3a4ad2ad2" name="a212403add28856d8466b25e3a4ad2ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a212403add28856d8466b25e3a4ad2ad2">&#9670;&#160;</a></span>iupp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt TimeStepper::iupp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last index (+1) of the local sub vector u,v. </p>

</div>
</div>
<a id="ab73aaee4909456bd8c9b5d4b0d1ffb12" name="ab73aaee4909456bd8c9b5d4b0d1ffb12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab73aaee4909456bd8c9b5d4b0d1ffb12">&#9670;&#160;</a></span>localsize_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt TimeStepper::localsize_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Size of local sub vector u or v in state x=[u,v]. </p>

</div>
</div>
<a id="a19a5d08c76bf1580122ec82665c2f7ef" name="a19a5d08c76bf1580122ec82665c2f7ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a5d08c76bf1580122ec82665c2f7ef">&#9670;&#160;</a></span>mastereq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMasterEq.html">MasterEq</a>* TimeStepper::mastereq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to master equation solver. </p>

</div>
</div>
<a id="a1312affa8a74d82367c5f3cdaddf92c7" name="a1312affa8a74d82367c5f3cdaddf92c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1312affa8a74d82367c5f3cdaddf92c7">&#9670;&#160;</a></span>mpirank_petsc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int TimeStepper::mpirank_petsc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MPI rank in Petsc communicator. </p>

</div>
</div>
<a id="a354e57936c67ef0191a90d2c8c343e39" name="a354e57936c67ef0191a90d2c8c343e39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a354e57936c67ef0191a90d2c8c343e39">&#9670;&#160;</a></span>mpirank_world</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int TimeStepper::mpirank_world</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MPI rank in global communicator. </p>

</div>
</div>
<a id="ad94ad10793beb1ceaa4e1e891fbe5fa0" name="ad94ad10793beb1ceaa4e1e891fbe5fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad94ad10793beb1ceaa4e1e891fbe5fa0">&#9670;&#160;</a></span>mpisize_petsc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int TimeStepper::mpisize_petsc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MPI size in Petsc communicator. </p>

</div>
</div>
<a id="a1e462962525e2b0960c8d5ac813d3873" name="a1e462962525e2b0960c8d5ac813d3873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e462962525e2b0960c8d5ac813d3873">&#9670;&#160;</a></span>ntime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TimeStepper::ntime</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of time steps. </p>

</div>
</div>
<a id="a46de3914a9b905cc78a0bc3539e9aca5" name="a46de3914a9b905cc78a0bc3539e9aca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46de3914a9b905cc78a0bc3539e9aca5">&#9670;&#160;</a></span>optim_target</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOptimTarget.html">OptimTarget</a>* TimeStepper::optim_target</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to optimization target specification. </p>

</div>
</div>
<a id="a4b4076027ab970589a3b91b247423043" name="a4b4076027ab970589a3b91b247423043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4076027ab970589a3b91b247423043">&#9670;&#160;</a></span>output</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOutput.html">Output</a>* TimeStepper::output</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to output handler. </p>

</div>
</div>
<a id="a4f04bd683057a0b0c9d7f983cd3e0ba2" name="a4f04bd683057a0b0c9d7f983cd3e0ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f04bd683057a0b0c9d7f983cd3e0ba2">&#9670;&#160;</a></span>penalty_dpdm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::penalty_dpdm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sums second-order derivative penalty value. </p>

</div>
</div>
<a id="ad904f4e9a7bc465c176813b5ea597e1c" name="ad904f4e9a7bc465c176813b5ea597e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad904f4e9a7bc465c176813b5ea597e1c">&#9670;&#160;</a></span>penalty_integral</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::penalty_integral</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sums the integral penalty term. </p>

</div>
</div>
<a id="adc015010aa8be6a70c99750f5834497b" name="adc015010aa8be6a70c99750f5834497b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc015010aa8be6a70c99750f5834497b">&#9670;&#160;</a></span>penalty_param</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::penalty_param</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parameter for penalty term (Gaussian variance) </p>

</div>
</div>
<a id="a117e801337dbe849388f274d4dec83d0" name="a117e801337dbe849388f274d4dec83d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a117e801337dbe849388f274d4dec83d0">&#9670;&#160;</a></span>redgrad</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Vec TimeStepper::redgrad</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduced gradient vector for optimization. </p>

</div>
</div>
<a id="aead1a9a5a59b8d541e95c7b66cb51bd9" name="aead1a9a5a59b8d541e95c7b66cb51bd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead1a9a5a59b8d541e95c7b66cb51bd9">&#9670;&#160;</a></span>store_states</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Vec&gt; TimeStepper::store_states</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for primal states during forward evolution. </p>

</div>
</div>
<a id="ae82adcec57a6945822726d1643f44102" name="ae82adcec57a6945822726d1643f44102"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae82adcec57a6945822726d1643f44102">&#9670;&#160;</a></span>storeFWD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TimeStepper::storeFWD</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag to store primal states during forward evaluation. </p>

</div>
</div>
<a id="a4094b333f65e347f95c78aea0effe544" name="a4094b333f65e347f95c78aea0effe544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4094b333f65e347f95c78aea0effe544">&#9670;&#160;</a></span>total_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TimeStepper::total_time</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final evolution time. </p>

</div>
</div>
<a id="a244bd51adcaa255411718fb1ecee9cf3" name="a244bd51adcaa255411718fb1ecee9cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244bd51adcaa255411718fb1ecee9cf3">&#9670;&#160;</a></span>writeTrajectoryDataFiles</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TimeStepper::writeTrajectoryDataFiles</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag to determine whether or not trajectory data will be written to files during forward simulation *&zwj;/. </p>

</div>
</div>
<a id="a7b47c0f5ce67d8f4a04c77c2c96bd93c" name="a7b47c0f5ce67d8f4a04c77c2c96bd93c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b47c0f5ce67d8f4a04c77c2c96bd93c">&#9670;&#160;</a></span>x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec TimeStepper::x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary vector for forward time stepping. </p>

</div>
</div>
<a id="ab30ea87386f35e5dc10e450d63a1101b" name="ab30ea87386f35e5dc10e450d63a1101b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab30ea87386f35e5dc10e450d63a1101b">&#9670;&#160;</a></span>xadj</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec TimeStepper::xadj</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary vector needed for adjoint (backward) time stepping. </p>

</div>
</div>
<a id="a315f2a8c9cde21580392172781cb1758" name="a315f2a8c9cde21580392172781cb1758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a315f2a8c9cde21580392172781cb1758">&#9670;&#160;</a></span>xprimal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec TimeStepper::xprimal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary vector for backward time stepping. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/quandary/quandary/include/<a class="el" href="timestepper_8hpp_source.html">timestepper.hpp</a></li>
<li>/home/runner/work/quandary/quandary/src/<a class="el" href="timestepper_8cpp.html">timestepper.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
