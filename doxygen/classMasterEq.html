<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quandary: MasterEq Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Quandary
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classMasterEq-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MasterEq Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the real-valued right-hand-side (RHS) system matrix of the quantum dynamical equations.  
 <a href="classMasterEq.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mastereq_8hpp_source.html">mastereq.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for MasterEq:</div>
<div class="dyncontent">
<div class="center"><img src="classMasterEq__coll__graph.png" border="0" usemap="#aMasterEq_coll__map" alt="Collaboration graph"/></div>
<map name="aMasterEq_coll__map" id="aMasterEq_coll__map">
<area shape="rect" title="Implementation of the real&#45;valued right&#45;hand&#45;side (RHS) system matrix of the quantum dynamical equati..." alt="" coords="6,269,89,295"/>
<area shape="rect" href="classOscillator.html" title="Quantum oscillator (multi&#45;level qubit) with control capabilities." alt="" coords="5,93,89,119"/>
<area shape="poly" title=" " alt="" coords="45,133,41,168,41,207,48,269,43,269,35,207,36,167,40,132"/>
<area shape="rect" href="structMatShellCtx.html" title="Matrix shell context containing data needed for applying the right&#45;hand&#45;side (RHS) system matrix to a..." alt="" coords="115,181,217,207"/>
<area shape="poly" title=" " alt="" coords="76,125,151,179,148,183,73,129"/>
<area shape="rect" href="structPiPulse.html" title="Structure for storing pi&#45;pulse parameters." alt="" coords="13,5,82,31"/>
<area shape="poly" title=" " alt="" coords="50,45,50,93,45,93,45,45"/>
<area shape="poly" title=" " alt="" coords="140,217,65,271,62,267,137,213"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a24841be28d3b2ba8fec73988b07d16a5" id="r_a24841be28d3b2ba8fec73988b07d16a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a24841be28d3b2ba8fec73988b07d16a5">MasterEq</a> ()</td></tr>
<tr class="separator:a24841be28d3b2ba8fec73988b07d16a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d12515243f16e5a7ed971a4de6b52a8" id="r_a8d12515243f16e5a7ed971a4de6b52a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a8d12515243f16e5a7ed971a4de6b52a8">MasterEq</a> (const std::vector&lt; int &gt; &amp;<a class="el" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">nlevels</a>, const std::vector&lt; int &gt; &amp;<a class="el" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">nessential</a>, <a class="el" href="classOscillator.html">Oscillator</a> **oscil_vec_, const std::vector&lt; double &gt; &amp;crosskerr_, const std::vector&lt; double &gt; &amp;Jkl_, const std::vector&lt; double &gt; &amp;eta_, <a class="el" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> lindbladtype_, bool usematfree_, const std::string &amp;<a class="el" href="classMasterEq.html#a7b3188a199da02dba7d150c383b3f460">hamiltonian_file_Hsys</a>, const std::string &amp;<a class="el" href="classMasterEq.html#a4cc4d6da9ba0169c505d9a003e29a3fe">hamiltonian_file_Hc</a>, bool <a class="el" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">quietmode</a>=false)</td></tr>
<tr class="memdesc:a8d12515243f16e5a7ed971a4de6b52a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor with full system specification.  <br /></td></tr>
<tr class="separator:a8d12515243f16e5a7ed971a4de6b52a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9b8723f0500416cd3d2fcdd14fd9483" id="r_af9b8723f0500416cd3d2fcdd14fd9483"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#af9b8723f0500416cd3d2fcdd14fd9483">~MasterEq</a> ()</td></tr>
<tr class="separator:af9b8723f0500416cd3d2fcdd14fd9483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3fcf025c5e78f7cd5bed77d48660a7" id="r_a9e3fcf025c5e78f7cd5bed77d48660a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a9e3fcf025c5e78f7cd5bed77d48660a7">set_RHS_MatMult_operation</a> ()</td></tr>
<tr class="memdesc:a9e3fcf025c5e78f7cd5bed77d48660a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass MatMult operations for applying the RHS to PETSc.  <br /></td></tr>
<tr class="separator:a9e3fcf025c5e78f7cd5bed77d48660a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad34fc836f709483b81b724d8ec9f94c" id="r_aad34fc836f709483b81b724d8ec9f94c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#aad34fc836f709483b81b724d8ec9f94c">initSparseMatSolver</a> ()</td></tr>
<tr class="memdesc:aad34fc836f709483b81b724d8ec9f94c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes matrices needed for the sparse matrix solver.  <br /></td></tr>
<tr class="separator:aad34fc836f709483b81b724d8ec9f94c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e880910441b27fde4ff1aef4de2aac4" id="r_a7e880910441b27fde4ff1aef4de2aac4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOscillator.html">Oscillator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a7e880910441b27fde4ff1aef4de2aac4">getOscillator</a> (const size_t i)</td></tr>
<tr class="memdesc:a7e880910441b27fde4ff1aef4de2aac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the i-th oscillator.  <br /></td></tr>
<tr class="separator:a7e880910441b27fde4ff1aef4de2aac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601f1831ffce18ea5be8fd68e7bd60c2" id="r_a601f1831ffce18ea5be8fd68e7bd60c2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a601f1831ffce18ea5be8fd68e7bd60c2">getNOscillators</a> ()</td></tr>
<tr class="memdesc:a601f1831ffce18ea5be8fd68e7bd60c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the number of oscillators in the system.  <br /></td></tr>
<tr class="separator:a601f1831ffce18ea5be8fd68e7bd60c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a14f39e2a3e8392cfe7d0973c13d69" id="r_a55a14f39e2a3e8392cfe7d0973c13d69"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a55a14f39e2a3e8392cfe7d0973c13d69">getDim</a> ()</td></tr>
<tr class="memdesc:a55a14f39e2a3e8392cfe7d0973c13d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the dimension of the vectorized system.  <br /></td></tr>
<tr class="separator:a55a14f39e2a3e8392cfe7d0973c13d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9929979de484ffc7662ea738568d008" id="r_ad9929979de484ffc7662ea738568d008"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ad9929979de484ffc7662ea738568d008">getDimEss</a> ()</td></tr>
<tr class="memdesc:ad9929979de484ffc7662ea738568d008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the dimension of the essential level system.  <br /></td></tr>
<tr class="separator:ad9929979de484ffc7662ea738568d008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618faa8de97fc0dc613d31622191625a" id="r_a618faa8de97fc0dc613d31622191625a"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a618faa8de97fc0dc613d31622191625a">getDimRho</a> ()</td></tr>
<tr class="memdesc:a618faa8de97fc0dc613d31622191625a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the dimension of the density matrix.  <br /></td></tr>
<tr class="separator:a618faa8de97fc0dc613d31622191625a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadb9c6cdd2162ee2df713e40a72f7d5c" id="r_aadb9c6cdd2162ee2df713e40a72f7d5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#aadb9c6cdd2162ee2df713e40a72f7d5c">assemble_RHS</a> (const double t)</td></tr>
<tr class="memdesc:aadb9c6cdd2162ee2df713e40a72f7d5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assembles the real-valued system matrix (RHS) at time t.  <br /></td></tr>
<tr class="separator:aadb9c6cdd2162ee2df713e40a72f7d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114fff980e3a46ceeb53bbd7167c416f" id="r_a114fff980e3a46ceeb53bbd7167c416f"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a114fff980e3a46ceeb53bbd7167c416f">getRHS</a> ()</td></tr>
<tr class="memdesc:a114fff980e3a46ceeb53bbd7167c416f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the right-hand-side system matrix.  <br /></td></tr>
<tr class="separator:a114fff980e3a46ceeb53bbd7167c416f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd3d3d8301ab8e3d23a59601f1dd0665" id="r_afd3d3d8301ab8e3d23a59601f1dd0665"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#afd3d3d8301ab8e3d23a59601f1dd0665">compute_dRHS_dParams</a> (const double t, const Vec x, const Vec x_bar, const double alpha, Vec grad)</td></tr>
<tr class="memdesc:afd3d3d8301ab8e3d23a59601f1dd0665"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes gradient of RHS with respect to control parameters.  <br /></td></tr>
<tr class="separator:afd3d3d8301ab8e3d23a59601f1dd0665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af747a9c4013860f785cd80fe52e7f457" id="r_af747a9c4013860f785cd80fe52e7f457"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#af747a9c4013860f785cd80fe52e7f457">setControlAmplitudes</a> (const Vec x)</td></tr>
<tr class="memdesc:af747a9c4013860f785cd80fe52e7f457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass control parameters from global design vector to each oscillator.  <br /></td></tr>
<tr class="separator:af747a9c4013860f785cd80fe52e7f457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae5fbd62a0766d20ec823a001da6f570" id="r_aae5fbd62a0766d20ec823a001da6f570"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#aae5fbd62a0766d20ec823a001da6f570">expectedEnergy</a> (const Vec x)</td></tr>
<tr class="memdesc:aae5fbd62a0766d20ec823a001da6f570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes expected energy of the full composite system.  <br /></td></tr>
<tr class="separator:aae5fbd62a0766d20ec823a001da6f570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9308372d3f1aa99517dd313d5d2a4cd9" id="r_a9308372d3f1aa99517dd313d5d2a4cd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a9308372d3f1aa99517dd313d5d2a4cd9">population</a> (const Vec x, std::vector&lt; double &gt; &amp;population_com)</td></tr>
<tr class="memdesc:a9308372d3f1aa99517dd313d5d2a4cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes population of the full composite system.  <br /></td></tr>
<tr class="separator:a9308372d3f1aa99517dd313d5d2a4cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6cadd8dbe3e40e6ea087b6926de72c1f" id="r_a6cadd8dbe3e40e6ea087b6926de72c1f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a6cadd8dbe3e40e6ea087b6926de72c1f">nlevels</a></td></tr>
<tr class="memdesc:a6cadd8dbe3e40e6ea087b6926de72c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of levels per oscillator.  <br /></td></tr>
<tr class="separator:a6cadd8dbe3e40e6ea087b6926de72c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609bd3adeeaf8f9a53e7bdc59cd25be8" id="r_a609bd3adeeaf8f9a53e7bdc59cd25be8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a609bd3adeeaf8f9a53e7bdc59cd25be8">nessential</a></td></tr>
<tr class="memdesc:a609bd3adeeaf8f9a53e7bdc59cd25be8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of essential levels per oscillator.  <br /></td></tr>
<tr class="separator:a609bd3adeeaf8f9a53e7bdc59cd25be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d735524c2b5b205adb1898606b65a19" id="r_a2d735524c2b5b205adb1898606b65a19"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a2d735524c2b5b205adb1898606b65a19">usematfree</a></td></tr>
<tr class="memdesc:a2d735524c2b5b205adb1898606b65a19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for using matrix-free solver.  <br /></td></tr>
<tr class="separator:a2d735524c2b5b205adb1898606b65a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fd54198c43d043c544e72417e30dba" id="r_ac8fd54198c43d043c544e72417e30dba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ac8fd54198c43d043c544e72417e30dba">lindbladtype</a></td></tr>
<tr class="memdesc:ac8fd54198c43d043c544e72417e30dba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of Lindblad operators to include (NONE means Schroedinger equation)  <br /></td></tr>
<tr class="separator:ac8fd54198c43d043c544e72417e30dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ad7615921804c8c1dfda8295c9b83f805" id="r_ad7615921804c8c1dfda8295c9b83f805"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ad7615921804c8c1dfda8295c9b83f805">dim</a></td></tr>
<tr class="memdesc:ad7615921804c8c1dfda8295c9b83f805"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of full vectorized system: N^2 if Lindblad, N if Schroedinger.  <br /></td></tr>
<tr class="separator:ad7615921804c8c1dfda8295c9b83f805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a339bf57d2a07ca69cfc3bda69c5b2408" id="r_a339bf57d2a07ca69cfc3bda69c5b2408"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a339bf57d2a07ca69cfc3bda69c5b2408">dim_rho</a></td></tr>
<tr class="memdesc:a339bf57d2a07ca69cfc3bda69c5b2408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of Hilbert space = N.  <br /></td></tr>
<tr class="separator:a339bf57d2a07ca69cfc3bda69c5b2408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e8bccc92eb5e68c476b8940f2a69bb" id="r_ae1e8bccc92eb5e68c476b8940f2a69bb"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ae1e8bccc92eb5e68c476b8940f2a69bb">dim_ess</a></td></tr>
<tr class="memdesc:ae1e8bccc92eb5e68c476b8940f2a69bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of essential levels = N_e.  <br /></td></tr>
<tr class="separator:ae1e8bccc92eb5e68c476b8940f2a69bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaafcd9e3d4a617bbb86d004b44f7ad3d" id="r_aaafcd9e3d4a617bbb86d004b44f7ad3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#aaafcd9e3d4a617bbb86d004b44f7ad3d">noscillators</a></td></tr>
<tr class="memdesc:aaafcd9e3d4a617bbb86d004b44f7ad3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of oscillators in the system.  <br /></td></tr>
<tr class="separator:aaafcd9e3d4a617bbb86d004b44f7ad3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c35b6e30807ba37c4742a05af80f9ef" id="r_a6c35b6e30807ba37c4742a05af80f9ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOscillator.html">Oscillator</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a6c35b6e30807ba37c4742a05af80f9ef">oscil_vec</a></td></tr>
<tr class="memdesc:a6c35b6e30807ba37c4742a05af80f9ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of pointers to oscillator objects.  <br /></td></tr>
<tr class="separator:a6c35b6e30807ba37c4742a05af80f9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab200ca6b9a16be33b8ee7313c41f20d2" id="r_ab200ca6b9a16be33b8ee7313c41f20d2"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ab200ca6b9a16be33b8ee7313c41f20d2">RHS</a></td></tr>
<tr class="memdesc:ab200ca6b9a16be33b8ee7313c41f20d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">MatShell for real-valued, vectorized system matrix (size 2N^2 x 2N^2)  <br /></td></tr>
<tr class="separator:ab200ca6b9a16be33b8ee7313c41f20d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3bb1ab8dd49c64f51c90dd5b080f62" id="r_a6a3bb1ab8dd49c64f51c90dd5b080f62"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMatShellCtx.html">MatShellCtx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a6a3bb1ab8dd49c64f51c90dd5b080f62">RHSctx</a></td></tr>
<tr class="memdesc:a6a3bb1ab8dd49c64f51c90dd5b080f62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context containing data for applying the RHS to a state.  <br /></td></tr>
<tr class="separator:a6a3bb1ab8dd49c64f51c90dd5b080f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d6120b5a9fbbf9321ae897ea463d6be" id="r_a0d6120b5a9fbbf9321ae897ea463d6be"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Mat &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a0d6120b5a9fbbf9321ae897ea463d6be">Ac_vec</a></td></tr>
<tr class="separator:a0d6120b5a9fbbf9321ae897ea463d6be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01d9bc120f37351713381245939945f" id="r_af01d9bc120f37351713381245939945f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Mat &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#af01d9bc120f37351713381245939945f">Bc_vec</a></td></tr>
<tr class="separator:af01d9bc120f37351713381245939945f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa65ae612c591230c41eec8454936ee" id="r_a7aa65ae612c591230c41eec8454936ee"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a7aa65ae612c591230c41eec8454936ee">Ad</a></td></tr>
<tr class="separator:a7aa65ae612c591230c41eec8454936ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2afd1529a3b1793aa87ad1c008ef212a" id="r_a2afd1529a3b1793aa87ad1c008ef212a"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a2afd1529a3b1793aa87ad1c008ef212a">Bd</a></td></tr>
<tr class="separator:a2afd1529a3b1793aa87ad1c008ef212a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d2504ab06b61b6bfe11f623e5a002c" id="r_ab0d2504ab06b61b6bfe11f623e5a002c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Mat &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ab0d2504ab06b61b6bfe11f623e5a002c">Ad_vec</a></td></tr>
<tr class="separator:ab0d2504ab06b61b6bfe11f623e5a002c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c486486fc1feb02cbc77bd44ca3202a" id="r_a6c486486fc1feb02cbc77bd44ca3202a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Mat &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a6c486486fc1feb02cbc77bd44ca3202a">Bd_vec</a></td></tr>
<tr class="separator:a6c486486fc1feb02cbc77bd44ca3202a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d861dd8d9ad6f4e9b04e0109d3ee128" id="r_a3d861dd8d9ad6f4e9b04e0109d3ee128"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a3d861dd8d9ad6f4e9b04e0109d3ee128">crosskerr</a></td></tr>
<tr class="memdesc:a3d861dd8d9ad6f4e9b04e0109d3ee128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cross-Kerr coefficients (rad/time) \(\xi_{kl}\) for ZZ-coupling \(a_k^\dagger a_k a_l^\dagger a_l\).  <br /></td></tr>
<tr class="separator:a3d861dd8d9ad6f4e9b04e0109d3ee128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53a2013f8ebe3b279be5b04b2bba34e" id="r_ac53a2013f8ebe3b279be5b04b2bba34e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ac53a2013f8ebe3b279be5b04b2bba34e">Jkl</a></td></tr>
<tr class="memdesc:ac53a2013f8ebe3b279be5b04b2bba34e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dipole-dipole coupling coefficients (rad/time), multiplies \(a_k^\dagger a_l + a_k a_l^\dagger\).  <br /></td></tr>
<tr class="separator:ac53a2013f8ebe3b279be5b04b2bba34e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f69aef84b13fada56ebb31adf9fa7fd" id="r_a7f69aef84b13fada56ebb31adf9fa7fd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a7f69aef84b13fada56ebb31adf9fa7fd">eta</a></td></tr>
<tr class="memdesc:a7f69aef84b13fada56ebb31adf9fa7fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frequency differences in rotating frame (rad/time) for dipole-dipole coupling.  <br /></td></tr>
<tr class="separator:a7f69aef84b13fada56ebb31adf9fa7fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02dd3462531616d6a2a250a088990cd2" id="r_a02dd3462531616d6a2a250a088990cd2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a02dd3462531616d6a2a250a088990cd2">addT1</a></td></tr>
<tr class="separator:a02dd3462531616d6a2a250a088990cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0674aab017f75be72e15d45385a1ebf8" id="r_a0674aab017f75be72e15d45385a1ebf8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a0674aab017f75be72e15d45385a1ebf8">addT2</a></td></tr>
<tr class="memdesc:a0674aab017f75be72e15d45385a1ebf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for including T1 decay and T2 dephasing Lindblad operators.  <br /></td></tr>
<tr class="separator:a0674aab017f75be72e15d45385a1ebf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b7aa48c2cce32d27d0055e0a8d5990" id="r_ac7b7aa48c2cce32d27d0055e0a8d5990"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ac7b7aa48c2cce32d27d0055e0a8d5990">mpirank_world</a></td></tr>
<tr class="memdesc:ac7b7aa48c2cce32d27d0055e0a8d5990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rank of global MPI communicator.  <br /></td></tr>
<tr class="separator:ac7b7aa48c2cce32d27d0055e0a8d5990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7dfad49bfeafe1ebbaa4a23a4eae29" id="r_a1a7dfad49bfeafe1ebbaa4a23a4eae29"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a1a7dfad49bfeafe1ebbaa4a23a4eae29">mpirank_petsc</a></td></tr>
<tr class="memdesc:a1a7dfad49bfeafe1ebbaa4a23a4eae29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rank of PETSc's communicator.  <br /></td></tr>
<tr class="separator:a1a7dfad49bfeafe1ebbaa4a23a4eae29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee3fe0e3ed04fead9f70dc6841a1496" id="r_abee3fe0e3ed04fead9f70dc6841a1496"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#abee3fe0e3ed04fead9f70dc6841a1496">mpisize_petsc</a></td></tr>
<tr class="memdesc:abee3fe0e3ed04fead9f70dc6841a1496"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of PETSc's communicator.  <br /></td></tr>
<tr class="separator:abee3fe0e3ed04fead9f70dc6841a1496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5404fe64afa66ec3ce8486142394e3ca" id="r_a5404fe64afa66ec3ce8486142394e3ca"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a5404fe64afa66ec3ce8486142394e3ca">localsize_u</a></td></tr>
<tr class="memdesc:a5404fe64afa66ec3ce8486142394e3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of local sub vector u or v in state x=[u,v].  <br /></td></tr>
<tr class="separator:a5404fe64afa66ec3ce8486142394e3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34805631143b54e65a99ea9fccb7489" id="r_aa34805631143b54e65a99ea9fccb7489"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#aa34805631143b54e65a99ea9fccb7489">ilow</a></td></tr>
<tr class="memdesc:aa34805631143b54e65a99ea9fccb7489"><td class="mdescLeft">&#160;</td><td class="mdescRight">First index of the local sub vector u,v.  <br /></td></tr>
<tr class="separator:aa34805631143b54e65a99ea9fccb7489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b78dbc07dedc9c99358ecbb5f49fa0" id="r_ae3b78dbc07dedc9c99358ecbb5f49fa0"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ae3b78dbc07dedc9c99358ecbb5f49fa0">iupp</a></td></tr>
<tr class="memdesc:ae3b78dbc07dedc9c99358ecbb5f49fa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last index (+1) of the local sub vector u,v.  <br /></td></tr>
<tr class="separator:ae3b78dbc07dedc9c99358ecbb5f49fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44fad9cad554191a82455cf84d1fdd1f" id="r_a44fad9cad554191a82455cf84d1fdd1f"><td class="memItemLeft" align="right" valign="top">IS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a44fad9cad554191a82455cf84d1fdd1f">isu</a></td></tr>
<tr class="separator:a44fad9cad554191a82455cf84d1fdd1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b5dbe948eb0eb8570e4555d7ebedaa" id="r_a53b5dbe948eb0eb8570e4555d7ebedaa"><td class="memItemLeft" align="right" valign="top">IS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a53b5dbe948eb0eb8570e4555d7ebedaa">isv</a></td></tr>
<tr class="memdesc:a53b5dbe948eb0eb8570e4555d7ebedaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector strides for accessing real and imaginary parts u=Re(x), v=Im(x)  <br /></td></tr>
<tr class="separator:a53b5dbe948eb0eb8570e4555d7ebedaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59aa549dc17834871c3fdfe96f397e4" id="r_ad59aa549dc17834871c3fdfe96f397e4"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#ad59aa549dc17834871c3fdfe96f397e4">aux</a></td></tr>
<tr class="memdesc:ad59aa549dc17834871c3fdfe96f397e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary vector for computations.  <br /></td></tr>
<tr class="separator:ad59aa549dc17834871c3fdfe96f397e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3493e8372960cd42ba4ceab89fe68bb9" id="r_a3493e8372960cd42ba4ceab89fe68bb9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a3493e8372960cd42ba4ceab89fe68bb9">quietmode</a></td></tr>
<tr class="memdesc:a3493e8372960cd42ba4ceab89fe68bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for quiet mode operation.  <br /></td></tr>
<tr class="separator:a3493e8372960cd42ba4ceab89fe68bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3188a199da02dba7d150c383b3f460" id="r_a7b3188a199da02dba7d150c383b3f460"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a7b3188a199da02dba7d150c383b3f460">hamiltonian_file_Hsys</a></td></tr>
<tr class="memdesc:a7b3188a199da02dba7d150c383b3f460"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename if a custom system Hamiltonian is read from file ('none' if standard Hamiltonian is used)  <br /></td></tr>
<tr class="separator:a7b3188a199da02dba7d150c383b3f460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc4d6da9ba0169c505d9a003e29a3fe" id="r_a4cc4d6da9ba0169c505d9a003e29a3fe"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMasterEq.html#a4cc4d6da9ba0169c505d9a003e29a3fe">hamiltonian_file_Hc</a></td></tr>
<tr class="memdesc:a4cc4d6da9ba0169c505d9a003e29a3fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename if a custom control Hamiltonians are read from file ('none' if standard Hamiltonian is used)  <br /></td></tr>
<tr class="separator:a4cc4d6da9ba0169c505d9a003e29a3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the real-valued right-hand-side (RHS) system matrix of the quantum dynamical equations. </p>
<p>This class provides functionality for evaluating and applying the real-valued right-hand-side (RHS) system matrix of the vectorized Lindblad master equation (open quantum systems) or Schroedinger equation (closed systems). It supports a matrix-free and a sparse-matrix version for applying the RHS to a state vector. The system matrix (RHS) is stored as a Matrix Shell, that applies the real and imaginary parts of the system matrix to the corresponding parts of the state vector separately. The RHS needs to be assembled (evaluated at each time step t) before usage. <br  />
</p>
<p>Main functionality:</p><ul>
<li><a class="el" href="classMasterEq.html#aadb9c6cdd2162ee2df713e40a72f7d5c">assemble_RHS</a> for preparing the RHS system matrix shell with current control pulse values at given time t.</li>
<li><a class="el" href="classMasterEq.html#afd3d3d8301ab8e3d23a59601f1dd0665">compute_dRHS_dParams</a> for updating the gradient with += x^T*RHS(t)^T*x_bar, where x &amp; x_bar are the primal and adjoint state at time t</li>
<li><a class="el" href="classMasterEq.html#af747a9c4013860f785cd80fe52e7f457">setControlAmplitudes</a> for passing the global optimization vector to each oscillator</li>
<li><a class="el" href="classMasterEq.html#aae5fbd62a0766d20ec823a001da6f570">expectedEnergy</a> and <a class="el" href="classMasterEq.html#a9308372d3f1aa99517dd313d5d2a4cd9">population</a> for evaluating expected energy level and level occupations of the full composite system.</li>
<li>definition of MatMult interface functions to multiply the RHS matrix shell to a state vector (sparse matrix multiplication or matrix-free multiplication)</li>
</ul>
<p>This class contains references to:</p><ul>
<li>Array of <a class="el" href="classOscillator.html">Oscillator</a> for defining the Hamiltonian matrices for each subsystem (oscillator) and for evaluating their time-dependent control pulses at each time step </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a24841be28d3b2ba8fec73988b07d16a5" name="a24841be28d3b2ba8fec73988b07d16a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24841be28d3b2ba8fec73988b07d16a5">&#9670;&#160;</a></span>MasterEq() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MasterEq::MasterEq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8d12515243f16e5a7ed971a4de6b52a8" name="a8d12515243f16e5a7ed971a4de6b52a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d12515243f16e5a7ed971a4de6b52a8">&#9670;&#160;</a></span>MasterEq() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MasterEq::MasterEq </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>nlevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>nessential</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOscillator.html">Oscillator</a> **&#160;</td>
          <td class="paramname"><em>oscil_vec_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>crosskerr_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Jkl_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>eta_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a>&#160;</td>
          <td class="paramname"><em>lindbladtype_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>usematfree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>hamiltonian_file_Hsys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>hamiltonian_file_Hc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quietmode</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor with full system specification. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nlevels</td><td>Number of levels per oscillator </td></tr>
    <tr><td class="paramname">nessential</td><td>Number of essential levels per oscillator </td></tr>
    <tr><td class="paramname">oscil_vec_</td><td>Array of pointers to oscillator objects </td></tr>
    <tr><td class="paramname">crosskerr_</td><td>Cross-Kerr coupling coefficients </td></tr>
    <tr><td class="paramname">Jkl_</td><td>Dipole-dipole coupling coefficients </td></tr>
    <tr><td class="paramname">eta_</td><td>Frequency differences for rotating frame </td></tr>
    <tr><td class="paramname">lindbladtype_</td><td>Type of Lindblad operators to include </td></tr>
    <tr><td class="paramname">usematfree_</td><td>Flag to use matrix-free solver </td></tr>
    <tr><td class="paramname">hamiltonian_file_Hsys</td><td>Filename for system Hamiltonian data </td></tr>
    <tr><td class="paramname">hamiltonian_file_Hc</td><td>Filename for control Hamiltonian data </td></tr>
    <tr><td class="paramname">quietmode</td><td>Flag for quiet operation (default: false) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af9b8723f0500416cd3d2fcdd14fd9483" name="af9b8723f0500416cd3d2fcdd14fd9483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9b8723f0500416cd3d2fcdd14fd9483">&#9670;&#160;</a></span>~MasterEq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MasterEq::~MasterEq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aadb9c6cdd2162ee2df713e40a72f7d5c" name="aadb9c6cdd2162ee2df713e40a72f7d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadb9c6cdd2162ee2df713e40a72f7d5c">&#9670;&#160;</a></span>assemble_RHS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MasterEq::assemble_RHS </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assembles the real-valued system matrix (RHS) at time t. </p>
<p>Updates the time-dependent parameters in the RHS MatShell context. This must be called before applying the RHS to a state vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Current time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Error code </dd></dl>

</div>
</div>
<a id="afd3d3d8301ab8e3d23a59601f1dd0665" name="afd3d3d8301ab8e3d23a59601f1dd0665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd3d3d8301ab8e3d23a59601f1dd0665">&#9670;&#160;</a></span>compute_dRHS_dParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MasterEq::compute_dRHS_dParams </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x_bar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>grad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes gradient of RHS with respect to control parameters. </p>
<p>Updates grad += alpha * x^T * (d RHS / d params)^T * x_bar. Supports both the sparse-matrix and the matrix-free version of the RHS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Current time </td></tr>
    <tr><td class="paramname">x</td><td>State vector </td></tr>
    <tr><td class="paramname">x_bar</td><td>Adjoint state vector </td></tr>
    <tr><td class="paramname">alpha</td><td>Scaling factor </td></tr>
    <tr><td class="paramname">grad</td><td>Gradient vector to update </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aae5fbd62a0766d20ec823a001da6f570" name="aae5fbd62a0766d20ec823a001da6f570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae5fbd62a0766d20ec823a001da6f570">&#9670;&#160;</a></span>expectedEnergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MasterEq::expectedEnergy </td>
          <td>(</td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes expected energy of the full composite system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>State vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double Expected energy value </dd></dl>

</div>
</div>
<a id="a55a14f39e2a3e8392cfe7d0973c13d69" name="a55a14f39e2a3e8392cfe7d0973c13d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a14f39e2a3e8392cfe7d0973c13d69">&#9670;&#160;</a></span>getDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::getDim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the dimension of the vectorized system. </p>
<dl class="section return"><dt>Returns</dt><dd>PetscInt \(N^2\) for Lindblad solver, \(N\) for Schroedinger solver </dd></dl>

</div>
</div>
<a id="ad9929979de484ffc7662ea738568d008" name="ad9929979de484ffc7662ea738568d008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9929979de484ffc7662ea738568d008">&#9670;&#160;</a></span>getDimEss()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::getDimEss </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the dimension of the essential level system. </p>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Dimension N_e of essential levels </dd></dl>

</div>
</div>
<a id="a618faa8de97fc0dc613d31622191625a" name="a618faa8de97fc0dc613d31622191625a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618faa8de97fc0dc613d31622191625a">&#9670;&#160;</a></span>getDimRho()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::getDimRho </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the dimension of the density matrix. </p>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Dimension N of the Hilbert space </dd></dl>

</div>
</div>
<a id="a601f1831ffce18ea5be8fd68e7bd60c2" name="a601f1831ffce18ea5be8fd68e7bd60c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a601f1831ffce18ea5be8fd68e7bd60c2">&#9670;&#160;</a></span>getNOscillators()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t MasterEq::getNOscillators </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the number of oscillators in the system. </p>
<dl class="section return"><dt>Returns</dt><dd>size_t Number of oscillators </dd></dl>

</div>
</div>
<a id="a7e880910441b27fde4ff1aef4de2aac4" name="a7e880910441b27fde4ff1aef4de2aac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e880910441b27fde4ff1aef4de2aac4">&#9670;&#160;</a></span>getOscillator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOscillator.html">Oscillator</a> * MasterEq::getOscillator </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the i-th oscillator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Index of the oscillator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Oscillator* Pointer to the oscillator object </dd></dl>

</div>
</div>
<a id="a114fff980e3a46ceeb53bbd7167c416f" name="a114fff980e3a46ceeb53bbd7167c416f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114fff980e3a46ceeb53bbd7167c416f">&#9670;&#160;</a></span>getRHS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat MasterEq::getRHS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the right-hand-side system matrix. </p>
<dl class="section return"><dt>Returns</dt><dd>Mat PETSc matrix shell object representing the RHS. </dd></dl>

</div>
</div>
<a id="aad34fc836f709483b81b724d8ec9f94c" name="aad34fc836f709483b81b724d8ec9f94c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad34fc836f709483b81b724d8ec9f94c">&#9670;&#160;</a></span>initSparseMatSolver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MasterEq::initSparseMatSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes matrices needed for the sparse matrix solver. </p>

</div>
</div>
<a id="a9308372d3f1aa99517dd313d5d2a4cd9" name="a9308372d3f1aa99517dd313d5d2a4cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9308372d3f1aa99517dd313d5d2a4cd9">&#9670;&#160;</a></span>population()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MasterEq::population </td>
          <td>(</td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>population_com</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes population of the full composite system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>State vector </td></tr>
    <tr><td class="paramname">population_com</td><td>Reference to vector to store population values </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9e3fcf025c5e78f7cd5bed77d48660a7" name="a9e3fcf025c5e78f7cd5bed77d48660a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e3fcf025c5e78f7cd5bed77d48660a7">&#9670;&#160;</a></span>set_RHS_MatMult_operation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MasterEq::set_RHS_MatMult_operation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pass MatMult operations for applying the RHS to PETSc. </p>
<p>The RHS is stored as a Matrix Shell. This routine passes the (transpose) Matrix-Multiplication operation for applying the RHS to a state vector to PETSc. </p>

</div>
</div>
<a id="af747a9c4013860f785cd80fe52e7f457" name="af747a9c4013860f785cd80fe52e7f457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af747a9c4013860f785cd80fe52e7f457">&#9670;&#160;</a></span>setControlAmplitudes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MasterEq::setControlAmplitudes </td>
          <td>(</td>
          <td class="paramtype">const Vec&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pass control parameters from global design vector to each oscillator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Global design vector containing control parameters </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0d6120b5a9fbbf9321ae897ea463d6be" name="a0d6120b5a9fbbf9321ae897ea463d6be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d6120b5a9fbbf9321ae897ea463d6be">&#9670;&#160;</a></span>Ac_vec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Mat&gt; MasterEq::Ac_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7aa65ae612c591230c41eec8454936ee" name="a7aa65ae612c591230c41eec8454936ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa65ae612c591230c41eec8454936ee">&#9670;&#160;</a></span>Ad</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mat MasterEq::Ad</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab0d2504ab06b61b6bfe11f623e5a002c" name="ab0d2504ab06b61b6bfe11f623e5a002c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0d2504ab06b61b6bfe11f623e5a002c">&#9670;&#160;</a></span>Ad_vec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Mat&gt; MasterEq::Ad_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a02dd3462531616d6a2a250a088990cd2" name="a02dd3462531616d6a2a250a088990cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02dd3462531616d6a2a250a088990cd2">&#9670;&#160;</a></span>addT1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MasterEq::addT1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0674aab017f75be72e15d45385a1ebf8" name="a0674aab017f75be72e15d45385a1ebf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0674aab017f75be72e15d45385a1ebf8">&#9670;&#160;</a></span>addT2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MasterEq::addT2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flags for including T1 decay and T2 dephasing Lindblad operators. </p>

</div>
</div>
<a id="ad59aa549dc17834871c3fdfe96f397e4" name="ad59aa549dc17834871c3fdfe96f397e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad59aa549dc17834871c3fdfe96f397e4">&#9670;&#160;</a></span>aux</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec MasterEq::aux</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary vector for computations. </p>

</div>
</div>
<a id="af01d9bc120f37351713381245939945f" name="af01d9bc120f37351713381245939945f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af01d9bc120f37351713381245939945f">&#9670;&#160;</a></span>Bc_vec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Mat&gt; MasterEq::Bc_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2afd1529a3b1793aa87ad1c008ef212a" name="a2afd1529a3b1793aa87ad1c008ef212a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2afd1529a3b1793aa87ad1c008ef212a">&#9670;&#160;</a></span>Bd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mat MasterEq::Bd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6c486486fc1feb02cbc77bd44ca3202a" name="a6c486486fc1feb02cbc77bd44ca3202a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c486486fc1feb02cbc77bd44ca3202a">&#9670;&#160;</a></span>Bd_vec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Mat&gt; MasterEq::Bd_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3d861dd8d9ad6f4e9b04e0109d3ee128" name="a3d861dd8d9ad6f4e9b04e0109d3ee128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d861dd8d9ad6f4e9b04e0109d3ee128">&#9670;&#160;</a></span>crosskerr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; MasterEq::crosskerr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cross-Kerr coefficients (rad/time) \(\xi_{kl}\) for ZZ-coupling \(a_k^\dagger a_k a_l^\dagger a_l\). </p>

</div>
</div>
<a id="ad7615921804c8c1dfda8295c9b83f805" name="ad7615921804c8c1dfda8295c9b83f805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7615921804c8c1dfda8295c9b83f805">&#9670;&#160;</a></span>dim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::dim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimension of full vectorized system: N^2 if Lindblad, N if Schroedinger. </p>

</div>
</div>
<a id="ae1e8bccc92eb5e68c476b8940f2a69bb" name="ae1e8bccc92eb5e68c476b8940f2a69bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1e8bccc92eb5e68c476b8940f2a69bb">&#9670;&#160;</a></span>dim_ess</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::dim_ess</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimension of essential levels = N_e. </p>

</div>
</div>
<a id="a339bf57d2a07ca69cfc3bda69c5b2408" name="a339bf57d2a07ca69cfc3bda69c5b2408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a339bf57d2a07ca69cfc3bda69c5b2408">&#9670;&#160;</a></span>dim_rho</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::dim_rho</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimension of Hilbert space = N. </p>

</div>
</div>
<a id="a7f69aef84b13fada56ebb31adf9fa7fd" name="a7f69aef84b13fada56ebb31adf9fa7fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f69aef84b13fada56ebb31adf9fa7fd">&#9670;&#160;</a></span>eta</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; MasterEq::eta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Frequency differences in rotating frame (rad/time) for dipole-dipole coupling. </p>

</div>
</div>
<a id="a4cc4d6da9ba0169c505d9a003e29a3fe" name="a4cc4d6da9ba0169c505d9a003e29a3fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cc4d6da9ba0169c505d9a003e29a3fe">&#9670;&#160;</a></span>hamiltonian_file_Hc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MasterEq::hamiltonian_file_Hc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Filename if a custom control Hamiltonians are read from file ('none' if standard Hamiltonian is used) </p>

</div>
</div>
<a id="a7b3188a199da02dba7d150c383b3f460" name="a7b3188a199da02dba7d150c383b3f460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3188a199da02dba7d150c383b3f460">&#9670;&#160;</a></span>hamiltonian_file_Hsys</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MasterEq::hamiltonian_file_Hsys</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Filename if a custom system Hamiltonian is read from file ('none' if standard Hamiltonian is used) </p>

</div>
</div>
<a id="aa34805631143b54e65a99ea9fccb7489" name="aa34805631143b54e65a99ea9fccb7489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34805631143b54e65a99ea9fccb7489">&#9670;&#160;</a></span>ilow</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::ilow</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First index of the local sub vector u,v. </p>

</div>
</div>
<a id="a44fad9cad554191a82455cf84d1fdd1f" name="a44fad9cad554191a82455cf84d1fdd1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44fad9cad554191a82455cf84d1fdd1f">&#9670;&#160;</a></span>isu</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IS MasterEq::isu</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a53b5dbe948eb0eb8570e4555d7ebedaa" name="a53b5dbe948eb0eb8570e4555d7ebedaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b5dbe948eb0eb8570e4555d7ebedaa">&#9670;&#160;</a></span>isv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IS MasterEq::isv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector strides for accessing real and imaginary parts u=Re(x), v=Im(x) </p>

</div>
</div>
<a id="ae3b78dbc07dedc9c99358ecbb5f49fa0" name="ae3b78dbc07dedc9c99358ecbb5f49fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b78dbc07dedc9c99358ecbb5f49fa0">&#9670;&#160;</a></span>iupp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::iupp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last index (+1) of the local sub vector u,v. </p>

</div>
</div>
<a id="ac53a2013f8ebe3b279be5b04b2bba34e" name="ac53a2013f8ebe3b279be5b04b2bba34e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac53a2013f8ebe3b279be5b04b2bba34e">&#9670;&#160;</a></span>Jkl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; MasterEq::Jkl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dipole-dipole coupling coefficients (rad/time), multiplies \(a_k^\dagger a_l + a_k a_l^\dagger\). </p>

</div>
</div>
<a id="ac8fd54198c43d043c544e72417e30dba" name="ac8fd54198c43d043c544e72417e30dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fd54198c43d043c544e72417e30dba">&#9670;&#160;</a></span>lindbladtype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="defs_8hpp.html#a5e46e0fe90abc6230f71928a43849bd2">LindbladType</a> MasterEq::lindbladtype</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of Lindblad operators to include (NONE means Schroedinger equation) </p>

</div>
</div>
<a id="a5404fe64afa66ec3ce8486142394e3ca" name="a5404fe64afa66ec3ce8486142394e3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5404fe64afa66ec3ce8486142394e3ca">&#9670;&#160;</a></span>localsize_u</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt MasterEq::localsize_u</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Size of local sub vector u or v in state x=[u,v]. </p>

</div>
</div>
<a id="a1a7dfad49bfeafe1ebbaa4a23a4eae29" name="a1a7dfad49bfeafe1ebbaa4a23a4eae29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a7dfad49bfeafe1ebbaa4a23a4eae29">&#9670;&#160;</a></span>mpirank_petsc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MasterEq::mpirank_petsc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rank of PETSc's communicator. </p>

</div>
</div>
<a id="ac7b7aa48c2cce32d27d0055e0a8d5990" name="ac7b7aa48c2cce32d27d0055e0a8d5990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7b7aa48c2cce32d27d0055e0a8d5990">&#9670;&#160;</a></span>mpirank_world</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MasterEq::mpirank_world</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rank of global MPI communicator. </p>

</div>
</div>
<a id="abee3fe0e3ed04fead9f70dc6841a1496" name="abee3fe0e3ed04fead9f70dc6841a1496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee3fe0e3ed04fead9f70dc6841a1496">&#9670;&#160;</a></span>mpisize_petsc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MasterEq::mpisize_petsc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Size of PETSc's communicator. </p>

</div>
</div>
<a id="a609bd3adeeaf8f9a53e7bdc59cd25be8" name="a609bd3adeeaf8f9a53e7bdc59cd25be8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a609bd3adeeaf8f9a53e7bdc59cd25be8">&#9670;&#160;</a></span>nessential</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MasterEq::nessential</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of essential levels per oscillator. </p>

</div>
</div>
<a id="a6cadd8dbe3e40e6ea087b6926de72c1f" name="a6cadd8dbe3e40e6ea087b6926de72c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cadd8dbe3e40e6ea087b6926de72c1f">&#9670;&#160;</a></span>nlevels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MasterEq::nlevels</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of levels per oscillator. </p>

</div>
</div>
<a id="aaafcd9e3d4a617bbb86d004b44f7ad3d" name="aaafcd9e3d4a617bbb86d004b44f7ad3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaafcd9e3d4a617bbb86d004b44f7ad3d">&#9670;&#160;</a></span>noscillators</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MasterEq::noscillators</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of oscillators in the system. </p>

</div>
</div>
<a id="a6c35b6e30807ba37c4742a05af80f9ef" name="a6c35b6e30807ba37c4742a05af80f9ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c35b6e30807ba37c4742a05af80f9ef">&#9670;&#160;</a></span>oscil_vec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOscillator.html">Oscillator</a>** MasterEq::oscil_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Array of pointers to oscillator objects. </p>

</div>
</div>
<a id="a3493e8372960cd42ba4ceab89fe68bb9" name="a3493e8372960cd42ba4ceab89fe68bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3493e8372960cd42ba4ceab89fe68bb9">&#9670;&#160;</a></span>quietmode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MasterEq::quietmode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag for quiet mode operation. </p>

</div>
</div>
<a id="ab200ca6b9a16be33b8ee7313c41f20d2" name="ab200ca6b9a16be33b8ee7313c41f20d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab200ca6b9a16be33b8ee7313c41f20d2">&#9670;&#160;</a></span>RHS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mat MasterEq::RHS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MatShell for real-valued, vectorized system matrix (size 2N^2 x 2N^2) </p>

</div>
</div>
<a id="a6a3bb1ab8dd49c64f51c90dd5b080f62" name="a6a3bb1ab8dd49c64f51c90dd5b080f62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3bb1ab8dd49c64f51c90dd5b080f62">&#9670;&#160;</a></span>RHSctx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMatShellCtx.html">MatShellCtx</a> MasterEq::RHSctx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Context containing data for applying the RHS to a state. </p>

</div>
</div>
<a id="a2d735524c2b5b205adb1898606b65a19" name="a2d735524c2b5b205adb1898606b65a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d735524c2b5b205adb1898606b65a19">&#9670;&#160;</a></span>usematfree</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MasterEq::usematfree</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag for using matrix-free solver. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/quandary/quandary/include/<a class="el" href="mastereq_8hpp_source.html">mastereq.hpp</a></li>
<li>/home/runner/work/quandary/quandary/src/<a class="el" href="mastereq_8cpp.html">mastereq.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
